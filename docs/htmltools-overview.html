<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 htmltools overview | Outstanding User Interfaces with Shiny</title>
<meta name="author" content="David Granjon">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/core-js-2.5.3/shim.min.js"></script><script src="libs/react-17.0.0/react.min.js"></script><script src="libs/react-17.0.0/react-dom.min.js"></script><script src="libs/reactwidget-1.0.0/react-tools.js"></script><link href="libs/font-awesome-5.13.0/css/all.min.css" rel="stylesheet">
<link href="libs/font-awesome-5.13.0/css/v4-shims.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Outstanding User Interfaces with Shiny</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="web-intro.html"><span class="header-section-number">1</span> Shiny and the Web</a></li>
<li><a class="active" href="htmltools-overview.html"><span class="header-section-number">2</span> htmltools overview</a></li>
<li><a class="" href="web-dependencies.html"><span class="header-section-number">3</span> Discover Shiny dependencies</a></li>
<li><a class="" href="htmltools-dependencies.html"><span class="header-section-number">4</span> Dependency utilities</a></li>
<li><a class="" href="web-applications.html"><span class="header-section-number">5</span> Web application concepts</a></li>
<li class="book-part">Beautify with CSS and Sass</li>
<li><a class="" href="beautify-css.html"><span class="header-section-number">6</span> CSS for Shiny</a></li>
<li><a class="" href="beautify-sass.html"><span class="header-section-number">7</span> Introduction to Sass</a></li>
<li><a class="" href="beautify-with-fresh.html"><span class="header-section-number">8</span> Beautify with {fresh}</a></li>
<li><a class="" href="beautify-with-bootstraplib.html"><span class="header-section-number">9</span> Beautify with {bslib}</a></li>
<li class="book-part">Unleash interactivity with JavaScript</li>
<li><a class="" href="survival-kit-javascript.html"><span class="header-section-number">10</span> JavaScript for Shiny</a></li>
<li><a class="" href="shiny-intro.html"><span class="header-section-number">11</span> R and JS</a></li>
<li><a class="" href="shiny-input-system.html"><span class="header-section-number">12</span> Shiny’s input system</a></li>
<li><a class="" href="shiny-input-lifecycle.html"><span class="header-section-number">13</span> Shiny inputs lifecycles</a></li>
<li><a class="" href="shiny-input-gems.html"><span class="header-section-number">14</span> Mastering Shiny’s events</a></li>
<li><a class="" href="shiny-custom-handler.html"><span class="header-section-number">15</span> Dynamically manage content with handlers</a></li>
<li class="book-part">Practice 1: a dashboard template</li>
<li><a class="" href="custom-templates-selection.html"><span class="header-section-number">16</span> Template selection</a></li>
<li><a class="" href="custom-templates-dependencies.html"><span class="header-section-number">17</span> Define dependencies</a></li>
<li><a class="" href="custom-templates-skeleton.html"><span class="header-section-number">18</span> Create template elements</a></li>
<li><a class="" href="custom-templates-inputs.html"><span class="header-section-number">19</span> Develop custom input widgets</a></li>
<li><a class="" href="custom-templates-interactivity.html"><span class="header-section-number">20</span> Adding more interactivity</a></li>
<li><a class="" href="custom-templates-testing.html"><span class="header-section-number">21</span> Testing and validating templates elements</a></li>
<li class="book-part">Toward a better workflow</li>
<li><a class="" href="workflow-charpente.html"><span class="header-section-number">22</span> Introduction to {charpente}</a></li>
<li class="book-part">Case study 2: Mobile development with Shiny</li>
<li><a class="" href="mobile-shiny-intro.html"><span class="header-section-number">23</span> Introduction</a></li>
<li><a class="" href="mobile-shinyMobile.html"><span class="header-section-number">24</span> Reconstruct {shinyMobile}</a></li>
<li><a class="" href="mobile-pwa.html"><span class="header-section-number">25</span> {shinyMobile} and PWA</a></li>
<li><a class="" href="mobile-widgets.html"><span class="header-section-number">26</span> Design widgets</a></li>
<li><a class="" href="mobile-going-further.html"><span class="header-section-number">27</span> Fine tune shinyMobile</a></li>
<li class="book-part">Going further</li>
<li><a class="" href="going-further-reactR.html"><span class="header-section-number">28</span> R + Shiny + React: welcome {reactR}</a></li>
<li><a class="" href="going-further-where-to-go.html"><span class="header-section-number">29</span> What to do next?</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/DivadNojnarg/outstanding-shiny-ui">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="htmltools-overview" class="section level1">
<h1>
<span class="header-section-number">2</span> htmltools overview<a class="anchor" aria-label="anchor" href="#htmltools-overview"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
… However, if you already know HTML (or want to learn!) you can also work directly with HTML tags to achieve any level of customization you want
<footer>
— Hadley Wickham
</footer>
</blockquote>
<p><a href="https://github.com/rstudio/htmltools">htmltools</a> <span class="citation">(Cheng, Sievert, et al. <a href="references.html#ref-R-htmltools" role="doc-biblioref">2021</a>)</span> is a R package designed to:</p>
<ul>
<li>Generate HTML <strong>tags</strong> from R.</li>
<li>Handle web <strong>dependencies</strong> (see chapter <a href="htmltools-dependencies.html#htmltools-dependencies">4</a>).</li>
</ul>
<p>Historically, <a href="https://github.com/rstudio/htmltools">htmltools</a> was extracted out of <a href="https://shiny.rstudio.com/">shiny</a> <span class="citation">(Chang et al. <a href="references.html#ref-R-shiny" role="doc-biblioref">2021</a>)</span> to be able to extend it, that is developing custom HTML tags, importing extra dependencies from the web. That’s why, both packages have many common functions! At the moment, <a href="https://github.com/rstudio/htmltools">htmltools</a> does not have a user guide, even though it is a key package for all web things!</p>
<div id="writing-html-tags-from-r" class="section level2">
<h2>
<span class="header-section-number">2.1</span> Writing HTML Tags from R<a class="anchor" aria-label="anchor" href="#writing-html-tags-from-r"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://github.com/rstudio/htmltools">htmltools</a> provides the necessary functions to write HTML tags that were introduced in Chapter <a href="web-intro.html#web-intro-html">1.3</a>. In R, it is even more convenient than raw HTML since there is no opening/closing tag, a simple function call instead:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/htmltools">htmltools</a></span><span class="op">)</span>
<span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="st">"Hello World"</span><span class="op">)</span>
<span class="va">tag</span></code></pre></div>
<p></p>
<div>Hello World</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">tag</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div&gt;Hello World&lt;/div&gt;"</code></pre>
<p>Inside the function call, all named elements become <strong>attributes</strong>, whereas unnamed elements become <strong>children</strong>. In some cases, tags may have empty attributes like <code>&lt;input disabled&gt;</code>. In that case,
the corresponding R code is <code>input(disabled = NA)</code>. Since tag functions produce shiny tags, that is HTML elements, we can capture the HTML output by converting it to a character with <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code>, as shown above.</p>
</div>
<div id="notations" class="section level2">
<h2>
<span class="header-section-number">2.2</span> Notations<a class="anchor" aria-label="anchor" href="#notations"><i class="fas fa-link"></i></a>
</h2>
<p>If you type <code>htmltools::tags$</code> in the R console, you should be suggested the most common available HTML tags, thereby making it fairly easy to switch between HTML and R, as shown Figure <a href="htmltools-overview.html#fig:htmltools-tags">2.1</a></p>
<div class="figure">
<span id="fig:htmltools-tags"></span>
<img src="images/htmltools/htmltools-tags.png" alt="htmltools tags builder" width="100%"><p class="caption">
FIGURE 2.1: htmltools tags builder
</p>
</div>
<p>However, for convenience, the most commonly used tags like <code>p</code>, <code>h1</code>, <code>h2</code>, <code>h3</code>, <code>h4</code>, <code>h5</code>, <code>h6</code>, <code>a</code>, <code>br</code>, <code>div</code>, <code>span</code>, <code>pre</code>, <code>code</code>, <code>img</code>, <code>strong</code>, <code>em</code>, <code>hr</code>, …
are accessible by a simple function call like:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># good</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h1</a></span><span class="op">(</span><span class="st">"This is a title"</span><span class="op">)</span>

<span class="co"># correct but not necessary</span>
<span class="va">tags</span><span class="op">$</span><span class="fu">h1</span><span class="op">(</span><span class="st">"This is a title"</span><span class="op">)</span></code></pre></div>
<p>Therefore, whether to use <code>tags$&lt;TAG_NAME</code> or <code>&lt;TAG_NAME&gt;</code> depends if the tag is exported by default. Since <code>nav</code> is not exported, we write:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># correct</span>
<span class="va">tags</span><span class="op">$</span><span class="fu">nav</span><span class="op">(</span><span class="st">"This is the navigation"</span><span class="op">)</span>

<span class="co"># fail</span>
<span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu">nav</span><span class="op">(</span><span class="st">"This is the navigation"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>When building custom templates, you will be writing a lot of tags! It might seem
too much work to always write <code>tags$&lt;TAG_NAME&gt;</code>. There exists a function called <code><a href="https://rdrr.io/pkg/htmltools/man/withTags.html">withTags()</a></code>, such that wrapping your code in this function allows code like this, much
easier to write and read:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Better</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/withTags.html">withTags</a></span><span class="op">(</span>
  <span class="fu">nav</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">ul</span><span class="op">(</span><span class="fu">li</span><span class="op">(</span><span class="op">)</span>, <span class="fu">li</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># instead of </span>
<span class="va">tags</span><span class="op">$</span><span class="fu">nav</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span><span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="op">)</span>, <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>If you had to gather multiple tags together, choose <code><a href="https://rdrr.io/pkg/htmltools/man/tagList.html">tagList()</a></code> over <code><a href="https://rdrr.io/r/base/list.html">list()</a></code>, although the HTML output is the same:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># good</span>
<span class="va">tag_list_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagList.html">tagList</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"Some text"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="st">"Content"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tag_list_1</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ :List of 3
##   ..$ name    : chr "p"
##   ..$ attribs : Named list()
##   ..$ children:List of 1
##   .. ..$ : chr "Some text"
##   ..- attr(*, "class")= chr "shiny.tag"
##  $ :List of 3
##   ..$ name    : chr "div"
##   ..$ attribs : Named list()
##   ..$ children:List of 1
##   .. ..$ : chr "Content"
##   ..- attr(*, "class")= chr "shiny.tag"
##  - attr(*, "class")= chr [1:2] "shiny.tag.list" "list"</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># correct but not optimal</span>
<span class="va">tag_list_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"Some text"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="st">"Content"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tag_list_2</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ :List of 3
##   ..$ name    : chr "p"
##   ..$ attribs : Named list()
##   ..$ children:List of 1
##   .. ..$ : chr "Some text"
##   ..- attr(*, "class")= chr "shiny.tag"
##  $ :List of 3
##   ..$ name    : chr "div"
##   ..$ attribs : Named list()
##   ..$ children:List of 1
##   .. ..$ : chr "Content"
##   ..- attr(*, "class")= chr "shiny.tag"</code></pre>
<p>The first has the <code>shiny.tag.list</code> class in addition to <code>list</code>. <a href="https://github.com/ThinkR-open/golem">golem</a> <span class="citation">(Fay et al. <a href="references.html#ref-R-golem" role="doc-biblioref">2021</a>)</span> allows to test if an R object is a tag list. In this case, using a list would cause the test fail.</p>
</div>
<div id="adding-new-tags" class="section level2">
<h2>
<span class="header-section-number">2.3</span> Adding new tags<a class="anchor" aria-label="anchor" href="#adding-new-tags"><i class="fas fa-link"></i></a>
</h2>
<p>You may define extra HTML tags with the <code><a href="https://rdrr.io/pkg/htmltools/man/builder.html">tag()</a></code> function:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">customTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">tag</a></span><span class="op">(</span>
  <span class="st">"test"</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"test"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"Custom Tag"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">customTag</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 3
##  $ name    : chr "test"
##  $ attribs :List of 1
##   ..$ class: chr "test"
##  $ children:List of 1
##   ..$ :List of 3
##   .. ..$ name    : chr "p"
##   .. ..$ attribs : Named list()
##   .. ..$ children:List of 1
##   .. .. ..$ : chr "Custom Tag"
##   .. ..- attr(*, "class")= chr "shiny.tag"
##  - attr(*, "class")= chr "shiny.tag"</code></pre>
<pre><code>## [1] "&lt;test class="test"&gt;"
## [2] "  &lt;p&gt;Custom Tag&lt;/p&gt;"
## [3] "&lt;/test&gt;"</code></pre>
<p>Good practice is to check whether the created tag is in line with the HTML validation rules. If you want to check a web page, particularly a Shiny generated HTML page, W3C has an online validation <a href="https://validator.w3.org/">tool</a>. Be careful as, not following this rule will cause the HTML code to be invalid. By default, Shiny complies with all the recommendations, but we suggest you to be careful with any exotic template.</p>
</div>
<div id="alternative-way-to-write-tags" class="section level2">
<h2>
<span class="header-section-number">2.4</span> Alternative way to write tags<a class="anchor" aria-label="anchor" href="#alternative-way-to-write-tags"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://github.com/rstudio/htmltools">htmltools</a> comes with the <code><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML()</a></code> function that you can feed with raw HTML. Below, both code give exactly the same output:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="st">"&lt;div&gt;Blabla&lt;/div&gt;"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="st">"Blabla"</span><span class="op">)</span></code></pre></div>
<p>Internally, their classes are different:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="st">"&lt;div&gt;Blabla&lt;/div&gt;"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "html"      "character"</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="st">"Blabla"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "shiny.tag"</code></pre>
<!-- Why pick one over the other? -->
<div class="importantblock">
<p>Doing so, you will not be able to use tags related functions, as in the next parts.
Therefore, we strongly recommend using R and not mixing HTML in R.</p>
</div>
<p>Interestingly, if you want to convert raw HTML to R code, there is a Shiny App developed by Alan
Dipert from RStudio, namely <a href="https://github.com/alandipert/html2r">html2R</a>, shown Figure <a href="htmltools-overview.html#fig:htmltools-html2R">2.2</a>. Non standard attributes (like <code>data-toggle</code>) are not correctly processed but there are <a href="https://github.com/alandipert/html2r/issues/2">solutions</a>. This will save you precious time! A more recent approach is developed in section <a href="workflow-charpente.html#workflow-charpente">22</a> and has be internally used to develop some of the RinteRface <a href="https://github.com/RinteRface">templates</a>.</p>
<div class="figure">
<span id="fig:htmltools-html2R"></span>
<img src="images/htmltools/htmltools-html2R.png" alt="Illustration of the html2R App" width="100%"><p class="caption">
FIGURE 2.2: Illustration of the html2R App
</p>
</div>
<p>By converting HTML to R functions, it’s possible to easily parameterize the generated tag.
and reuse it later in the code. It also allows to maintain one single code base (only R), which is much simpler in the long run if the code had to be reviewed by people non familiar with HTML.</p>
</div>
<div id="playing-with-tags" class="section level2">
<h2>
<span class="header-section-number">2.5</span> Playing with tags<a class="anchor" aria-label="anchor" href="#playing-with-tags"><i class="fas fa-link"></i></a>
</h2>
<p>The ultimate goal of <a href="https://github.com/rstudio/htmltools">htmltools</a> is to manipulate, combine and rearrange tags in order to create flexible and rich HTML structures from R. Would you believe that the below example heavily relies on <a href="https://github.com/rstudio/htmltools">htmltools</a> (Figure <a href="htmltools-overview.html#fig:shinyRPG">2.3</a>)?</p>
<div class="figure">
<span id="fig:shinyRPG"></span>
<img src="images/htmltools/shinyRPG.png" alt="shinyRPG was built with htmltools" width="100%"><p class="caption">
FIGURE 2.3: shinyRPG was built with htmltools
</p>
</div>
<p>If you want to try out this example, below is the showcase code:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"RinteRface/shinyRPG"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">shinyRPG</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/shinyRPG/man/shinyRPGDemo.html">shinyRPGDemo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Before becoming an <a href="https://github.com/rstudio/htmltools">htmltools</a> wizard, let’s learn the shiny tags fundamentals.</p>
<div id="tags-structure" class="section level3">
<h3>
<span class="header-section-number">2.5.1</span> Tags structure<a class="anchor" aria-label="anchor" href="#tags-structure"><i class="fas fa-link"></i></a>
</h3>
<p>A <strong>shiny tag</strong> is defined by:</p>
<ul>
<li>A <strong>name</strong> such as span, div, h1 …, accessed with <code>tag$name</code>.</li>
<li>Some <strong>attributes</strong>, which can be accessed with <code>tag$attribs</code>.</li>
<li>
<strong>Children</strong>, which can be accessed with <code>tag$children</code>.</li>
<li>A <strong>class</strong>, namely <code>shiny.tag</code>.</li>
</ul>
<p>For instance:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create the tag</span>
<span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>
  class <span class="op">=</span> <span class="st">"divclass"</span>, 
  id <span class="op">=</span> <span class="st">"first"</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h1</a></span><span class="op">(</span><span class="st">"My first child!"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"child"</span>, id <span class="op">=</span> <span class="st">"baby"</span>, <span class="st">"Crying"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co"># access its name</span>
<span class="co"># myTag$name</span>
<span class="co"># access its attributes (id and class)</span>
<span class="co"># myTag$attribs</span>
<span class="co"># access children (returns a list of 2 elements)</span>
<span class="co"># myTag$children</span>
<span class="co"># access its class</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">myTag</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 3
##  $ name    : chr "div"
##  $ attribs :List of 2
##   ..$ class: chr "divclass"
##   ..$ id   : chr "first"
##  $ children:List of 2
##   ..$ :List of 3
##   .. ..$ name    : chr "h1"
##   .. ..$ attribs : Named list()
##   .. ..$ children:List of 1
##   .. .. ..$ : chr "My first child!"
##   .. ..- attr(*, "class")= chr "shiny.tag"
##   ..$ :List of 3
##   .. ..$ name    : chr "span"
##   .. ..$ attribs :List of 2
##   .. .. ..$ class: chr "child"
##   .. .. ..$ id   : chr "baby"
##   .. ..$ children:List of 1
##   .. .. ..$ : chr "Crying"
##   .. ..- attr(*, "class")= chr "shiny.tag"
##  - attr(*, "class")= chr "shiny.tag"</code></pre>
<pre><code>## [1] "&lt;div class="divclass" id="first"&gt;"
## [2] "  &lt;h1&gt;My first child!&lt;/h1&gt;"
## [3] "  &lt;span class="child" id="baby"&gt;Crying&lt;/span&gt;"
## [4] "&lt;/div&gt;"</code></pre>
<p>How to modify the class of the second child?</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">second_children</span> <span class="op">&lt;-</span> <span class="va">myTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="va">second_children</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="st">"adult"</span>
<span class="co"># This is not working ...</span></code></pre></div>
<pre><code>## [1] "&lt;div class="divclass" id="first"&gt;"
## [2] "  &lt;h1&gt;My first child!&lt;/h1&gt;"
## [3] "  &lt;span class="child" id="baby"&gt;Crying&lt;/span&gt;"
## [4] "&lt;/div&gt;"</code></pre>
<p>Why is this not working? By assigning <code>myTag$children[[2]]</code> to second_children, <code>second_children$attribs$class &lt;- "adult"</code> modifies the class of the copy and not the original object. Thus we do:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="st">"adult"</span></code></pre></div>
<pre><code>## [1] "&lt;div class="divclass" id="first"&gt;"
## [2] "  &lt;h1&gt;My first child!&lt;/h1&gt;"
## [3] "  &lt;span class="adult" id="baby"&gt;Crying&lt;/span&gt;"
## [4] "&lt;/div&gt;"</code></pre>
</div>
<div id="practical-examples-shinyrpg" class="section level3">
<h3>
<span class="header-section-number">2.5.2</span> Practical examples: shinyRPG<a class="anchor" aria-label="anchor" href="#practical-examples-shinyrpg"><i class="fas fa-link"></i></a>
</h3>
<p>Below we give concrete example on how to customize tags in the real life. There exists a
nice RPG HTML template, that is <a href="http://ronenness.github.io/RPGUI/">rpgui</a>. It provides
the necessary elements to get started developing nice RPG looking user interfaces, as depicted by Figure <a href="htmltools-overview.html#fig:rpgui-select">2.4</a>.</p>
<div class="figure">
<span id="fig:rpgui-select"></span>
<img src="images/htmltools/rpgui-select.png" alt="rpgui select input" width="100%"><p class="caption">
FIGURE 2.4: rpgui select input
</p>
</div>
<p>In the following, we consider the select input, which does not have exactly the same
structure as the original shiny tag. However, it is convenient to reuse the shiny function
to limit our amount of work. We therefore start to write our custom input:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rpgSelect</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">label</span>, <span class="va">choices</span>, <span class="va">selected</span> <span class="op">=</span> <span class="cn">NULL</span>,
                      <span class="va">multiple</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">size</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span>
    <span class="va">inputId</span>,
    <span class="va">label</span>,
    <span class="va">choices</span>,
    <span class="va">selected</span>,
    <span class="va">multiple</span>,
    selectize <span class="op">=</span> <span class="cn">FALSE</span>,
    width <span class="op">=</span> <span class="cn">NULL</span>,
    <span class="va">size</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>According to the rpgui documentation, a select tag is composed of the following HTML elements:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb43-1"><a href="htmltools-overview.html#cb43-1"></a><span class="kw">&lt;select</span><span class="ot"> class=</span><span class="st">"rpgui-dropdown"</span><span class="kw">&gt;</span></span>
<span id="cb43-2"><a href="htmltools-overview.html#cb43-2"></a>    <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">"option1"</span><span class="kw">&gt;</span>option1<span class="kw">&lt;/option&gt;</span></span>
<span id="cb43-3"><a href="htmltools-overview.html#cb43-3"></a>    <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">"option2"</span><span class="kw">&gt;</span>option2<span class="kw">&lt;/option&gt;</span></span>
<span id="cb43-4"><a href="htmltools-overview.html#cb43-4"></a>    ...</span>
<span id="cb43-5"><a href="htmltools-overview.html#cb43-5"></a><span class="kw">&lt;/select&gt;</span></span></code></pre></div>
<p>Adding a label tag on top of the slider, this is what we would like to get:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb44-1"><a href="htmltools-overview.html#cb44-1"></a><span class="kw">&lt;div&gt;</span></span>
<span id="cb44-2"><a href="htmltools-overview.html#cb44-2"></a>  <span class="kw">&lt;label</span><span class="ot"> id=</span><span class="st">"variable-label"</span><span class="ot"> for=</span><span class="st">"variable"</span><span class="kw">&gt;</span>Variable:<span class="kw">&lt;/label&gt;</span></span>
<span id="cb44-3"><a href="htmltools-overview.html#cb44-3"></a>  <span class="kw">&lt;select</span> </span>
<span id="cb44-4"><a href="htmltools-overview.html#cb44-4"></a><span class="ot">    id=</span><span class="st">"variable"</span> </span>
<span id="cb44-5"><a href="htmltools-overview.html#cb44-5"></a><span class="ot">    class=</span><span class="st">"rpgui-dropdown"</span><span class="kw">&gt;</span></span>
<span id="cb44-6"><a href="htmltools-overview.html#cb44-6"></a>    <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">"cyl"</span><span class="ot"> selected</span><span class="kw">&gt;</span>Cylinders<span class="kw">&lt;/option&gt;</span></span>
<span id="cb44-7"><a href="htmltools-overview.html#cb44-7"></a>    <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">"am"</span><span class="kw">&gt;</span>Transmission<span class="kw">&lt;/option&gt;</span></span>
<span id="cb44-8"><a href="htmltools-overview.html#cb44-8"></a>    <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">"gear"</span><span class="kw">&gt;</span>Gears<span class="kw">&lt;/option&gt;</span></span>
<span id="cb44-9"><a href="htmltools-overview.html#cb44-9"></a>  <span class="kw">&lt;/select&gt;</span></span>
<span id="cb44-10"><a href="htmltools-overview.html#cb44-10"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p>We compare with our own <code>rpgSelect</code> function:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/shinyRPG/man/rpg-select.html">rpgSelect</a></span><span class="op">(</span>
  <span class="st">"variable"</span>, 
  <span class="st">"Variable:"</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cylinders"</span> <span class="op">=</span> <span class="st">"cyl"</span>,
    <span class="st">"Transmission"</span> <span class="op">=</span> <span class="st">"am"</span>,
    <span class="st">"Gears"</span> <span class="op">=</span> <span class="st">"gear"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div class="form-group shiny-input-container"&gt;"
## [2] "  &lt;label class="control-label" id="variable-label" for="variable"&gt;Variable:&lt;/label&gt;"
## [3] "  &lt;div&gt;"
## [4] "    &lt;select id="variable" class="form-control"&gt;&lt;option value="cyl" selected&gt;Cylinders&lt;/option&gt;"
## [5] "&lt;option value="am"&gt;Transmission&lt;/option&gt;"
## [6] "&lt;option value="gear"&gt;Gears&lt;/option&gt;&lt;/select&gt;"
## [7] "  &lt;/div&gt;"
## [8] "&lt;/div&gt;"</code></pre>
<p>As shown in the above output, this is not exactly matching:</p>
<ul>
<li>The outer div should not have any class.</li>
<li>The label should not have any class.</li>
<li>The input tag is wrapped inside a div container. It should not.</li>
<li>The input tag should have the <code>rpgui-dropdown</code> or <code>rpgui-list</code> class,
depending on the size value.</li>
</ul>
<p>To fix the first problem we target the outer tag (<code>selectTag</code>), that is the tag returned by our <code>rpgSelect</code> function. The second row cleans the label class. The third row removes the extra outer div and only keeps its children, corresponding to the input tag. The last instruction ensure to set the appropriate class, depending on the size value:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Modify tag</span>
<span class="va">selectTag</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="co"># Clean extra label class</span>
<span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="co"># Remove extra outer div</span>
<span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="co"># Add good class for rppgui binding</span>
<span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="st">"rpgui-dropdown"</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="st">"rpgui-list"</span>
<span class="op">}</span></code></pre></div>
<p>The final version is shown below:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rpgSelect</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">label</span>, <span class="va">choices</span>, <span class="va">selected</span> <span class="op">=</span> <span class="cn">NULL</span>,
                      <span class="va">multiple</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">size</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">selectTag</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span>
    <span class="va">inputId</span>,
    <span class="va">label</span>,
    <span class="va">choices</span>,
    <span class="va">selected</span>,
    <span class="va">multiple</span>,
    selectize <span class="op">=</span> <span class="cn">FALSE</span>,
    width <span class="op">=</span> <span class="cn">NULL</span>,
    <span class="va">size</span>
  <span class="op">)</span>

  <span class="co"># Modify tag</span>
  <span class="va">selectTag</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="co"># Clean extra label class</span>
  <span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="co"># Remove extra outer div</span>
  <span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

  <span class="co"># Add good class for rppgui binding</span>
  <span class="va">selectTag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="st">"rpgui-dropdown"</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="st">"rpgui-list"</span>
  <span class="op">}</span>

  <span class="va">selectTag</span>
<span class="op">}</span></code></pre></div>
<p>This yields:</p>
<pre><code>## [1] "&lt;div&gt;"
## [2] "  &lt;label id="variable-label" for="variable"&gt;Variable:&lt;/label&gt;"
## [3] "  &lt;select id="variable" class="rpgui-dropdown"&gt;&lt;option value="cyl" selected&gt;Cylinders&lt;/option&gt;"
## [4] "&lt;option value="am"&gt;Transmission&lt;/option&gt;"
## [5] "&lt;option value="gear"&gt;Gears&lt;/option&gt;&lt;/select&gt;"
## [6] "&lt;/div&gt;"</code></pre>
</div>
<div id="useful-functions-for-tags" class="section level3">
<h3>
<span class="header-section-number">2.5.3</span> Useful functions for tags<a class="anchor" aria-label="anchor" href="#useful-functions-for-tags"><i class="fas fa-link"></i></a>
</h3>
<p>As shown in the previous shinyRPG example, adding a class and an id to a tag may be done with:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tag</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="st">"class"</span>
<span class="va">tag</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="st">"id"</span></code></pre></div>
<p>These are two lines of code, and believe me, for complex examples, it might be much worse, thereby significantly impairing code readability.
Fortunately, <a href="https://github.com/rstudio/htmltools">htmltools</a> provides powerful functions to overcome this issue. Let’s review some of them below.</p>
<div id="add-attributes" class="section level4">
<h4>
<span class="header-section-number">2.5.3.1</span> Add attributes<a class="anchor" aria-label="anchor" href="#add-attributes"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagAppendAttributes()</a></code> adds a new attribute to the current tag. For instance, assuming we created a div without any id attribute:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="st">"A tag"</span><span class="op">)</span>
<span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagAppendAttributes</a></span><span class="op">(</span><span class="va">myTag</span>, id <span class="op">=</span> <span class="st">"myid"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div id="myid"&gt;A tag&lt;/div&gt;"</code></pre>
<p>You can pass as many attributes as you want, including <strong>non-standard</strong> attributes such as <code>data-toggle</code> (see Bootstrap 3 <a href="https://www.w3schools.com/bootstrap/bootstrap_ref_js_collapse.asp">tabs</a> for instance):</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagAppendAttributes</a></span><span class="op">(</span>
  <span class="va">myTag</span>, 
  `data-toggle` <span class="op">=</span> <span class="st">"tabs"</span>, 
  class <span class="op">=</span> <span class="st">"myclass"</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div id="myid" data-toggle="tabs" class="myclass"&gt;A tag&lt;/div&gt;"</code></pre>
<p>As a reminder, even though correct, the classic approach would requires two steps:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span><span class="op">$</span><span class="va">attribs</span><span class="op">[[</span><span class="st">"data-toggle"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"newValue"</span>
<span class="va">myTag</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="st">"newClass"</span></code></pre></div>
<pre><code>## [1] "&lt;div id="myid" data-toggle="newValue" class="newClass"&gt;A tag&lt;/div&gt;"</code></pre>
</div>
<div id="check-if-tag-has-specific-attribute" class="section level4">
<h4>
<span class="header-section-number">2.5.3.2</span> Check if tag has specific attribute<a class="anchor" aria-label="anchor" href="#check-if-tag-has-specific-attribute"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagHasAttribute()</a></code> checks if a tag has a specific attribute:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># I want to know if div has a class</span>
<span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"myclass"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagHasAttribute</a></span><span class="op">(</span><span class="va">myTag</span>, <span class="st">"class"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>If you are familiar with <code><a href="https://rdrr.io/pkg/shinyRPG/man/pipe.html">%&gt;%</a></code>, the above also works:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagHasAttribute</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>In practice, this function is useful when testing tag elements as shown in chapter <a href="custom-templates-testing.html#custom-templates-testing">21</a>.</p>
</div>
<div id="get-all-attributes" class="section level4">
<h4>
<span class="header-section-number">2.5.3.3</span> Get all attributes<a class="anchor" aria-label="anchor" href="#get-all-attributes"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagGetAttribute()</a></code> gets the targeted attribute’s value, if it exists, otherwise NULL:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span>
<span class="co"># returns the class</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagGetAttribute</a></span><span class="op">(</span><span class="va">myTag</span>, <span class="st">"class"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "test"</code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># returns NULL</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagGetAttribute</a></span><span class="op">(</span><span class="va">myTag</span>, <span class="st">"id"</span><span class="op">)</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="set-childchildren" class="section level4">
<h4>
<span class="header-section-number">2.5.3.4</span> Set child/children<a class="anchor" aria-label="anchor" href="#set-childchildren"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagSetChildren()</a></code> creates children for a given tag. For instance:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>
  class <span class="op">=</span> <span class="st">"parent"</span>, 
  id <span class="op">=</span> <span class="st">"father"</span>, 
  <span class="st">"Father!"</span>
<span class="op">)</span>
<span class="va">child</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="st">"Daughter"</span><span class="op">)</span>
<span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagSetChildren</a></span><span class="op">(</span><span class="va">myTag</span>, <span class="va">child</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div class="parent" id="father"&gt;"
## [2] "  &lt;span&gt;Daughter&lt;/span&gt;"
## [3] "&lt;/div&gt;"</code></pre>
<div class="warningblock">
<p><code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagSetChildren()</a></code> <strong>removes</strong> all existing children. Below we see another set of functions to add children while conserving existing ones.</p>
</div>
</div>
<div id="add-child-or-children" class="section level4">
<h4>
<span class="header-section-number">2.5.3.5</span> Add child or children<a class="anchor" aria-label="anchor" href="#add-child-or-children"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChild()</a></code> and <code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChildren()</a></code> add other tags to an existing tag.
Whereas <code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChild()</a></code> only takes one tag, you can pass a list of tags to <code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChildren()</a></code>.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"parent"</span>, <span class="st">"A tag"</span>, <span class="st">"Child 1"</span><span class="op">)</span>
<span class="va">otherTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="st">"Child 2"</span><span class="op">)</span>
<span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChild</a></span><span class="op">(</span><span class="va">myTag</span>, <span class="va">otherTag</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div class="parent"&gt;"
## [2] "  A tag"
## [3] "  Child 1"
## [4] "  &lt;span&gt;Child 2&lt;/span&gt;"
## [5] "&lt;/div&gt;"</code></pre>
</div>
<div id="build-your-own-functions" class="section level4">
<h4>
<span class="header-section-number">2.5.3.6</span> Build your own functions<a class="anchor" aria-label="anchor" href="#build-your-own-functions"><i class="fas fa-link"></i></a>
</h4>
<p>You might wonder why there is no <code>tagRemoveChild</code> or <code>tagRemoveAttributes</code>.
Let’s look at the <code>tagAppendChild</code>:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tagAppendChild</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">tag</span>, <span class="va">child</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tag</span><span class="op">$</span><span class="va">children</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">tag</span><span class="op">$</span><span class="va">children</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">child</span>
  <span class="va">tag</span>
<span class="op">}</span></code></pre></div>
<p>Below we write the <code>tagRemoveChild</code>, where tag is the target and n is the position to remove in the list of children:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"parent"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="st">"Hey!"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># we create the tagRemoveChild function</span>
<span class="va">tagRemoveChild</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># check if the list is empty</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">tag</span><span class="op">$</span><span class="va">children</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">tag</span><span class="op">$</span><span class="va">name</span>, <span class="st">"does not have any children!"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">tag</span><span class="op">$</span><span class="va">children</span><span class="op">[</span><span class="va">n</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="va">tag</span>
<span class="op">}</span>
<span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu">tagRemoveChild</span><span class="op">(</span><span class="va">myTag</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div class="parent"&gt;&lt;/div&gt;"</code></pre>
<p>When defining the <code>tagRemoveChild</code>, we choose <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code> instead of <code><a href="https://rdrr.io/r/base/Extract.html">[[</a></code> to allow to select multiple list elements. Also notice that the function raises an error if the provided tag does not have children.</p>
<p>The <code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChild()</a></code> is not able to insert at a specific position. We could draft the <code>tagInsertChild</code> building on top of the base R <code>append</code> function:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tagInsertChild</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span>, <span class="va">child</span>, <span class="va">position</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tag</span><span class="op">$</span><span class="va">children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op">(</span><span class="va">tag</span><span class="op">$</span><span class="va">children</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">child</span><span class="op">)</span>, <span class="va">position</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">tag</span>
<span class="op">}</span>

<span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">tagInsertChild</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="st">"hello"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">tagInsertChild</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="st">"hello"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;p&gt;"
## [2] "  &lt;a&gt;&lt;/a&gt;"
## [3] "  &lt;span&gt;hello&lt;/span&gt;"
## [4] "&lt;/p&gt;"</code></pre>
<pre><code>## [1] "&lt;p&gt;"
## [2] "  &lt;span&gt;hello&lt;/span&gt;"
## [3] "  &lt;a&gt;&lt;/a&gt;"
## [4] "&lt;/p&gt;"</code></pre>
</div>
</div>
<div id="other-functions" class="section level3">
<h3>
<span class="header-section-number">2.5.4</span> Other functions<a class="anchor" aria-label="anchor" href="#other-functions"><i class="fas fa-link"></i></a>
</h3>
<p>The <a href="https://github.com/ThinkR-open/golem/blob/dev/inst/utils/golem_utils_ui.R">golem</a> package written by <a href="https://thinkr.fr">thinkr</a> contains neat functions to edit your tags.</p>
<p>Particularly, the <code>tagRemoveAttributes</code>:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tagRemoveAttributes</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">attrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">attrs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">tag</span><span class="op">$</span><span class="va">attribs</span><span class="op">[[</span> <span class="va">attrs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="op">}</span>
  <span class="va">tag</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"test"</span>, id <span class="op">=</span> <span class="st">"coucou"</span>, <span class="st">"Hello"</span><span class="op">)</span>
<span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu">tagRemoveAttributes</span><span class="op">(</span><span class="va">myTag</span>, <span class="st">"class"</span>, <span class="st">"id"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div&gt;Hello&lt;/div&gt;"</code></pre>
</div>
<div id="conditionally-set-attributes" class="section level3">
<h3>
<span class="header-section-number">2.5.5</span> Conditionally set attributes<a class="anchor" aria-label="anchor" href="#conditionally-set-attributes"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes, you only want to set attributes under specific conditions.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_button</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">color</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">button</span><span class="op">(</span> 
    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"color:"</span>, <span class="va">color</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"Hello"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Calling <code>my_button()</code> would give:</p>
<pre><code>## [1] "&lt;button style="color: "&gt;"
## [2] "  &lt;p&gt;Hello&lt;/p&gt;"
## [3] "&lt;/button&gt;"</code></pre>
<p>This example will not fail but having <code>style="color: "</code> is not clean. We may use conditions:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_button</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">color</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">button</span><span class="op">(</span> 
    style <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"color:"</span>, <span class="va">color</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"Hello"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Below, we call <code>my_button("blue")</code> and <code>my_button()</code>:</p>
<pre><code>## [1] "&lt;button style="color: blue"&gt;"
## [2] "  &lt;p&gt;Hello&lt;/p&gt;"
## [3] "&lt;/button&gt;"</code></pre>
<pre><code>## [1] "&lt;button&gt;"
## [2] "  &lt;p&gt;Hello&lt;/p&gt;"
## [3] "&lt;/button&gt;"</code></pre>
<p>In this example, style won’t be available if color is not specified.</p>
</div>
<div id="using" class="section level3">
<h3>
<span class="header-section-number">2.5.6</span> Using %&gt;%<a class="anchor" aria-label="anchor" href="#using"><i class="fas fa-link"></i></a>
</h3>
<p>While doing a lot of manipulation for a tag, if you don’t need to create intermediate
objects, this is a good idea to use <code><a href="https://rdrr.io/pkg/shinyRPG/man/pipe.html">%&gt;%</a></code> from <a href="https://magrittr.tidyverse.org">magrittr</a>:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"cl"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h1</a></span><span class="op">(</span><span class="st">"Hello"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagAppendAttributes</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"myid"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChild</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"some extra text here!"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div&gt;Hello&lt;/div&gt;"</code></pre>
<p>This is overall easier to follow and read.</p>
</div>
<div id="programmatically-create-children-elements" class="section level3">
<h3>
<span class="header-section-number">2.5.7</span> Programmatically create children elements<a class="anchor" aria-label="anchor" href="#programmatically-create-children-elements"><i class="fas fa-link"></i></a>
</h3>
<p>Assume you want to create a tag with five children inside:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div&gt;"
## [2] "  &lt;span&gt;1&lt;/span&gt;"
## [3] "  &lt;span&gt;2&lt;/span&gt;"
## [4] "  &lt;span&gt;3&lt;/span&gt;"
## [5] "  &lt;span&gt;4&lt;/span&gt;"
## [6] "  &lt;span&gt;5&lt;/span&gt;"
## [7] "&lt;/div&gt;"</code></pre>
<p>The structure is correct but imagine if you had to create 1000 <code><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span()</a></code> or fancier tag. The previous approach is not consistent with the <strong>DRY</strong> programming concept. <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> function will be useful here (or the purrr <code>map()</code> family):</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># base R</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># purrr + %&gt;%</span>
<span class="fu">map</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "&lt;div&gt;"
## [2] "  &lt;span&gt;1&lt;/span&gt;"
## [3] "  &lt;span&gt;2&lt;/span&gt;"
## [4] "  &lt;span&gt;3&lt;/span&gt;"
## [5] "  &lt;span&gt;4&lt;/span&gt;"
## [6] "  &lt;span&gt;5&lt;/span&gt;"
## [7] "&lt;/div&gt;"</code></pre>
</div>
</div>
<div id="modern-htmltools" class="section level2">
<h2>
<span class="header-section-number">2.6</span> Modern <code>{htmltools}</code><a class="anchor" aria-label="anchor" href="#modern-htmltools"><i class="fas fa-link"></i></a>
</h2>
<p>As of <a href="https://github.com/rstudio/htmltools">htmltools</a> 0.5.2, the new <code>tagQuery</code> function makes manipulating shiny tags a real pleasure, in addition to be more efficient. If you know and like jQuery (Chapter <a href="survival-kit-javascript.html#intro-jquery">10.5</a>), the API is really similar. If you don’t know jQuery yet, no problem, we’ll see it later in the book!</p>
<div id="basics" class="section level3">
<h3>
<span class="header-section-number">2.6.1</span> Basics<a class="anchor" aria-label="anchor" href="#basics"><i class="fas fa-link"></i></a>
</h3>
<p><code>tagQuery</code> accepts a tag or list of tags as input and returns a data structure containing:</p>
<ul>
<li>
<code>$allTags()</code>: all tags.</li>
<li>
<code>$selectedTags()</code>: selected tags, default to <code>$allTags()</code>.</li>
</ul>
<p>As an example:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tag_query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagQuery.html">tagQuery</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">tag_query</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "shiny.tag.query"</code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tag_query</span></code></pre></div>
<pre><code>## `$allTags()`:
## &lt;div&gt;
##   &lt;p&gt;&lt;/p&gt;
## &lt;/div&gt;
## 
## `$selectedTags()`: `$allTags()`</code></pre>
<p>As shown above, the returned result is not a shiny tag. Instead, it is a <a href="https://r6.r-lib.org/articles/Introduction.html">R6</a> class having methods to handle those tags.</p>
</div>
</div>
<div id="exercises" class="section level2">
<h2>
<span class="header-section-number">2.7</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises"><i class="fas fa-link"></i></a>
</h2>
<div id="exercise-1-tags-structure" class="section level3">
<h3>
<span class="header-section-number">2.7.1</span> Exercise 1: tags structure<a class="anchor" aria-label="anchor" href="#exercise-1-tags-structure"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the following shiny tag:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span><span class="op">(</span>
  class <span class="op">=</span> <span class="st">"btn btn-large"</span>,
  type <span class="op">=</span> <span class="st">"button"</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"child1"</span>, id <span class="op">=</span> <span class="st">"super-span"</span>, <span class="fl">1</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"child2"</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">myTag</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Inspect its structure. Hint: you may use <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>.</li>
<li>Access its class using <code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagGetAttribute()</a></code> and another method of your choice.</li>
<li>Modify the first child class to <code>custom class</code>.</li>
</ol>
</div>
<div id="exercise-2-modifiying-tags" class="section level3">
<h3>
<span class="header-section-number">2.7.2</span> Exercise 2: modifiying tags<a class="anchor" aria-label="anchor" href="#exercise-2-modifiying-tags"><i class="fas fa-link"></i></a>
</h3>
<p>Let us consider the following tag:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="st">"Hello World"</span><span class="op">)</span></code></pre></div>
<p>(You may chain functions with <code><a href="https://rdrr.io/pkg/shinyRPG/man/pipe.html">%&gt;%</a></code>)</p>
<ol style="list-style-type: decimal">
<li>Replace its unique child by <code><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a(href = "http://www.google.com", "click me!")</a></code>. Hint: <code><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagSetChildren()</a></code> is your friend.</li>
<li>Add 10 other <code><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span()</a></code>. Hint: tags may be programmatically generated with <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> or <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map</a></code>.</li>
</ol>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="web-intro.html"><span class="header-section-number">1</span> Shiny and the Web</a></div>
<div class="next"><a href="web-dependencies.html"><span class="header-section-number">3</span> Discover Shiny dependencies</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#htmltools-overview"><span class="header-section-number">2</span> htmltools overview</a></li>
<li><a class="nav-link" href="#writing-html-tags-from-r"><span class="header-section-number">2.1</span> Writing HTML Tags from R</a></li>
<li><a class="nav-link" href="#notations"><span class="header-section-number">2.2</span> Notations</a></li>
<li><a class="nav-link" href="#adding-new-tags"><span class="header-section-number">2.3</span> Adding new tags</a></li>
<li><a class="nav-link" href="#alternative-way-to-write-tags"><span class="header-section-number">2.4</span> Alternative way to write tags</a></li>
<li>
<a class="nav-link" href="#playing-with-tags"><span class="header-section-number">2.5</span> Playing with tags</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tags-structure"><span class="header-section-number">2.5.1</span> Tags structure</a></li>
<li><a class="nav-link" href="#practical-examples-shinyrpg"><span class="header-section-number">2.5.2</span> Practical examples: shinyRPG</a></li>
<li><a class="nav-link" href="#useful-functions-for-tags"><span class="header-section-number">2.5.3</span> Useful functions for tags</a></li>
<li><a class="nav-link" href="#other-functions"><span class="header-section-number">2.5.4</span> Other functions</a></li>
<li><a class="nav-link" href="#conditionally-set-attributes"><span class="header-section-number">2.5.5</span> Conditionally set attributes</a></li>
<li><a class="nav-link" href="#using"><span class="header-section-number">2.5.6</span> Using %&gt;%</a></li>
<li><a class="nav-link" href="#programmatically-create-children-elements"><span class="header-section-number">2.5.7</span> Programmatically create children elements</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#modern-htmltools"><span class="header-section-number">2.6</span> Modern {htmltools}</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#basics"><span class="header-section-number">2.6.1</span> Basics</a></li></ul>
</li>
<li>
<a class="nav-link" href="#exercises"><span class="header-section-number">2.7</span> Exercises</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercise-1-tags-structure"><span class="header-section-number">2.7.1</span> Exercise 1: tags structure</a></li>
<li><a class="nav-link" href="#exercise-2-modifiying-tags"><span class="header-section-number">2.7.2</span> Exercise 2: modifiying tags</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/blob/master/htmltools-overview.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/edit/master/htmltools-overview.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Outstanding User Interfaces with Shiny</strong>" was written by David Granjon. It was last built on 2021-07-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
