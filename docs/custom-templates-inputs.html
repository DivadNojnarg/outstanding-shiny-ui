<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 19 Develop custom input widgets | Outstanding User Interfaces with Shiny</title>
<meta name="author" content="David Granjon">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.9002/transition.js"></script><script src="libs/bs3compat-0.2.5.9002/tabs.js"></script><script src="libs/bs3compat-0.2.5.9002/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Outstanding User Interfaces with Shiny</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="web-intro.html"><span class="header-section-number">1</span> Shiny and the Web</a></li>
<li><a class="" href="htmltools-overview.html"><span class="header-section-number">2</span> Mastering {htmltools}</a></li>
<li><a class="" href="web-dependencies.html"><span class="header-section-number">3</span> Discover Shiny dependencies</a></li>
<li><a class="" href="htmltools-dependencies.html"><span class="header-section-number">4</span> Dependency utilities</a></li>
<li><a class="" href="web-applications.html"><span class="header-section-number">5</span> Web application concepts</a></li>
<li class="book-part">Beautify with CSS and Sass</li>
<li><a class="" href="beautify-css.html"><span class="header-section-number">6</span> CSS for Shiny</a></li>
<li><a class="" href="beautify-sass.html"><span class="header-section-number">7</span> Introduction to Sass</a></li>
<li><a class="" href="beautify-with-fresh.html"><span class="header-section-number">8</span> Beautify with {fresh}</a></li>
<li><a class="" href="beautify-with-bootstraplib.html"><span class="header-section-number">9</span> Beautify with {bslib}</a></li>
<li class="book-part">Unleash interactivity with JavaScript</li>
<li><a class="" href="survival-kit-javascript.html"><span class="header-section-number">10</span> JavaScript for Shiny</a></li>
<li><a class="" href="shiny-intro.html"><span class="header-section-number">11</span> R and JS</a></li>
<li><a class="" href="shiny-input-system.html"><span class="header-section-number">12</span> Shiny’s input system</a></li>
<li><a class="" href="shiny-input-lifecycle.html"><span class="header-section-number">13</span> Shiny inputs lifecycles</a></li>
<li><a class="" href="shiny-input-gems.html"><span class="header-section-number">14</span> Mastering Shiny’s events</a></li>
<li><a class="" href="shiny-custom-handler.html"><span class="header-section-number">15</span> Dynamically manage content with handlers</a></li>
<li class="book-part">Practice 1: a dashboard template</li>
<li><a class="" href="custom-templates-selection.html"><span class="header-section-number">16</span> Template selection</a></li>
<li><a class="" href="custom-templates-dependencies.html"><span class="header-section-number">17</span> Define dependencies</a></li>
<li><a class="" href="custom-templates-skeleton.html"><span class="header-section-number">18</span> Create template elements</a></li>
<li><a class="active" href="custom-templates-inputs.html"><span class="header-section-number">19</span> Develop custom input widgets</a></li>
<li><a class="" href="custom-templates-interactivity.html"><span class="header-section-number">20</span> Adding more interactivity</a></li>
<li><a class="" href="custom-templates-testing.html"><span class="header-section-number">21</span> Testing and validating templates elements</a></li>
<li class="book-part">Toward a better workflow</li>
<li><a class="" href="workflow-charpente.html"><span class="header-section-number">22</span> Introduction to {charpente}</a></li>
<li class="book-part">Case study 2: Mobile development with Shiny</li>
<li><a class="" href="mobile-shiny-intro.html"><span class="header-section-number">23</span> Introduction</a></li>
<li><a class="" href="mobile-shinyMobile.html"><span class="header-section-number">24</span> Reconstruct {shinyMobile}</a></li>
<li><a class="" href="mobile-pwa.html"><span class="header-section-number">25</span> {shinyMobile} and PWA</a></li>
<li><a class="" href="mobile-widgets.html"><span class="header-section-number">26</span> Design widgets</a></li>
<li><a class="" href="mobile-going-further.html"><span class="header-section-number">27</span> Fine tune {shinyMobile}</a></li>
<li class="book-part">Going further</li>
<li><a class="" href="going-further-reactR.html"><span class="header-section-number">28</span> R + Shiny + React: welcome {reactR}</a></li>
<li><a class="" href="going-further-where-to-go.html"><span class="header-section-number">29</span> What to do next?</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="code-outputs.html"><span class="header-section-number">A</span> Code outputs</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/DivadNojnarg/outstanding-shiny-ui">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="custom-templates-inputs" class="section level1">
<h1>
<span class="header-section-number">19</span> Develop custom input widgets<a class="anchor" aria-label="anchor" href="#custom-templates-inputs"><i class="fas fa-link"></i></a>
</h1>
<p>In the previous chapter, we built template <strong>dependencies</strong>, the page <strong>skeleton</strong>, as well as containers like cards. Now, it is a great time to integrate new inputs, leveraging all knowledge from Chapter <a href="shiny-input-system.html#shiny-input-system">12</a>.</p>
<div id="tabler-action-button" class="section level2">
<h2>
<span class="header-section-number">19.1</span> Tabler action button<a class="anchor" aria-label="anchor" href="#tabler-action-button"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s start with a simple input: the <strong>action button</strong>. Tabler has built-in HTML buttons with a substantial amount of custom styles, compared to the classic Shiny action button.</p>
<div id="reminders-about-the-action-button" class="section level3">
<h3>
<span class="header-section-number">19.1.1</span> Reminders about the action button<a class="anchor" aria-label="anchor" href="#reminders-about-the-action-button"><i class="fas fa-link"></i></a>
</h3>
<p>Below is the <code><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton()</a></code> code:</p>
<div class="sourceCode" id="cb589"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">actionButton</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">inputId</span>, <span class="va">label</span>, <span class="va">icon</span> <span class="op">=</span> <span class="cn">NULL</span>, 
                          <span class="va">width</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>  <span class="op">{</span>
  <span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/restoreInput.html">restoreInput</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">inputId</span>, default <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">button</span><span class="op">(</span>
    id <span class="op">=</span> <span class="va">inputId</span>, 
    style <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"width: "</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/validateCssUnit.html">validateCssUnit</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span>, <span class="st">";"</span><span class="op">)</span>
    <span class="op">}</span>, 
    type <span class="op">=</span> <span class="st">"button"</span>, 
    class <span class="op">=</span> <span class="st">"btn btn-default action-button"</span>, 
    `data-val` <span class="op">=</span> <span class="va">value</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">validateIcon</span><span class="op">(</span><span class="va">icon</span><span class="op">)</span>, <span class="va">label</span><span class="op">)</span>, <span class="va">...</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The button tag has some <strong>attributes</strong> like
id, style, type, class, <code>data-val</code>, label and children passed via <code>...</code>.</p>
<p>When the app starts, the action button has the value 0 and each click increments its value by 1. How is this behavior controlled? If you recall, it is due to the input binding file, specifically the one for the action button:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb590-1"><a href="custom-templates-inputs.html#cb590-1"></a><span class="kw">var</span> actionButtonInputBinding <span class="op">=</span> <span class="kw">new</span> <span class="at">InputBinding</span>()<span class="op">;</span></span>
<span id="cb590-2"><a href="custom-templates-inputs.html#cb590-2"></a><span class="va">$</span>.<span class="at">extend</span>(actionButtonInputBinding<span class="op">,</span> <span class="op">{</span></span>
<span id="cb590-3"><a href="custom-templates-inputs.html#cb590-3"></a>  <span class="dt">find</span><span class="op">:</span> <span class="kw">function</span>(scope) <span class="op">{</span></span>
<span id="cb590-4"><a href="custom-templates-inputs.html#cb590-4"></a>    <span class="cf">return</span> <span class="at">$</span>(scope).<span class="at">find</span>(<span class="st">".action-button"</span>)<span class="op">;</span></span>
<span id="cb590-5"><a href="custom-templates-inputs.html#cb590-5"></a>  <span class="op">},</span></span>
<span id="cb590-6"><a href="custom-templates-inputs.html#cb590-6"></a>  <span class="dt">getValue</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb590-7"><a href="custom-templates-inputs.html#cb590-7"></a>    <span class="cf">return</span> <span class="at">$</span>(el).<span class="at">data</span>(<span class="st">'val'</span>) <span class="op">||</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb590-8"><a href="custom-templates-inputs.html#cb590-8"></a>  <span class="op">},</span></span>
<span id="cb590-9"><a href="custom-templates-inputs.html#cb590-9"></a>  <span class="co">// ....; Extra code removed</span></span>
<span id="cb590-10"><a href="custom-templates-inputs.html#cb590-10"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>What you see above is <strong>not</strong> the whole script since we focus on the first method, that is <code>find</code>. It will look for <strong>all</strong> elements having the class <code>action-button</code>, making it possible to define multiple action buttons at the same time.</p>
<p>Consequently, if we go back to the previous section, the <code><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton()</a></code> has the class <code>action-button</code>, thereby making it visible to the binding. Interestingly, all elements having the class <code>action-button</code> will be considered by the same shiny input binding.</p>
</div>
<div id="application-to-tabler" class="section level3">
<h3>
<span class="header-section-number">19.1.2</span> Application to Tabler<a class="anchor" aria-label="anchor" href="#application-to-tabler"><i class="fas fa-link"></i></a>
</h3>
<p>First of all, let’s compare the tabler HTML button to the Shiny action button.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb591-1"><a href="custom-templates-inputs.html#cb591-1"></a><span class="kw">&lt;button</span><span class="ot"> class=</span><span class="st">"btn btn-primary"</span><span class="kw">&gt;</span>Button<span class="kw">&lt;/button&gt;</span></span></code></pre></div>
<p>We convert it to R code. The button API contains more style and we leave the reader to add extra elements
as an exercise:</p>
<div class="sourceCode" id="cb592"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tabler_button</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">label</span>, <span class="va">status</span> <span class="op">=</span> <span class="cn">NULL</span>, 
                          <span class="va">icon</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">width</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">btn_cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
    <span class="st">"btn action-button"</span>,
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="st">" btn-primary"</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">" btn-"</span>, <span class="va">status</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span>
  
  <span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/restoreInput.html">restoreInput</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">inputId</span>, default <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
  
  <span class="co"># custom right margin</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">icon</span><span class="op">)</span><span class="op">)</span> <span class="va">icon</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
    <span class="va">icon</span><span class="op">$</span><span class="va">attribs</span><span class="op">$</span><span class="va">class</span>, <span class="st">" mr-1"</span>
  <span class="op">)</span>
  
  <span class="va">tags</span><span class="op">$</span><span class="fu">button</span><span class="op">(</span>
    id <span class="op">=</span> <span class="va">inputId</span>, 
    style <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"width: "</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/validateCssUnit.html">validateCssUnit</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span>, <span class="st">";"</span><span class="op">)</span>
    <span class="op">}</span>, 
    type <span class="op">=</span> <span class="st">"button"</span>, 
    class <span class="op">=</span> <span class="va">btn_cl</span>, 
    `data-val` <span class="op">=</span> <span class="va">value</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">icon</span>, <span class="va">label</span><span class="op">)</span>, <span class="va">...</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In Tabler, the button <strong>status</strong> is mandatory, which is the reason why it is a function parameter. Moreover, we add an horizontal right margin to the icon, if provided so that the label renders well (<code>mr-1</code>, where m stands for margin, r is the right direction and 1 is the margin value). We assume that by default, the button have a blue color, that is given by <code>btn-primary</code>:</p>
<div class="sourceCode" id="cb593"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_page.html">tabler_page</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_body.html">tabler_body</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_button.html">tabler_button</a></span><span class="op">(</span>
      <span class="st">"btn"</span>, 
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Value"</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html">textOutput</a></span><span class="op">(</span><span class="st">"val"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span><span class="op">)</span>, 
      icon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/icon.html">icon</a></span><span class="op">(</span><span class="st">"thumbs-up"</span><span class="op">)</span>, 
      width <span class="op">=</span> <span class="st">"25%"</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">output</span><span class="op">$</span><span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html">renderText</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">btn</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>We easily check that clicking on the button increments the related input. Thus, one may see how easy it is to implement a Tabler input button, built on top of the Shiny action button. The output is shown in Figure <a href="custom-templates-inputs.html#fig:tabler-button">19.1</a>.</p>
<div class="figure">
<span id="fig:tabler-button"></span>
<img src="images/practice/tabler-button.png" alt="Tabler action button" width="100%"><p class="caption">
FIGURE 19.1: Tabler action button
</p>
</div>
<div class="noteblock">
<p>As a general rule, don’t try to reinvent the wheel and see whether any existing Shiny element may be used instead!</p>
</div>
</div>
</div>
<div id="toggle-switch" class="section level2">
<h2>
<span class="header-section-number">19.2</span> Toggle Switch<a class="anchor" aria-label="anchor" href="#toggle-switch"><i class="fas fa-link"></i></a>
</h2>
<p>We implement the toggle <a href="https://preview-dev.tabler.io/docs/form-elements.html#custom-selectboxes">switch</a> component.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb594-1"><a href="custom-templates-inputs.html#cb594-1"></a><span class="kw">&lt;label</span><span class="ot"> class=</span><span class="st">"form-check form-switch"</span><span class="kw">&gt;</span></span>
<span id="cb594-2"><a href="custom-templates-inputs.html#cb594-2"></a>  <span class="kw">&lt;input</span><span class="ot"> class=</span><span class="st">"form-check-input"</span><span class="ot"> type=</span><span class="st">"checkbox"</span><span class="ot"> checked</span><span class="kw">&gt;</span></span>
<span id="cb594-3"><a href="custom-templates-inputs.html#cb594-3"></a>  <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">"form-check-label"</span><span class="kw">&gt;</span>Option 1<span class="kw">&lt;/span&gt;</span></span>
<span id="cb594-4"><a href="custom-templates-inputs.html#cb594-4"></a><span class="kw">&lt;/label&gt;</span></span></code></pre></div>
<p>Notice that the tabler switch has the checkbox type, which is very similar to the Shiny checkbox (a switch being a checkbox with a different style):</p>
<div class="sourceCode" id="cb595"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/checkboxInput.html">checkboxInput</a></span><span class="op">(</span><span class="st">"test"</span>, <span class="st">"Test"</span>, <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; &lt;div class="form-group shiny-input-container"&gt;
#&gt;   &lt;div class="checkbox"&gt;
#&gt;     &lt;label&gt;
#&gt;       &lt;input id="test" type="checkbox" checked="checked"/&gt;
#&gt;       &lt;span&gt;Test&lt;/span&gt;
#&gt;     &lt;/label&gt;
#&gt;   &lt;/div&gt;
#&gt; &lt;/div&gt;</code></pre>
<p>Therefore, we should again be able to build on top of an existing input <a href="https://github.com/rstudio/shiny/blob/master/srcjs/input_binding_checkbox.js">binding</a>. We create the <code><a href="https://rdrr.io/pkg/OSUICode/man/tabler_switch.html">tabler_switch()</a></code> function:</p>
<div class="sourceCode" id="cb597"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tabler_switch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">label</span>, <span class="va">value</span> <span class="op">=</span> <span class="cn">FALSE</span>, 
                          <span class="va">width</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/restoreInput.html">restoreInput</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">inputId</span>, default <span class="op">=</span> <span class="va">value</span><span class="op">)</span>
  <span class="va">input_tag</span> <span class="op">&lt;-</span> <span class="va">tags</span><span class="op">$</span><span class="fu">input</span><span class="op">(</span>
    id <span class="op">=</span> <span class="va">inputId</span>, 
    type <span class="op">=</span> <span class="st">"checkbox"</span>,
    class <span class="op">=</span> <span class="st">"form-check-input"</span>
  <span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">input_tag</span> <span class="op">&lt;-</span> <span class="va">input_tag</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendAttributes.html">tagAppendAttributes</a></span><span class="op">(</span>checked <span class="op">=</span> <span class="st">"checked"</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">input_wrapper</span> <span class="op">&lt;-</span> <span class="va">tags</span><span class="op">$</span><span class="fu">label</span><span class="op">(</span>
    class <span class="op">=</span> <span class="st">"form-check form-switch"</span>, 
    style <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"width: "</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/validateCssUnit.html">validateCssUnit</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span>, <span class="st">";"</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span>
  
  <span class="va">input_wrapper</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagAppendChild.html">tagAppendChildren</a></span><span class="op">(</span>
    <span class="va">input_tag</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"form-check-label"</span>, <span class="va">label</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Besides, we may also create an <code><a href="https://rdrr.io/pkg/OSUICode/man/update_tabler_switch.html">update_tabler_switch()</a></code> function similar to the <code><a href="https://rdrr.io/pkg/shiny/man/updateCheckboxInput.html">updateCheckboxInput()</a></code>. We leverage <code>shiny:::dropNulls</code>, a function that removes all <code>NULL</code> elements from a list. If you remember, the <code>session$sendInputMessage</code> from R is received by the <code>receiveMessage</code> method on the JavaScript side:</p>
<div class="sourceCode" id="cb598"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dropNulls</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">is.null</span>, FUN.VALUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html">logical</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="op">}</span>

<span class="va">update_tabler_switch</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">session</span>, <span class="va">inputId</span>, 
                                  <span class="va">label</span> <span class="op">=</span> <span class="cn">NULL</span>, 
                                  <span class="va">value</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">message</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/dropNulls.html">dropNulls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span>, value <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span>
  <span class="va">session</span><span class="op">$</span><span class="fu">sendInputMessage</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">message</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In the following example, the action button toggles the switch input value when clicked, as shown in Figure <a href="custom-templates-inputs.html#fig:tabler-toggle">19.2</a>.</p>
<div class="sourceCode" id="cb599"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_page.html">tabler_page</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_body.html">tabler_body</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidRow</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_button.html">tabler_button</a></span><span class="op">(</span>
        <span class="st">"update"</span>, 
        <span class="st">"Go!"</span>, 
        width <span class="op">=</span> <span class="st">"25%"</span>, 
        class <span class="op">=</span> <span class="st">"mr-2"</span>
      <span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_switch.html">tabler_switch</a></span><span class="op">(</span>
        <span class="st">"toggle"</span>, 
        <span class="st">"Switch"</span>, 
        value <span class="op">=</span> <span class="cn">TRUE</span>, 
        width <span class="op">=</span> <span class="st">"25%"</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html">observe</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">toggle</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/update_tabler_switch.html">update_tabler_switch</a></span><span class="op">(</span>
      <span class="va">session</span>, 
      <span class="st">"toggle"</span>, 
      value <span class="op">=</span> <span class="op">!</span><span class="va">input</span><span class="op">$</span><span class="va">toggle</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span id="fig:tabler-toggle"></span>
<img src="images/practice/tabler-toggle.png" alt="Tabler action button updating a toggle input" width="100%"><p class="caption">
FIGURE 19.2: Tabler action button updating a toggle input
</p>
</div>
<p>Et voilà! Two inputs in just a few minutes.</p>
</div>
<div id="custom-templates-inputs-navbar" class="section level2">
<h2>
<span class="header-section-number">19.3</span> Navbar menu input<a class="anchor" aria-label="anchor" href="#custom-templates-inputs-navbar"><i class="fas fa-link"></i></a>
</h2>
<p>As stated in Chapter <a href="shiny-input-system.html#shiny-input-system">12</a>, it is quite straightforward to bind other elements than primary inputs (HTML elements with the input tag) to Shiny. As a reminder, we created a custom input binding to detect the state of a <a href="http://rstudio.github.io/shinydashboard/">shinydashboard</a> box.
In chapter <a href="custom-templates-skeleton.html#custom-templates-skeleton">18</a>, we designed the <code><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar.html">tabler_navbar()</a></code> as well as the <code><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar_menu.html">tabler_navbar_menu()</a></code> and <code><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar_menu_item.html">tabler_navbar_menu_item()</a></code>. As in <a href="http://rstudio.github.io/shinydashboard/">shinydashboard</a>, it would be great to capture the currently selected tab to subsequently perform actions on the server side, updating the selected tab based on a button click.</p>
<p>Where do we start? First of all, we add an <strong>id</strong> attribute to the <code><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar_menu.html">tabler_navbar_menu()</a></code> so that it holds the corresponding <code>input$id</code>. Whether to use <code>inputId</code> or <code>id</code> as a parameter name is up to you, <code>id</code> being personally prefered in that case:</p>
<div class="sourceCode" id="cb600"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tabler_navbar_menu</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">inputId</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span>
    id <span class="op">=</span> <span class="va">inputId</span>, 
    class <span class="op">=</span> <span class="st">"nav nav-pills navbar-nav"</span>,
    <span class="va">...</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The next step is the JS <code>navbarMenuBinding</code> creation. We decide to look for the <code>navbar-nav</code> class in the <code>find</code> method. Below, we describe the binding step by step. You may find the whole working code at the end of this example:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb601-1"><a href="custom-templates-inputs.html#cb601-1"></a>find<span class="op">:</span> <span class="kw">function</span>(scope) <span class="op">{</span></span>
<span id="cb601-2"><a href="custom-templates-inputs.html#cb601-2"></a>  <span class="cf">return</span> <span class="at">$</span>(scope).<span class="at">find</span>(<span class="st">'.navbar-nav'</span>)<span class="op">;</span></span>
<span id="cb601-3"><a href="custom-templates-inputs.html#cb601-3"></a><span class="op">}</span></span></code></pre></div>
<p>In the <code>initialize</code> method, we ensure that if no tab is selected at start, the first tab will be selected by default. Otherwise, we select the activated tab. We use the <strong>template literals</strong> to ease the insertion of JS code in strings (<code>${menuId} .nav-link.active</code>):</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb602-1"><a href="custom-templates-inputs.html#cb602-1"></a>initialize<span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb602-2"><a href="custom-templates-inputs.html#cb602-2"></a>  <span class="kw">let</span> menuId <span class="op">=</span> <span class="st">'#'</span> <span class="op">+</span> <span class="at">$</span>(el).<span class="at">attr</span>(<span class="st">'id'</span>)<span class="op">;</span></span>
<span id="cb602-3"><a href="custom-templates-inputs.html#cb602-3"></a>  <span class="kw">let</span> activeTab <span class="op">=</span> <span class="at">$</span>(<span class="vs">`</span><span class="sc">${</span>menuId<span class="sc">}</span><span class="vs"> .nav-link.active`</span>)<span class="op">;</span></span>
<span id="cb602-4"><a href="custom-templates-inputs.html#cb602-4"></a>  <span class="co">// if multiple items are found</span></span>
<span id="cb602-5"><a href="custom-templates-inputs.html#cb602-5"></a>  <span class="cf">if</span> (<span class="va">activeTab</span>.<span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span></span>
<span id="cb602-6"><a href="custom-templates-inputs.html#cb602-6"></a>    <span class="kw">let</span> tabId <span class="op">=</span> <span class="at">$</span>(activeTab).<span class="at">attr</span>(<span class="st">'data-value'</span>)<span class="op">;</span></span>
<span id="cb602-7"><a href="custom-templates-inputs.html#cb602-7"></a>    <span class="at">$</span>(activeTab).<span class="at">tab</span>(<span class="st">'show'</span>)<span class="op">;</span></span>
<span id="cb602-8"><a href="custom-templates-inputs.html#cb602-8"></a>    <span class="at">$</span>(<span class="vs">`#</span><span class="sc">${</span>tabId<span class="sc">}</span><span class="vs">`</span>).<span class="at">addClass</span>(<span class="st">'show active'</span>)<span class="op">;</span></span>
<span id="cb602-9"><a href="custom-templates-inputs.html#cb602-9"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb602-10"><a href="custom-templates-inputs.html#cb602-10"></a>    <span class="at">$</span>(<span class="vs">`</span><span class="sc">${</span>menuId<span class="sc">}</span><span class="vs"> .nav-link`</span>)</span>
<span id="cb602-11"><a href="custom-templates-inputs.html#cb602-11"></a>      .<span class="at">first</span>()</span>
<span id="cb602-12"><a href="custom-templates-inputs.html#cb602-12"></a>      .<span class="at">tab</span>(<span class="st">'show'</span>)<span class="op">;</span></span>
<span id="cb602-13"><a href="custom-templates-inputs.html#cb602-13"></a>  <span class="op">}</span></span>
<span id="cb602-14"><a href="custom-templates-inputs.html#cb602-14"></a><span class="op">}</span></span></code></pre></div>
<p>The role of <code>getValue</code> is to return the currently selected tab.
As a reminder, here is the <code><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar_menu_item.html">tabler_navbar_menu_item()</a></code> function:</p>
<div class="sourceCode" id="cb603"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tabler_navbar_menu_item</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">text</span>, <span class="va">tabName</span>, 
                                    <span class="va">icon</span> <span class="op">=</span> <span class="cn">NULL</span>, 
                                    <span class="va">selected</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">item_cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"nav-link"</span>, <span class="kw">if</span><span class="op">(</span><span class="va">selected</span><span class="op">)</span> <span class="st">" active"</span><span class="op">)</span>
  
  <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span>
    class <span class="op">=</span> <span class="st">"nav-item"</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span><span class="op">(</span>
      class <span class="op">=</span> <span class="va">item_cl</span>,
      `data-target` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"#"</span>, <span class="va">tabName</span><span class="op">)</span>,
      `data-toggle` <span class="op">=</span> <span class="st">"pill"</span>, 
      `data-value` <span class="op">=</span> <span class="va">tabName</span>,
      role <span class="op">=</span> <span class="st">"tab"</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span>
        class <span class="op">=</span> <span class="st">"nav-link-icon d-md-none d-lg-inline-block"</span>, 
        <span class="va">icon</span>
      <span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"nav-link-title"</span>, <span class="va">text</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>From that function, the active item has is the <code>a</code> element with the classes <code>nav-link active</code>. We recover the tab value stored in the <code>data-value</code> attribute. A bit of jQuery does the trick:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb604-1"><a href="custom-templates-inputs.html#cb604-1"></a>getValue<span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb604-2"><a href="custom-templates-inputs.html#cb604-2"></a>  <span class="kw">let</span> activeTab <span class="op">=</span> <span class="at">$</span>(el).<span class="at">find</span>(<span class="st">'a'</span>).<span class="at">filter</span>(<span class="st">'nav-link active'</span>)<span class="op">;</span></span>
<span id="cb604-3"><a href="custom-templates-inputs.html#cb604-3"></a>  <span class="cf">return</span> <span class="at">$</span>(activeTab).<span class="at">attr</span>(<span class="st">'data-value'</span>)<span class="op">;</span></span>
<span id="cb604-4"><a href="custom-templates-inputs.html#cb604-4"></a><span class="op">}</span></span></code></pre></div>
<p><code>setValue</code> is the function allowing to update the active tab. Bootstrap 4 already has
predefined methods to <a href="https://getbootstrap.com/docs/4.0/components/navs/#via-javascript">activate</a> tabs. The easiest way is to select the tab by name like <code>$('#tabMenu a[data-target="#tab1"]').tab('show')</code>. The <code>receiveMessage</code> is simply applying the <code>setValue</code> method:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb605-1"><a href="custom-templates-inputs.html#cb605-1"></a>setValue<span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> value) <span class="op">{</span></span>
<span id="cb605-2"><a href="custom-templates-inputs.html#cb605-2"></a>  <span class="kw">let</span> hrefVal <span class="op">=</span> <span class="st">'#'</span> <span class="op">+</span> value<span class="op">;</span></span>
<span id="cb605-3"><a href="custom-templates-inputs.html#cb605-3"></a>  <span class="kw">let</span> menuId <span class="op">=</span> <span class="at">$</span>(el).<span class="at">attr</span>(<span class="st">'id'</span>)<span class="op">;</span></span>
<span id="cb605-4"><a href="custom-templates-inputs.html#cb605-4"></a>  <span class="at">$</span>(<span class="vs">`#</span><span class="sc">${</span>menuId<span class="sc">}</span><span class="vs"> a[data-target="</span><span class="sc">${</span>hrefVal<span class="sc">}</span><span class="vs">"]`</span>).<span class="at">tab</span>(<span class="st">'show'</span>)<span class="op">;</span></span>
<span id="cb605-5"><a href="custom-templates-inputs.html#cb605-5"></a><span class="op">}</span></span>
<span id="cb605-6"><a href="custom-templates-inputs.html#cb605-6"></a></span>
<span id="cb605-7"><a href="custom-templates-inputs.html#cb605-7"></a>receiveMessage<span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> data) <span class="op">{</span></span>
<span id="cb605-8"><a href="custom-templates-inputs.html#cb605-8"></a>  <span class="kw">this</span>.<span class="at">setValue</span>(el<span class="op">,</span> data)<span class="op">;</span></span>
<span id="cb605-9"><a href="custom-templates-inputs.html#cb605-9"></a><span class="op">}</span></span></code></pre></div>
<p>Besides, we have to create the <code><a href="https://rdrr.io/pkg/OSUICode/man/update_tabler_tab_item.html">update_tabler_tab_item()</a></code> function:</p>
<div class="sourceCode" id="cb606"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">update_tabler_tab_item</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
  <span class="va">inputId</span>, 
  <span class="va">value</span>, 
  <span class="va">session</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/domains.html">getDefaultReactiveDomain</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span> <span class="op">{</span>
  <span class="va">session</span><span class="op">$</span><span class="fu">sendInputMessage</span><span class="op">(</span><span class="va">inputId</span>, message <span class="op">=</span> <span class="va">value</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><code>subscribe</code> tells Shiny when to change the current input value and made it available
in the whole app. We may listen to multiple events, keeping in mind that events occur in the following order:</p>
<ul>
<li>
<code>hide.bs.tab</code> (on the current active tab).</li>
<li>
<code>show.bs.tab</code> (on the to-be-shown tab).</li>
<li>
<code>hidden.bs.tab</code> (on the previous active tab, the same one as for the hide.bs.tab event).</li>
<li>
<code>shown.bs.tab</code> (on the newly-active just-shown tab, the same one as for the show.bs.tab event).</li>
</ul>
<p>Hence, it makes more sense to listen to <code>shown.bs.tab</code> (wait the current tab to be shown):</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb607-1"><a href="custom-templates-inputs.html#cb607-1"></a>subscribe<span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> callback) <span class="op">{</span></span>
<span id="cb607-2"><a href="custom-templates-inputs.html#cb607-2"></a>  <span class="co">// important to use shown.bs.tab and not show.bs.tab!</span></span>
<span id="cb607-3"><a href="custom-templates-inputs.html#cb607-3"></a>  <span class="at">$</span>(el).<span class="at">on</span>(<span class="st">'shown.bs.tab.navbarMenuBinding'</span><span class="op">,</span> <span class="kw">function</span>(e) <span class="op">{</span></span>
<span id="cb607-4"><a href="custom-templates-inputs.html#cb607-4"></a>    <span class="at">callback</span>()<span class="op">;</span></span>
<span id="cb607-5"><a href="custom-templates-inputs.html#cb607-5"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb607-6"><a href="custom-templates-inputs.html#cb607-6"></a><span class="op">},</span></span>
<span id="cb607-7"><a href="custom-templates-inputs.html#cb607-7"></a>  </span>
<span id="cb607-8"><a href="custom-templates-inputs.html#cb607-8"></a>unsubscribe<span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb607-9"><a href="custom-templates-inputs.html#cb607-9"></a>  <span class="at">$</span>(el).<span class="at">off</span>(<span class="st">'.navbarMenuBinding'</span>)<span class="op">;</span></span>
<span id="cb607-10"><a href="custom-templates-inputs.html#cb607-10"></a><span class="op">}</span></span></code></pre></div>
<p>Below is a recap of the binding with the creation and registration included:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb608-1"><a href="custom-templates-inputs.html#cb608-1"></a><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb608-2"><a href="custom-templates-inputs.html#cb608-2"></a>  <span class="co">// Input binding</span></span>
<span id="cb608-3"><a href="custom-templates-inputs.html#cb608-3"></a>  <span class="kw">let</span> navbarMenuBinding <span class="op">=</span> <span class="kw">new</span> <span class="va">Shiny</span>.<span class="at">InputBinding</span>()</span>
<span id="cb608-4"><a href="custom-templates-inputs.html#cb608-4"></a>  <span class="va">$</span>.<span class="at">extend</span>(navbarMenuBinding<span class="op">,</span> <span class="op">{</span></span>
<span id="cb608-5"><a href="custom-templates-inputs.html#cb608-5"></a>    <span class="dt">find</span><span class="op">:</span> <span class="kw">function</span>(scope) <span class="op">{</span></span>
<span id="cb608-6"><a href="custom-templates-inputs.html#cb608-6"></a>      <span class="cf">return</span> <span class="at">$</span>(scope).<span class="at">find</span>(<span class="st">'.navbar-nav'</span>)<span class="op">;</span></span>
<span id="cb608-7"><a href="custom-templates-inputs.html#cb608-7"></a>    <span class="op">},</span></span>
<span id="cb608-8"><a href="custom-templates-inputs.html#cb608-8"></a>    <span class="dt">initialize</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb608-9"><a href="custom-templates-inputs.html#cb608-9"></a>      <span class="kw">let</span> menuId <span class="op">=</span> <span class="st">'#'</span> <span class="op">+</span> <span class="at">$</span>(el).<span class="at">attr</span>(<span class="st">'id'</span>)<span class="op">;</span></span>
<span id="cb608-10"><a href="custom-templates-inputs.html#cb608-10"></a>      <span class="kw">let</span> activeTab <span class="op">=</span> <span class="at">$</span>(<span class="vs">`</span><span class="sc">${</span>menuId<span class="sc">}</span><span class="vs"> .nav-link.active`</span>)<span class="op">;</span></span>
<span id="cb608-11"><a href="custom-templates-inputs.html#cb608-11"></a>      <span class="co">// if multiple items are found</span></span>
<span id="cb608-12"><a href="custom-templates-inputs.html#cb608-12"></a>      <span class="cf">if</span> (<span class="va">activeTab</span>.<span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span></span>
<span id="cb608-13"><a href="custom-templates-inputs.html#cb608-13"></a>        <span class="kw">let</span> tabId <span class="op">=</span> <span class="at">$</span>(activeTab).<span class="at">attr</span>(<span class="st">'data-value'</span>)<span class="op">;</span></span>
<span id="cb608-14"><a href="custom-templates-inputs.html#cb608-14"></a>        <span class="at">$</span>(activeTab).<span class="at">tab</span>(<span class="st">'show'</span>)<span class="op">;</span></span>
<span id="cb608-15"><a href="custom-templates-inputs.html#cb608-15"></a>        <span class="at">$</span>(<span class="vs">`#</span><span class="sc">${</span>tabId<span class="sc">}</span><span class="vs">`</span>).<span class="at">addClass</span>(<span class="st">'show active'</span>)<span class="op">;</span></span>
<span id="cb608-16"><a href="custom-templates-inputs.html#cb608-16"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb608-17"><a href="custom-templates-inputs.html#cb608-17"></a>        <span class="at">$</span>(<span class="vs">`</span><span class="sc">${</span>menuId<span class="sc">}</span><span class="vs"> .nav-link`</span>)</span>
<span id="cb608-18"><a href="custom-templates-inputs.html#cb608-18"></a>          .<span class="at">first</span>()</span>
<span id="cb608-19"><a href="custom-templates-inputs.html#cb608-19"></a>          .<span class="at">tab</span>(<span class="st">'show'</span>)<span class="op">;</span></span>
<span id="cb608-20"><a href="custom-templates-inputs.html#cb608-20"></a>      <span class="op">}</span></span>
<span id="cb608-21"><a href="custom-templates-inputs.html#cb608-21"></a>    <span class="op">},</span></span>
<span id="cb608-22"><a href="custom-templates-inputs.html#cb608-22"></a>    <span class="co">// Given the DOM element for the input, return the value</span></span>
<span id="cb608-23"><a href="custom-templates-inputs.html#cb608-23"></a>    <span class="dt">getValue</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb608-24"><a href="custom-templates-inputs.html#cb608-24"></a>      <span class="kw">let</span> activeTab <span class="op">=</span> <span class="at">$</span>(el).<span class="at">find</span>(<span class="st">'a'</span>).<span class="at">filter</span>(<span class="st">'.nav-link.active'</span>)<span class="op">;</span></span>
<span id="cb608-25"><a href="custom-templates-inputs.html#cb608-25"></a>      <span class="cf">return</span> <span class="at">$</span>(activeTab).<span class="at">attr</span>(<span class="st">'data-value'</span>)<span class="op">;</span></span>
<span id="cb608-26"><a href="custom-templates-inputs.html#cb608-26"></a>    <span class="op">},</span></span>
<span id="cb608-27"><a href="custom-templates-inputs.html#cb608-27"></a>    <span class="dt">setValue</span><span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> value) <span class="op">{</span></span>
<span id="cb608-28"><a href="custom-templates-inputs.html#cb608-28"></a>      <span class="kw">let</span> hrefVal <span class="op">=</span> <span class="st">'#'</span> <span class="op">+</span> value<span class="op">;</span></span>
<span id="cb608-29"><a href="custom-templates-inputs.html#cb608-29"></a>      <span class="kw">let</span> menuId <span class="op">=</span> <span class="at">$</span>(el).<span class="at">attr</span>(<span class="st">'id'</span>)<span class="op">;</span></span>
<span id="cb608-30"><a href="custom-templates-inputs.html#cb608-30"></a>      <span class="at">$</span>(<span class="vs">`#</span><span class="sc">${</span>menuId<span class="sc">}</span><span class="vs"> a[href="</span><span class="sc">${</span>hrefVal<span class="sc">}</span><span class="vs">"]`</span>).<span class="at">tab</span>(<span class="st">'show'</span>)<span class="op">;</span></span>
<span id="cb608-31"><a href="custom-templates-inputs.html#cb608-31"></a>    <span class="op">},</span></span>
<span id="cb608-32"><a href="custom-templates-inputs.html#cb608-32"></a>    <span class="dt">receiveMessage</span><span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> data) <span class="op">{</span></span>
<span id="cb608-33"><a href="custom-templates-inputs.html#cb608-33"></a>      <span class="kw">this</span>.<span class="at">setValue</span>(el<span class="op">,</span> data)<span class="op">;</span></span>
<span id="cb608-34"><a href="custom-templates-inputs.html#cb608-34"></a>    <span class="op">},</span></span>
<span id="cb608-35"><a href="custom-templates-inputs.html#cb608-35"></a>    <span class="dt">subscribe</span><span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> callback) <span class="op">{</span></span>
<span id="cb608-36"><a href="custom-templates-inputs.html#cb608-36"></a>      <span class="at">$</span>(el).<span class="at">on</span>(<span class="st">'shown.bs.tab.navbarMenuBinding'</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb608-37"><a href="custom-templates-inputs.html#cb608-37"></a>        <span class="at">callback</span>()<span class="op">;</span></span>
<span id="cb608-38"><a href="custom-templates-inputs.html#cb608-38"></a>      <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb608-39"><a href="custom-templates-inputs.html#cb608-39"></a>    <span class="op">},</span></span>
<span id="cb608-40"><a href="custom-templates-inputs.html#cb608-40"></a>    <span class="dt">unsubscribe</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb608-41"><a href="custom-templates-inputs.html#cb608-41"></a>      <span class="at">$</span>(el).<span class="at">off</span>(<span class="st">'.navbarMenuBinding'</span>)<span class="op">;</span></span>
<span id="cb608-42"><a href="custom-templates-inputs.html#cb608-42"></a>    <span class="op">}</span></span>
<span id="cb608-43"><a href="custom-templates-inputs.html#cb608-43"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb608-44"><a href="custom-templates-inputs.html#cb608-44"></a>  </span>
<span id="cb608-45"><a href="custom-templates-inputs.html#cb608-45"></a>  <span class="va">Shiny</span>.<span class="va">inputBindings</span>.<span class="at">register</span>(navbarMenuBinding<span class="op">,</span> <span class="st">'navbar-menu'</span>)<span class="op">;</span></span>
<span id="cb608-46"><a href="custom-templates-inputs.html#cb608-46"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>How do we include this custom input binding in our package? In <code>{OSUICode}</code>, we created the following HTML <strong>dependency</strong>:</p>
<div class="sourceCode" id="cb609"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tabler_custom_js</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlDependency.html">htmlDependency</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"tabler-bindings"</span>,
  version <span class="op">=</span> <span class="st">"1.0.7"</span>,
  src <span class="op">=</span> <span class="st">"tabler"</span>,
  package <span class="op">=</span> <span class="st">"OSUICode"</span>,
  script <span class="op">=</span> <span class="st">"input-bindings/navbarMenuBinding.js"</span>
<span class="op">)</span></code></pre></div>
<p>We also updated the <code>add_tabler_deps</code>, as below.</p>
<div class="sourceCode" id="cb610"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">add_tabler_deps</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># below, the order is of critical importance!</span>
  <span class="va">deps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">bs4_deps</span>, <span class="va">tablers_deps</span>, <span class="va">tabler_custom_js</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlDependencies.html">attachDependencies</a></span><span class="op">(</span><span class="va">tag</span>, <span class="va">deps</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We test the new <code>navbar_menu()</code> binding below.</p>
<div class="sourceCode" id="cb611"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_page.html">tabler_page</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar.html">tabler_navbar</a></span><span class="op">(</span>
    brand_url <span class="op">=</span> <span class="st">"https://preview-dev.tabler.io"</span>, 
    brand_image <span class="op">=</span> <span class="st">"https://preview-dev.tabler.io/static/logo.svg"</span>, 
    nav_menu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar_menu.html">tabler_navbar_menu</a></span><span class="op">(</span>
      id <span class="op">=</span> <span class="st">"current_tab"</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar_menu_item.html">tabler_navbar_menu_item</a></span><span class="op">(</span>
        text <span class="op">=</span> <span class="st">"Tab 1"</span>,
        icon <span class="op">=</span> <span class="cn">NULL</span>,
        tabName <span class="op">=</span> <span class="st">"tab1"</span>,
        selected <span class="op">=</span> <span class="cn">TRUE</span>
      <span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_navbar_menu_item.html">tabler_navbar_menu_item</a></span><span class="op">(</span>
        text <span class="op">=</span> <span class="st">"Tab 2"</span>,
        icon <span class="op">=</span> <span class="cn">NULL</span>,
        tabName <span class="op">=</span> <span class="st">"tab2"</span>
      <span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_button.html">tabler_button</a></span><span class="op">(</span>
      <span class="st">"update"</span>, 
      <span class="st">"Change tab"</span>, 
      icon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/icon.html">icon</a></span><span class="op">(</span><span class="st">"exchange-alt"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_body.html">tabler_body</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_tab_items.html">tabler_tab_items</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_tab_item.html">tabler_tab_item</a></span><span class="op">(</span>
        tabName <span class="op">=</span> <span class="st">"tab1"</span>,
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">sliderInput</a></span><span class="op">(</span>
          <span class="st">"obs"</span>, 
          <span class="st">"Number of observations:"</span>,
          min <span class="op">=</span> <span class="fl">0</span>,
          max <span class="op">=</span> <span class="fl">1000</span>, 
          value <span class="op">=</span> <span class="fl">500</span>
        <span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span><span class="st">"distPlot"</span><span class="op">)</span>
      <span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_tab_item.html">tabler_tab_item</a></span><span class="op">(</span>
        tabName <span class="op">=</span> <span class="st">"tab2"</span>,
        <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"Second Tab"</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>,
    footer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/tabler_footer.html">tabler_footer</a></span><span class="op">(</span>
      left <span class="op">=</span> <span class="st">"Rstats, 2020"</span>, 
      right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span><span class="op">(</span>href <span class="op">=</span> <span class="st">"https://www.google.com"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">output</span><span class="op">$</span><span class="va">distPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">current_tab</span>, <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showNotification.html">showNotification</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Hello"</span>, <span class="va">input</span><span class="op">$</span><span class="va">current_tab</span><span class="op">)</span>, 
      type <span class="op">=</span> <span class="st">"message"</span>,
      duration <span class="op">=</span> <span class="fl">1</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="va">newTab</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">current_tab</span> <span class="op">==</span> <span class="st">"tab1"</span><span class="op">)</span> <span class="op">{</span>
      <span class="st">"tab2"</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="st">"tab1"</span>
    <span class="op">}</span>
    <span class="fu"><a href="https://rdrr.io/pkg/OSUICode/man/update_tabler_tab_item.html">update_tabler_tab_item</a></span><span class="op">(</span><span class="st">"current_tab"</span>, <span class="va">newTab</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>Here we are!</p>
</div>
<div id="exercises-2" class="section level2">
<h2>
<span class="header-section-number">19.4</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-2"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Have a look at the Tabler documentation about <a href="https://preview-dev.tabler.io/docs/buttons.html">buttons</a> and extend the <code>tabler_button</code> function accordingly.</li>
<li>Propose an implementation of the <code>Advanced selectboxes</code> shown <a href="https://preview-dev.tabler.io/docs/form-elements.html#">here</a>.</li>
<li>Cards are a central elements of all templates. So are tabset panels! Try to modify the <code><a href="https://rdrr.io/pkg/OSUICode/man/tabler_card.html">tabler_card()</a></code> function
to create a <code>tabler_tab_card()</code> function, adding tab navigation within the card header.</li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="custom-templates-skeleton.html"><span class="header-section-number">18</span> Create template elements</a></div>
<div class="next"><a href="custom-templates-interactivity.html"><span class="header-section-number">20</span> Adding more interactivity</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#custom-templates-inputs"><span class="header-section-number">19</span> Develop custom input widgets</a></li>
<li>
<a class="nav-link" href="#tabler-action-button"><span class="header-section-number">19.1</span> Tabler action button</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#reminders-about-the-action-button"><span class="header-section-number">19.1.1</span> Reminders about the action button</a></li>
<li><a class="nav-link" href="#application-to-tabler"><span class="header-section-number">19.1.2</span> Application to Tabler</a></li>
</ul>
</li>
<li><a class="nav-link" href="#toggle-switch"><span class="header-section-number">19.2</span> Toggle Switch</a></li>
<li><a class="nav-link" href="#custom-templates-inputs-navbar"><span class="header-section-number">19.3</span> Navbar menu input</a></li>
<li><a class="nav-link" href="#exercises-2"><span class="header-section-number">19.4</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/blob/master/custom-templates-inputs.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/edit/master/custom-templates-inputs.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Outstanding User Interfaces with Shiny</strong>" was written by David Granjon. It was last built on 2021-08-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
