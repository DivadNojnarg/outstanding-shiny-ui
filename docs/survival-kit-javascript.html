<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 JavaScript for Shiny | Outstanding User Interfaces with Shiny</title>
<meta name="author" content="David Granjon">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/core-js-2.5.3/shim.min.js"></script><script src="libs/react-16.12.0/react.min.js"></script><script src="libs/react-16.12.0/react-dom.min.js"></script><script src="libs/reactwidget-1.0.0/react-tools.js"></script><link href="libs/font-awesome-5.13.0/css/all.min.css" rel="stylesheet">
<link href="libs/font-awesome-5.13.0/css/v4-shims.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Outstanding User Interfaces with Shiny</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="web-intro.html"><span class="header-section-number">1</span> Shiny and the Web</a></li>
<li><a class="" href="htmltools-overview.html"><span class="header-section-number">2</span> htmltools overview</a></li>
<li><a class="" href="web-dependencies.html"><span class="header-section-number">3</span> Discover Shiny dependencies</a></li>
<li><a class="" href="htmltools-dependencies.html"><span class="header-section-number">4</span> Dependency utilities</a></li>
<li><a class="" href="web-applications.html"><span class="header-section-number">5</span> Web application concepts</a></li>
<li class="book-part">Beautify with CSS and Sass</li>
<li><a class="" href="beautify-css.html"><span class="header-section-number">6</span> CSS for Shiny</a></li>
<li><a class="" href="beautify-sass.html"><span class="header-section-number">7</span> Introduction to SASS</a></li>
<li><a class="" href="beautify-with-fresh.html"><span class="header-section-number">8</span> Beautify with {fresh}</a></li>
<li><a class="" href="beautify-with-bootstraplib.html"><span class="header-section-number">9</span> Beautify with {bslib}</a></li>
<li class="book-part">Unleash interactivity with JavaScript</li>
<li><a class="active" href="survival-kit-javascript.html"><span class="header-section-number">10</span> JavaScript for Shiny</a></li>
<li><a class="" href="shiny-intro.html"><span class="header-section-number">11</span> R and JS</a></li>
<li><a class="" href="shiny-input-system.html"><span class="header-section-number">12</span> Shiny’s input system</a></li>
<li><a class="" href="shiny-input-lifecycle.html"><span class="header-section-number">13</span> Shiny inputs lifecycles</a></li>
<li><a class="" href="shiny-input-gems.html"><span class="header-section-number">14</span> Mastering Shiny’s events</a></li>
<li><a class="" href="shiny-custom-handler.html"><span class="header-section-number">15</span> Dynamically manage content with handlers</a></li>
<li class="book-part">Practice 1: a dashboard template</li>
<li><a class="" href="custom-templates-selection.html"><span class="header-section-number">16</span> Template selection</a></li>
<li><a class="" href="custom-templates-dependencies.html"><span class="header-section-number">17</span> Define dependencies</a></li>
<li><a class="" href="custom-templates-skeleton.html"><span class="header-section-number">18</span> Template skeleton</a></li>
<li><a class="" href="custom-templates-testing.html"><span class="header-section-number">19</span> Testing and validating templates elements</a></li>
<li><a class="" href="custom-templates-inputs.html"><span class="header-section-number">20</span> Develop custom input widgets</a></li>
<li><a class="" href="custom-templates-interactivity.html"><span class="header-section-number">21</span> Adding more interactivity</a></li>
<li class="book-part">Toward a better workflow</li>
<li><a class="" href="workflow-charpente.html"><span class="header-section-number">22</span> Introduction to {charpente}</a></li>
<li class="book-part">Case study 2: Mobile development with Shiny</li>
<li><a class="" href="mobile-shiny-intro.html"><span class="header-section-number">23</span> Introduction</a></li>
<li><a class="" href="mobile-shinyMobile.html"><span class="header-section-number">24</span> Reconstruct {shinyMobile}</a></li>
<li><a class="" href="mobile-pwa.html"><span class="header-section-number">25</span> {shinyMobile} and PWA</a></li>
<li><a class="" href="mobile-widgets.html"><span class="header-section-number">26</span> Design widgets</a></li>
<li><a class="" href="mobile-going-further.html"><span class="header-section-number">27</span> Going further</a></li>
<li class="book-part">Going further</li>
<li><a class="" href="going-further-reactR.html"><span class="header-section-number">28</span> R + Shiny + React: welcome {reactR}</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/DivadNojnarg/outstanding-shiny-ui">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="survival-kit-javascript" class="section level1">
<h1>
<span class="header-section-number">10</span> JavaScript for Shiny<a class="anchor" aria-label="anchor" href="#survival-kit-javascript"><i class="fas fa-link"></i></a>
</h1>
<p>To understand how Shiny works from inside, especially how inputs are handled, we’ll gradually dive into its core which contains a substantial amount of <strong>JavaScript</strong> (JS).</p>
<div class="warningbox">
<p>This chapter is a very brief introduction to JS and <strong>jQuery</strong> but still necessary as this book is supposed to be standalone. Advanced JS users may skip this part. If you wish to know more about this language, MDN web docs by Mozilla is an excellent <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">resource</a>.</p>
</div>
<div id="shiny-javascript-sources" class="section level2">
<h2>
<span class="header-section-number">10.1</span> Shiny JavaScript sources<a class="anchor" aria-label="anchor" href="#shiny-javascript-sources"><i class="fas fa-link"></i></a>
</h2>
<div class="importantblock">
<p>Since commit <a href="https://github.com/rstudio/shiny/commit/1b8635db327a753007b1d7d052b138353745d251"><code>1b8635d</code></a>,
the whole JS core has been converted to TypeScript. As this book was written before these changes, we’ll point the user to the code prior to <code>1b8635d</code>, that is this <a href="https://github.com/rstudio/shiny/tree/60db1e02b03d8e6fb146c9bb1bbfbce269231add">state</a>. Practically, the underlying mechanisms remain <strong>exactly</strong> the same.</p>
</div>
<p>Let’s have a look at the <a href="https://shiny.rstudio.com/">shiny</a> <span class="citation">(Chang et al. <a href="references.html#ref-R-shiny" role="doc-biblioref">2021</a>)</span> github <a href="https://github.com/rstudio/shiny/tree/60db1e02b03d8e6fb146c9bb1bbfbce269231add">project</a>. As a R package, it is composed of standard folders like <code>R</code>, <code>man</code>, <code>tests</code> and other elements. The <code>inst</code> folder contains resources for external dependencies like <a href="https://getbootstrap.com/docs/3.3/">Bootstrap 3</a>, <a href="https://jquery.com/">jQuery</a>, <a href="https://datatables.net/">datatables</a>, <a href="https://fontawesome.com/">fontawesome</a>, … mentioned in Chapter <a href="web-dependencies.html#web-dependencies">3</a> sorted in the <code>www/shared</code> sub-folder as well as the whole CSS and JS Shiny codes. Notice the presence of minified files like <code>shiny.min.js</code> and non minified elements such as <code>shiny.css</code>. Overall, the minification process reduces the loading time of a web page by removing comments, extra spaces, thereby decreasing the file size. For instance <code>shiny.js</code> has more than 6500 lines of code (240kb), while <code>shiny.min.js</code> is only 91.4kb.</p>
<p>Notice the <code>srcjs/</code> folder shown in Figure <a href="survival-kit-javascript.html#fig:shiny-js-sources">10.1</a>. It actually contains all pieces to reconstruct the whole <code>shiny.js</code> file.</p>
<div class="figure">
<span id="fig:shiny-js-sources"></span>
<img src="images/survival-kit/shiny-js-sources.png" alt="Shiny JavaScript sources" width="100%"><p class="caption">
FIGURE 10.1: Shiny JavaScript sources
</p>
</div>
<p>Since in Chapter <a href="shiny-input-system.html#shiny-input-system">12</a> we’ll use some of those scripts, a little understanding of the basic underlying JavaScript concepts is necessary.</p>
</div>
<div id="introduction-to-javascript" class="section level2">
<h2>
<span class="header-section-number">10.2</span> Introduction to JavaScript<a class="anchor" aria-label="anchor" href="#introduction-to-javascript"><i class="fas fa-link"></i></a>
</h2>
<p>JavaScript was created in 1995 by Brendan Eich and is also known as ECMAScript (ES). Interestingly, you might have heard about ActionScript, which is no more than an implementation of ES by Adobe Systems. Nowadays, JavaScript is the centerpiece of web development across all websites.</p>
<p>Here is a quick example. If you have a personal blog, you probably know <a href="https://gohugo.io/">Hugo</a> or <a href="https://jekyllrb.com/">Jekyll</a>, especially the R interfaces like <a href="https://bookdown.org/yihui/blogdown/">blogdown</a> <span class="citation">(Xie, Dervieux, and Presmanes Hill <a href="references.html#ref-R-blogdown" role="doc-biblioref">2021</a>)</span>. These tools allow one to rapidly develop a nice looking blog in just a few minutes, focusing on the content rather than technical aspects, which is really the point! Now, if you open the HTML inspector introduced in Chapter <a href="web-intro.html#web-intro-html">1.2</a>, click on the elements tab, which may open by default, and uncollapse the <code>&lt;head&gt;</code> tag, you see that a lot of scripts are included, as shown in Figure <a href="survival-kit-javascript.html#fig:scripts-list">10.2</a>. Similarly for the <code>&lt;body&gt;</code> tag.</p>
<div class="figure">
<span id="fig:scripts-list"></span>
<img src="images/survival-kit/scripts-list.png" alt="A website is full of JavaScript" width="100%"><p class="caption">
FIGURE 10.2: A website is full of JavaScript
</p>
</div>
<p>There are three ways to include scripts in an HTML document:</p>
<ul>
<li>Use the <code>&lt;script&gt;</code> tag with the JS code inside.</li>
<li>Add the <code>onclick</code> attribute to an HTML tag (preferably a button) to trigger JS as soon as it is clicked.</li>
<li>Import an external file containing the JS code and only.</li>
</ul>
<div class="sourceCode" id="cb242"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb242-1"><a href="survival-kit-javascript.html#cb242-1"></a><span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">"text/javascript"</span><span class="kw">&gt;</span></span>
<span id="cb242-2"><a href="survival-kit-javascript.html#cb242-2"></a><span class="co">// JS code here</span></span>
<span id="cb242-3"><a href="survival-kit-javascript.html#cb242-3"></a><span class="kw">&lt;/script&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb243"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb243-1"><a href="survival-kit-javascript.html#cb243-1"></a><span class="kw">&lt;button</span><span class="ot"> id=</span><span class="st">"hello"</span><span class="ot"> onclick=</span><span class="st">"jsFunction()"</span><span class="kw">&gt;</span>Hello World<span class="kw">&lt;/button&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb244"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb244-1"><a href="survival-kit-javascript.html#cb244-1"></a><span class="co">&lt;!-- We use the src attribute to link the external file --&gt;</span></span>
<span id="cb244-2"><a href="survival-kit-javascript.html#cb244-2"></a><span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">"text/javascript"</span><span class="ot"> src=</span><span class="st">"file.js"</span><span class="kw">&gt;</span></span></code></pre></div>
<p>Whether to choose the first, second or third method depends on the content of your script. If we consider the JS library jQuery, it unfortunately contains so much code making it a challenge to understand. This make user chose the third method, most of the time.</p>
</div>
<div id="setup" class="section level2">
<h2>
<span class="header-section-number">10.3</span> Setup<a class="anchor" aria-label="anchor" href="#setup"><i class="fas fa-link"></i></a>
</h2>
<p>Like <a href="https://www.r-project.org/">R</a> or <a href="https://www.python.org/">Python</a>, JavaScript (JS) is an <strong>interpreted</strong> language. It is executed <strong>client-side</strong>, in other words in the browser. This also means that JS code may not be run without a suitable tool. In the following, we’ll list some tools to test JS code, even though JS may also be run through the web browser developer tools, as demonstrated in section <a href="survival-kit-javascript.html#shiny-js-inspector">10.6</a>.</p>
<div id="install-node" class="section level3">
<h3>
<span class="header-section-number">10.3.1</span> Node<a class="anchor" aria-label="anchor" href="#install-node"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://nodejs.org/en/">Node</a> contains an interpreter for JS as well as a dependencies manager, npm (Node Package Manager). To install <strong>Node</strong> on your computer, browse to the website and follow the installation instructions. Afterwards, open a terminal and check if:</p>
<pre><code>$ which node
$ node --version</code></pre>
<p>returns something. If not, Node may not be properly <a href="https://www.taniarascia.com/how-to-install-and-use-node-js-and-npm-mac-and-windows/">installed</a>.</p>
<div class="noteblock">
<p>If you prefer not installing Node, there exists alternatives like <a href="https://repl.it/languages/nodejs">repl.it</a>, offering a Node.js online compiler environment. This will be more than enough to follow this part.</p>
</div>
</div>
<div id="choose-a-good-ide" class="section level3">
<h3>
<span class="header-section-number">10.3.2</span> Choose a good IDE<a class="anchor" aria-label="anchor" href="#choose-a-good-ide"><i class="fas fa-link"></i></a>
</h3>
<p>Personally, I really like <a href="https://code.visualstudio.com">VSCode</a> for coding with JS, as it contains a Node interpreter allowing you to seamlessly execute any JS code. As a side note, I encourage you to try the <a href="https://draculatheme.com/visual-studio-code/">dracula</a> color theme, which is my favorite! As R user, I also like <a href="https://rstudio.com/products/rstudio/">Rstudio IDE</a>, provided that you have Node installed. Below, we will explain how to run a JS code in both IDE’s. In section <a href="survival-kit-javascript.html#shiny-js-inspector">10.6</a>, we will show how to manipulate JS code directly in the web browser, through the HTML inspector. This is the method we will mostly use in the remaining of the book since we will also work with HTML and CSS at the same time.</p>
</div>
<div id="first-script" class="section level3">
<h3>
<span class="header-section-number">10.3.3</span> First Script<a class="anchor" aria-label="anchor" href="#first-script"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s write our first script:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb246-1"><a href="survival-kit-javascript.html#cb246-1"></a><span class="va">console</span>.<span class="at">log</span>(<span class="st">"Hello World"</span>)<span class="op">;</span></span></code></pre></div>
<p>You notice that all instruction end by <code>;</code>. You can run this script either in Rstudio IDE or VSCode.</p>
<div class="figure">
<span id="fig:script-vscode"></span>
<img src="images/survival-kit/script-vscode.png" alt="Run JS in VSCode" width="100%"><p class="caption">
FIGURE 10.3: Run JS in VSCode
</p>
</div>
<p>In VSCode, clicking on the run arrow (top center) of Figure <a href="survival-kit-javascript.html#fig:script-vscode">10.3</a>, triggers the <code>node hello.js</code> command, which tells Node to run the script. We see the result in the right panel (code=0 means the execution is fine and we even have the compute time). To run this script in the RStudio IDE, one needs to click on the terminal tab (you could also open a basic terminal) and type <code>node hello.js</code> (or <code>node mycustompath/hello.js</code> if you are not already in the script folder). You should see the <code>Hello World</code> message in the console (see Figure <a href="survival-kit-javascript.html#fig:script-rstudio">10.4</a>).</p>
<div class="figure">
<span id="fig:script-rstudio"></span>
<img src="images/survival-kit/script-rstudio.png" alt="Run JS in a terminal" width="100%"><p class="caption">
FIGURE 10.4: Run JS in a terminal
</p>
</div>
</div>
</div>
<div id="programming-with-js-basis" class="section level2">
<h2>
<span class="header-section-number">10.4</span> Programming with JS: basis<a class="anchor" aria-label="anchor" href="#programming-with-js-basis"><i class="fas fa-link"></i></a>
</h2>
<p>We are now all set to introduce the basis of JS. As many languages, JS is made of <strong>variables</strong> and <strong>instructions</strong>. All instructions end by the <code>;</code> symbol.</p>
<div id="js-types" class="section level3">
<h3>
<span class="header-section-number">10.4.1</span> JS types<a class="anchor" aria-label="anchor" href="#js-types"><i class="fas fa-link"></i></a>
</h3>
<p>JS defines several <strong>types</strong>:</p>
<ul>
<li>
<strong>Number</strong>. JS does not distinguish between integers and others. In R for instance, numeric contains integers and double.</li>
<li>
<strong>String</strong>: characters (‘blabla’).</li>
<li>
<strong>Boolean</strong>: true/false.</li>
</ul>
<p>To check the type of an element, we may use the <code>typeof</code> operator:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb247-1"><a href="survival-kit-javascript.html#cb247-1"></a><span class="kw">typeof</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// number</span></span>
<span id="cb247-2"><a href="survival-kit-javascript.html#cb247-2"></a><span class="kw">typeof</span> <span class="st">'pouic'</span><span class="op">;</span> <span class="co">// string</span></span></code></pre></div>
<div class="importantblock">
<p>In JS, <code>typeof</code> is not a function like in R!!! Therefore don’t write <code><a href="https://rdrr.io/r/base/typeof.html">typeof('string');</a></code>.</p>
</div>
</div>
<div id="variables-1" class="section level3">
<h3>
<span class="header-section-number">10.4.2</span> Variables<a class="anchor" aria-label="anchor" href="#variables-1"><i class="fas fa-link"></i></a>
</h3>
<p>Variables are key elements to programming languages. They allow to store intermediate results and do other manipulations. In JS, a variable is defined by:</p>
<ul>
<li>A type.</li>
<li>A name.</li>
<li>A value.</li>
</ul>
<div class="importantblock">
<p>A valid variable name:</p>
<ul>
<li>Doesn’t use a reserved JS name like <code>typeof</code>!</li>
<li>Doesn’t start with a number (123soleil)!</li>
<li>Doesn’t include any space (total price)!</li>
</ul>
</div>
<p>Besides, code style is a critical element in programming, increasing readability and general consistence. There are several styles, the main ones being <strong>snake_case</strong> and <strong>camelCase</strong>. As shown below, there are two ways to create variables in JavaScript.</p>
<div id="const" class="section level4">
<h4>
<span class="header-section-number">10.4.2.1</span> Const<a class="anchor" aria-label="anchor" href="#const"><i class="fas fa-link"></i></a>
</h4>
<p>We may use <strong>const</strong>:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb248-1"><a href="survival-kit-javascript.html#cb248-1"></a><span class="kw">const</span> n <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb248-2"><a href="survival-kit-javascript.html#cb248-2"></a>n <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// error</span></span>
<span id="cb248-3"><a href="survival-kit-javascript.html#cb248-3"></a><span class="kw">const</span> n <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> <span class="co">// error</span></span>
<span id="cb248-4"><a href="survival-kit-javascript.html#cb248-4"></a><span class="kw">const</span> a<span class="op">;</span></span>
<span id="cb248-5"><a href="survival-kit-javascript.html#cb248-5"></a>a <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// errors</span></span></code></pre></div>
<p>As shown above, such variables:</p>
<ul>
<li>Cannot be modified.</li>
<li>Cannot share the same name.</li>
<li>Must be assigned a value.</li>
</ul>
</div>
<div id="let" class="section level4">
<h4>
<span class="header-section-number">10.4.2.2</span> let<a class="anchor" aria-label="anchor" href="#let"><i class="fas fa-link"></i></a>
</h4>
<p>Another way to define a variable:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb249-1"><a href="survival-kit-javascript.html#cb249-1"></a><span class="kw">let</span> myVariable <span class="op">=</span> <span class="st">'welcome'</span><span class="op">;</span></span>
<span id="cb249-2"><a href="survival-kit-javascript.html#cb249-2"></a>myVariable <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb249-3"><a href="survival-kit-javascript.html#cb249-3"></a><span class="va">console</span>.<span class="at">log</span>(myVariable)<span class="op">;</span></span></code></pre></div>
<p>All mathematical operators apply, for example:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb250-1"><a href="survival-kit-javascript.html#cb250-1"></a><span class="kw">let</span> myNumber <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// affectation</span></span>
<span id="cb250-2"><a href="survival-kit-javascript.html#cb250-2"></a>myNumber<span class="op">--;</span> <span class="co">// decrement</span></span>
<span id="cb250-3"><a href="survival-kit-javascript.html#cb250-3"></a><span class="va">console</span>.<span class="at">log</span>(myNumber)<span class="op">;</span> <span class="co">// print 0</span></span></code></pre></div>
<div class="noteblock">
<p>List of numerical operators in JS:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>. <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> also allows to concatenate strings together.</li>
<li><code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code></li>
<li><code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code></li>
<li><code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code></li>
<li><code>% (modulo)</code></li>
<li>
<code>++</code> (incrementation)</li>
<li>
<code>--</code> (decrementation)</li>
</ul>
</div>
<p>You may also know <code>var</code> to declare variables. What is the difference with <code>let</code>? It is mainly a <strong>scope</strong> <a href="https://www.w3schools.com/js/js_let.asp">reason</a>:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb251-1"><a href="survival-kit-javascript.html#cb251-1"></a><span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb251-2"><a href="survival-kit-javascript.html#cb251-2"></a><span class="op">{</span></span>
<span id="cb251-3"><a href="survival-kit-javascript.html#cb251-3"></a>  <span class="kw">var</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// this will modify i globally, not locally</span></span>
<span id="cb251-4"><a href="survival-kit-javascript.html#cb251-4"></a><span class="op">}</span></span>
<span id="cb251-5"><a href="survival-kit-javascript.html#cb251-5"></a><span class="va">console</span>.<span class="at">log</span>(<span class="vs">`i is </span><span class="sc">${</span>i<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span> <span class="co">// i is 2.</span></span>
<span id="cb251-6"><a href="survival-kit-javascript.html#cb251-6"></a></span>
<span id="cb251-7"><a href="survival-kit-javascript.html#cb251-7"></a><span class="kw">let</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb251-8"><a href="survival-kit-javascript.html#cb251-8"></a><span class="op">{</span></span>
<span id="cb251-9"><a href="survival-kit-javascript.html#cb251-9"></a>  <span class="kw">let</span> j <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// j is only declared locally and not globally!</span></span>
<span id="cb251-10"><a href="survival-kit-javascript.html#cb251-10"></a><span class="op">}</span></span>
<span id="cb251-11"><a href="survival-kit-javascript.html#cb251-11"></a><span class="va">console</span>.<span class="at">log</span>(<span class="vs">`j is </span><span class="sc">${</span>j<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span> <span class="co">// j is 1</span></span></code></pre></div>
<p>You will see later that we still use <code>var</code> in the shiny core.</p>
</div>
</div>
<div id="conditions" class="section level3">
<h3>
<span class="header-section-number">10.4.3</span> Conditions<a class="anchor" aria-label="anchor" href="#conditions"><i class="fas fa-link"></i></a>
</h3>
<p>Below are the operators to check conditions:</p>
<div class="noteblock">
<ul>
<li>
<code>===</code> (A equal value, equal type B)</li>
<li>
<code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code> (A equal to B)</li>
<li>
<code>!==</code> (A not equal value or not equal type B)</li>
<li>
<code><a href="https://rdrr.io/r/base/Comparison.html">!=</a></code> (A not equal to B)</li>
<li>
<code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;=</a></code>
</li>
<li>
<code><a href="https://rdrr.io/r/base/Comparison.html">&lt;</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&lt;=</a></code>
</li>
<li>
<code>AND</code> (A AND B) or <code><a href="https://rdrr.io/r/base/Logic.html">&amp;&amp;</a></code>
</li>
<li>
<code>OR</code> (A OR B) or <code><a href="https://rdrr.io/r/base/Logic.html">||</a></code>
</li>
</ul>
</div>
<div class="importantblock">
<p>Importantly, prefer <code>===</code> and <code>!==</code> to compare elements since <code>5 == "5"</code> would return <code>true</code>, generally not what you want!</p>
</div>
<p>To test conditions there exists several ways:</p>
<ul>
<li><code>if (condition) { console.log('Test passed'); }</code></li>
<li><code>if (condition) { instruction A } else { instruction B }</code></li>
</ul>
<p>The <strong>ternary</strong> operator is a shortcut <code>condition ? instruction if true : instruction if false</code> that may be chained. For complex instructions, we recommend not using it, as it may affect code readability.</p>
<p>Whenever a lot of possible conditions have to be evaluated, it is better to choose the <code>switch</code>:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb252-1"><a href="survival-kit-javascript.html#cb252-1"></a><span class="cf">switch</span> (variable) <span class="op">{</span></span>
<span id="cb252-2"><a href="survival-kit-javascript.html#cb252-2"></a>  <span class="cf">case</span> <span class="dt">val1</span><span class="op">:</span> <span class="co">// instruction 1</span></span>
<span id="cb252-3"><a href="survival-kit-javascript.html#cb252-3"></a>  <span class="cf">break</span><span class="op">;</span> <span class="co">// don't forget the break!</span></span>
<span id="cb252-4"><a href="survival-kit-javascript.html#cb252-4"></a>  <span class="cf">case</span> <span class="dt">val2</span><span class="op">:</span>  <span class="co">// instruction 2</span></span>
<span id="cb252-5"><a href="survival-kit-javascript.html#cb252-5"></a>  <span class="cf">break</span><span class="op">;</span></span>
<span id="cb252-6"><a href="survival-kit-javascript.html#cb252-6"></a>  <span class="cf">default</span><span class="op">:</span> <span class="co">// when none of val1 and val2 are satisfied</span></span>
<span id="cb252-7"><a href="survival-kit-javascript.html#cb252-7"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="objects" class="section level3">
<h3>
<span class="header-section-number">10.4.4</span> Objects<a class="anchor" aria-label="anchor" href="#objects"><i class="fas fa-link"></i></a>
</h3>
<p>JavaScript is an <strong>object</strong> oriented programming language (like Python). An object is defined by:</p>
<ul>
<li>A <strong>type</strong>.</li>
<li>Some <strong>properties</strong>.</li>
<li>Some <strong>methods</strong> (to manipulate properties).</li>
</ul>
<p>Let’s construct our first object:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb253-1"><a href="survival-kit-javascript.html#cb253-1"></a><span class="kw">const</span> me <span class="op">=</span> <span class="op">{</span></span>
<span id="cb253-2"><a href="survival-kit-javascript.html#cb253-2"></a>  <span class="dt">name </span><span class="op">:</span> <span class="st">'Divad'</span><span class="op">,</span></span>
<span id="cb253-3"><a href="survival-kit-javascript.html#cb253-3"></a>  <span class="dt">age </span><span class="op">:</span> <span class="dv">29</span><span class="op">,</span></span>
<span id="cb253-4"><a href="survival-kit-javascript.html#cb253-4"></a>  <span class="dt">music </span><span class="op">:</span> <span class="st">''</span><span class="op">,</span></span>
<span id="cb253-5"><a href="survival-kit-javascript.html#cb253-5"></a>  <span class="dt">printName</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb253-6"><a href="survival-kit-javascript.html#cb253-6"></a>    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`I am </span><span class="sc">${</span><span class="kw">this</span>.<span class="at">name</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb253-7"><a href="survival-kit-javascript.html#cb253-7"></a>  <span class="op">}</span></span>
<span id="cb253-8"><a href="survival-kit-javascript.html#cb253-8"></a><span class="op">}</span></span>
<span id="cb253-9"><a href="survival-kit-javascript.html#cb253-9"></a></span>
<span id="cb253-10"><a href="survival-kit-javascript.html#cb253-10"></a><span class="va">me</span>.<span class="at">geek</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="co">// works (see const variables above)</span></span>
<span id="cb253-11"><a href="survival-kit-javascript.html#cb253-11"></a><span class="va">console</span>.<span class="at">log</span>(<span class="va">JSON</span>.<span class="at">stringify</span>(me))<span class="op">;</span> <span class="co">// print a human readable object.</span></span>
<span id="cb253-12"><a href="survival-kit-javascript.html#cb253-12"></a>  </span>
<span id="cb253-13"><a href="survival-kit-javascript.html#cb253-13"></a><span class="va">console</span>.<span class="at">log</span>(<span class="va">me</span>.<span class="at">name</span>)<span class="op">;</span></span>
<span id="cb253-14"><a href="survival-kit-javascript.html#cb253-14"></a><span class="va">console</span>.<span class="at">log</span>(<span class="va">me</span>.<span class="at">age</span>)<span class="op">;</span></span>
<span id="cb253-15"><a href="survival-kit-javascript.html#cb253-15"></a><span class="va">console</span>.<span class="at">log</span>(<span class="va">me</span>.<span class="at">music</span>)<span class="op">;</span></span>
<span id="cb253-16"><a href="survival-kit-javascript.html#cb253-16"></a><span class="co">// don't repeat yourself!!!</span></span>
<span id="cb253-17"><a href="survival-kit-javascript.html#cb253-17"></a><span class="cf">for</span> (<span class="kw">let</span> key <span class="kw">in</span> me) <span class="op">{</span> <span class="co">// here is it ok to use `in`</span></span>
<span id="cb253-18"><a href="survival-kit-javascript.html#cb253-18"></a> <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`me[</span><span class="sc">${</span>key<span class="sc">}</span><span class="vs">] is </span><span class="sc">${</span>me[key]<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb253-19"><a href="survival-kit-javascript.html#cb253-19"></a><span class="op">}</span></span>
<span id="cb253-20"><a href="survival-kit-javascript.html#cb253-20"></a></span>
<span id="cb253-21"><a href="survival-kit-javascript.html#cb253-21"></a><span class="va">me</span>.<span class="at">printName</span>()<span class="op">;</span></span>
<span id="cb253-22"><a href="survival-kit-javascript.html#cb253-22"></a></span>
<span id="cb253-23"><a href="survival-kit-javascript.html#cb253-23"></a>me <span class="op">=</span> <span class="op">{</span></span>
<span id="cb253-24"><a href="survival-kit-javascript.html#cb253-24"></a>  <span class="dt">name</span><span class="op">:</span> <span class="st">'Paul'</span><span class="op">,</span></span>
<span id="cb253-25"><a href="survival-kit-javascript.html#cb253-25"></a>  <span class="dt">age</span><span class="op">:</span> <span class="dv">40</span></span>
<span id="cb253-26"><a href="survival-kit-javascript.html#cb253-26"></a><span class="op">}</span> <span class="co">// error (see const variables above)</span></span></code></pre></div>
<p>Some comments on the above code:</p>
<ul>
<li>To access an object property, we use <code>object.&lt;property&gt;</code>.</li>
<li>To print a human readable version of the object, <code>JSON.stringify</code> will do the job.</li>
<li>We introduced string <strong>interpolation</strong> with <code>${*}</code>. <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> may be any valid expression.</li>
<li>Methods are called with <code>object.&lt;method&gt;</code>. We use <code>this</code> to refer to the object itself. Take note, we will see it a lot!</li>
</ul>
<p>In JavaScript, there are already predefined objects to interact with arrays, dates, …</p>
<div id="arrays" class="section level4">
<h4>
<span class="header-section-number">10.4.4.1</span> Arrays<a class="anchor" aria-label="anchor" href="#arrays"><i class="fas fa-link"></i></a>
</h4>
<p>An <strong>array</strong> is a structure allowing to store information for instance:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb254-1"><a href="survival-kit-javascript.html#cb254-1"></a><span class="kw">const</span> table <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="st">'plop'</span>]<span class="op">;</span></span>
<span id="cb254-2"><a href="survival-kit-javascript.html#cb254-2"></a>table <span class="op">=</span> [<span class="dv">2</span>]<span class="op">;</span> <span class="co">// error</span></span>
<span id="cb254-3"><a href="survival-kit-javascript.html#cb254-3"></a><span class="va">console</span>.<span class="at">log</span>(table)<span class="op">;</span></span></code></pre></div>
<p>Array may be <strong>nested</strong>:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb255-1"><a href="survival-kit-javascript.html#cb255-1"></a><span class="kw">const</span> nested <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> [<span class="st">'a'</span><span class="op">,</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span>]]<span class="op">,</span> <span class="st">'plop'</span>]<span class="op">;</span></span>
<span id="cb255-2"><a href="survival-kit-javascript.html#cb255-2"></a><span class="va">console</span>.<span class="at">log</span>(nested)<span class="op">;</span></span></code></pre></div>
<p>In arrays, elements may be accessed by their <strong>index</strong>, but as mentioned before, the first index is 0 (not 1 like in R).
For instance, if we want to get the first element of the <code>nested</code> array, we do:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb256-1"><a href="survival-kit-javascript.html#cb256-1"></a><span class="va">console</span>.<span class="at">log</span>(nested[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb256-2"><a href="survival-kit-javascript.html#cb256-2"></a><span class="co">// To get deeply nested element </span></span>
<span id="cb256-3"><a href="survival-kit-javascript.html#cb256-3"></a><span class="co">// we may chain index</span></span>
<span id="cb256-4"><a href="survival-kit-javascript.html#cb256-4"></a>nested[<span class="dv">1</span>][<span class="dv">1</span>] <span class="co">// Access [1, 2, 3]</span></span></code></pre></div>
<p>Note that the <code>length</code> method returns the size of an array and is very convenient in for loops, as we’ll see later:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb257-1"><a href="survival-kit-javascript.html#cb257-1"></a><span class="va">nested</span>.<span class="at">length</span> <span class="co">// 3</span></span>
<span id="cb257-2"><a href="survival-kit-javascript.html#cb257-2"></a>nested[<span class="dv">1</span>].<span class="at">length</span> <span class="co">// 2</span></span>
<span id="cb257-3"><a href="survival-kit-javascript.html#cb257-3"></a>nested[<span class="dv">1</span>][<span class="dv">1</span>].<span class="at">length</span> <span class="co">// 3</span></span></code></pre></div>
<p>Below is a table referencing the principal methods for arrays.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Method/Property</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">length</td>
<td align="center">Return the number of elements in an array</td>
</tr>
<tr class="even">
<td align="center">Join(string separator)</td>
<td align="center">Transform an array in a string</td>
</tr>
<tr class="odd">
<td align="center">concat(array1, array2)</td>
<td align="center">Assemble 2 arrays</td>
</tr>
<tr class="even">
<td align="center">pop()</td>
<td align="center">Remove the last element of an array</td>
</tr>
<tr class="odd">
<td align="center">shift()</td>
<td align="center">Remove the first element of an array</td>
</tr>
<tr class="even">
<td align="center">unshift(el1, el2, …)</td>
<td align="center">Insert elements at the beginning of an array</td>
</tr>
<tr class="odd">
<td align="center">push(el1, el2, …)</td>
<td align="center">Add extra elements at the end of an array</td>
</tr>
<tr class="even">
<td align="center">sort()</td>
<td align="center">Sort array elements by increasing value of alphabetical order</td>
</tr>
<tr class="odd">
<td align="center">reverse()</td>
<td align="center">Symetric of sort()</td>
</tr>
</tbody>
</table></div>
<p>Among those methods, we mainly use <code>push</code> and <code>length</code> in the next chapters:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb258-1"><a href="survival-kit-javascript.html#cb258-1"></a><span class="va">table</span>.<span class="at">push</span>(<span class="st">'hello'</span>)<span class="op">;</span> <span class="co">// [1, "plop", "hello"]</span></span></code></pre></div>
</div>
<div id="strings" class="section level4">
<h4>
<span class="header-section-number">10.4.4.2</span> Strings<a class="anchor" aria-label="anchor" href="#strings"><i class="fas fa-link"></i></a>
</h4>
<p>Below are the main methods related to the String object (character in R).</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Method/Property/Operator</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">+ (operator)</td>
<td align="center">String concatenation</td>
</tr>
<tr class="even">
<td align="center">length</td>
<td align="center">String length</td>
</tr>
<tr class="odd">
<td align="center">indexOf()</td>
<td align="center">Gives the position of the character following the input string</td>
</tr>
<tr class="even">
<td align="center">toLowerCase()</td>
<td align="center">Put the string in small letters</td>
</tr>
<tr class="odd">
<td align="center">toUpperCase()</td>
<td align="center">Put the string in capital letters</td>
</tr>
</tbody>
</table></div>
</div>
<div id="math" class="section level4">
<h4>
<span class="header-section-number">10.4.4.3</span> Math<a class="anchor" aria-label="anchor" href="#math"><i class="fas fa-link"></i></a>
</h4>
<p>Below we mention some useful methods to handle mathematical objects.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">parseInt()</td>
<td align="center">Convert a string to integer</td>
</tr>
<tr class="even">
<td align="center">parseFloat()</td>
<td align="center">Conversion to floating number</td>
</tr>
</tbody>
</table></div>
<p>All classic functions like <code>sqrt</code>, trigonometric functions are of course available. We call them with the <code>Math.*</code> prefix.</p>
</div>
</div>
<div id="iterations" class="section level3">
<h3>
<span class="header-section-number">10.4.5</span> Iterations<a class="anchor" aria-label="anchor" href="#iterations"><i class="fas fa-link"></i></a>
</h3>
<p>Iterations allow to repeat an instruction or a set of instructions multiple times. Let’s assume we have an array containing 100000 random numbers. How would you do to automatically print them? This a what we are going to see below!</p>
<div id="for-loops" class="section level4">
<h4>
<span class="header-section-number">10.4.5.1</span> For loops<a class="anchor" aria-label="anchor" href="#for-loops"><i class="fas fa-link"></i></a>
</h4>
<p>The for <strong>loop</strong> has multiple uses. A convenient way to print all array’s elements is to use an iteration:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb259-1"><a href="survival-kit-javascript.html#cb259-1"></a><span class="co">// ES6 syntax</span></span>
<span id="cb259-2"><a href="survival-kit-javascript.html#cb259-2"></a><span class="kw">const</span> nested <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> [<span class="st">'a'</span><span class="op">,</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span>]]<span class="op">,</span> <span class="st">'plop'</span>]<span class="op">;</span></span>
<span id="cb259-3"><a href="survival-kit-javascript.html#cb259-3"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="kw">of</span> nested) <span class="op">{</span></span>
<span id="cb259-4"><a href="survival-kit-javascript.html#cb259-4"></a>  <span class="va">console</span>.<span class="at">log</span>(i)<span class="op">;</span></span>
<span id="cb259-5"><a href="survival-kit-javascript.html#cb259-5"></a><span class="op">}</span></span>
<span id="cb259-6"><a href="survival-kit-javascript.html#cb259-6"></a></span>
<span id="cb259-7"><a href="survival-kit-javascript.html#cb259-7"></a><span class="co">// or with the classic approach</span></span>
<span id="cb259-8"><a href="survival-kit-javascript.html#cb259-8"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">nested</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></span>
<span id="cb259-9"><a href="survival-kit-javascript.html#cb259-9"></a>  <span class="va">console</span>.<span class="at">log</span>(nested[i])<span class="op">;</span></span>
<span id="cb259-10"><a href="survival-kit-javascript.html#cb259-10"></a><span class="op">}</span></span></code></pre></div>
<p>The modern approach (ES6) consists in the <code>for</code>, <code>let</code> and <code>of</code> keywords. We define the variable
<code>i</code> that will take all values among the <code>nested</code> array and print them. Importantly, <code>i</code> does not refer
to the element index, but the element itself! The classic approach shown below uses the <code>index</code>, being slightly more
verbose.</p>
<div class="importantblock">
<p>Contrary to R, JavaScript index starts from 0 (not from 1)! This is good to keep in mind when we will mix both R and JS.</p>
</div>
<p>JS has other methods to do iterations. Let’s have a look at the <code>forEach</code> method for arrays (introduced in ES5):</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb260-1"><a href="survival-kit-javascript.html#cb260-1"></a><span class="kw">const</span> letters <span class="op">=</span> [<span class="st">"a"</span><span class="op">,</span> <span class="st">"b"</span><span class="op">,</span> <span class="st">"c"</span><span class="op">,</span> <span class="st">"d"</span>]<span class="op">;</span></span>
<span id="cb260-2"><a href="survival-kit-javascript.html#cb260-2"></a><span class="va">letters</span>.<span class="at">forEach</span>((letter) <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb260-3"><a href="survival-kit-javascript.html#cb260-3"></a>  <span class="va">console</span>.<span class="at">log</span>(letter)<span class="op">;</span></span>
<span id="cb260-4"><a href="survival-kit-javascript.html#cb260-4"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>Since arrays are objects, it is not surprising to see <code>array.forEach(element, ...)</code>.</p>
<p>What <code>for</code> loop should we use? The answer is: it depends on the situation! Actually, there even exists other ways (replace <code>of</code> by <code>in</code> and you get the indexes of the array, like with the first code, but this is really <a href="https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/">not recommended</a>).</p>
</div>
<div id="other-iterations-while" class="section level4">
<h4>
<span class="header-section-number">10.4.5.2</span> Other iterations: while<a class="anchor" aria-label="anchor" href="#other-iterations-while"><i class="fas fa-link"></i></a>
</h4>
<p>While loops are another way to iterate, the incrementation step taking place at the end of the instruction:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb261-1"><a href="survival-kit-javascript.html#cb261-1"></a><span class="kw">const</span> h <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb261-2"><a href="survival-kit-javascript.html#cb261-2"></a><span class="cf">while</span> (i <span class="op">&lt;=</span> h) <span class="op">{</span></span>
<span id="cb261-3"><a href="survival-kit-javascript.html#cb261-3"></a>  <span class="va">console</span>.<span class="at">log</span>(i)<span class="op">;</span></span>
<span id="cb261-4"><a href="survival-kit-javascript.html#cb261-4"></a>  i<span class="op">++;</span> <span class="co">// we need to increment to avoid infinite loop</span></span>
<span id="cb261-5"><a href="survival-kit-javascript.html#cb261-5"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div id="functions-1" class="section level3">
<h3>
<span class="header-section-number">10.4.6</span> Functions<a class="anchor" aria-label="anchor" href="#functions-1"><i class="fas fa-link"></i></a>
</h3>
<p>Functions are useful to wrap a succession of instructions to accomplish a given task. Defining functions allows programmers to save time (less copy and paste, less search and replace), make less errors and easily share code. In modern JavaScript (ES6), functions are defined as follows:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb262-1"><a href="survival-kit-javascript.html#cb262-1"></a><span class="kw">const</span> a <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb262-2"><a href="survival-kit-javascript.html#cb262-2"></a><span class="kw">const</span> fun <span class="op">=</span> (parm1<span class="op">,</span> parm2) <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb262-3"><a href="survival-kit-javascript.html#cb262-3"></a>  <span class="va">console</span>.<span class="at">log</span>(a)<span class="op">;</span></span>
<span id="cb262-4"><a href="survival-kit-javascript.html#cb262-4"></a>  <span class="kw">let</span> p <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb262-5"><a href="survival-kit-javascript.html#cb262-5"></a>  <span class="cf">return</span> <span class="va">Math</span>.<span class="at">max</span>(parm1<span class="op">,</span> parm2)<span class="op">;</span> <span class="co">// I use the Math object that contains the max method</span></span>
<span id="cb262-6"><a href="survival-kit-javascript.html#cb262-6"></a><span class="op">}</span></span>
<span id="cb262-7"><a href="survival-kit-javascript.html#cb262-7"></a><span class="kw">let</span> res <span class="op">=</span> <span class="at">fun</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb262-8"><a href="survival-kit-javascript.html#cb262-8"></a><span class="va">console</span>.<span class="at">log</span>(res)<span class="op">;</span> <span class="co">// prints a and 2. a global</span></span>
<span id="cb262-9"><a href="survival-kit-javascript.html#cb262-9"></a><span class="va">console</span>.<span class="at">log</span>(p)<span class="op">;</span> <span class="co">// fails because p was defined inside the function</span></span></code></pre></div>
<p>This above functions computes the maximum of 2 provided numbers. Some comments about scoping rules: variables defined inside the function, like <code>p</code>, are only available within the function scope, but not outside. It should be noted that functions may use global variables, defined outside like <code>a</code>. In the Shiny JS core, you’ll still find the classic way of defining function:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb263-1"><a href="survival-kit-javascript.html#cb263-1"></a><span class="kw">function</span> <span class="at">initShiny</span>() <span class="op">{</span></span>
<span id="cb263-2"><a href="survival-kit-javascript.html#cb263-2"></a>  <span class="co">// do things</span></span>
<span id="cb263-3"><a href="survival-kit-javascript.html#cb263-3"></a><span class="op">}</span></span></code></pre></div>
<p>The main difference being that the ES6 syntax may not be understood by all environments.</p>
<div id="about-js-modules" class="section level4">
<h4>
<span class="header-section-number">10.4.6.1</span> Export functions: about modules<a class="anchor" aria-label="anchor" href="#about-js-modules"><i class="fas fa-link"></i></a>
</h4>
<p>What happens if you wrote 100 functions that you want to reuse in different scripts? To prevent copying and pasting, we will now introduce the concept of modules. Let’s save the below function in a script <code>utils.js</code>:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb264-1"><a href="survival-kit-javascript.html#cb264-1"></a><span class="kw">const</span> findMax <span class="op">=</span> (parm1<span class="op">,</span> parm2) <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb264-2"><a href="survival-kit-javascript.html#cb264-2"></a>  <span class="cf">return</span> <span class="va">Math</span>.<span class="at">max</span>(parm1<span class="op">,</span> parm2)<span class="op">;</span> <span class="co">// I use the Math object that contains the max method</span></span>
<span id="cb264-3"><a href="survival-kit-javascript.html#cb264-3"></a><span class="op">}</span></span>
<span id="cb264-4"><a href="survival-kit-javascript.html#cb264-4"></a></span>
<span id="cb264-5"><a href="survival-kit-javascript.html#cb264-5"></a><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb264-6"><a href="survival-kit-javascript.html#cb264-6"></a>  <span class="dt">findMax </span><span class="op">:</span> findMax</span>
<span id="cb264-7"><a href="survival-kit-javascript.html#cb264-7"></a><span class="op">}</span></span></code></pre></div>
<p>We create a <code>test.js</code> script in the same folder that calls the <code>findMax</code> function. To do this, we import the corresponding module:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb265-1"><a href="survival-kit-javascript.html#cb265-1"></a><span class="kw">const</span> <span class="op">{</span> findMax <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">'./utils.js'</span>)<span class="op">;</span></span>
<span id="cb265-2"><a href="survival-kit-javascript.html#cb265-2"></a><span class="at">findMax</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span> <span class="co">// prints 2</span></span></code></pre></div>
<p>ES6 introduced another way to import and export element across multiple scripts:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb266-1"><a href="survival-kit-javascript.html#cb266-1"></a><span class="im">export</span> <span class="op">{</span> findMax<span class="op">,</span> ... <span class="op">};</span> <span class="co">// in utils.js</span></span>
<span id="cb266-2"><a href="survival-kit-javascript.html#cb266-2"></a><span class="im">import</span> <span class="op">{</span> findMax<span class="op">,</span> ...<span class="op">}</span> <span class="im">from</span> <span class="st">'./utils.js'</span><span class="op">;</span> <span class="co">// in test.js</span></span></code></pre></div>
</div>
</div>
<div id="js-code-compatibility" class="section level3">
<h3>
<span class="header-section-number">10.4.7</span> JS code compatibility<a class="anchor" aria-label="anchor" href="#js-code-compatibility"><i class="fas fa-link"></i></a>
</h3>
<p>As ES6 is not fully supported by all web browsers, you might wonder how to make your JS code standard. There exists tools called <strong>transpiler</strong>, that convert any modern JS code into a universal JS code. This is the case of <a href="https://babeljs.io/">Babel</a>, one of the most commonly used. In chapter <a href="workflow-charpente.html#workflow-charpente">22</a>, we’ll see how to do it with a JS <strong>bundler</strong>, namely<code>esbuild</code>.</p>
</div>
<div id="event-listeners" class="section level3">
<h3>
<span class="header-section-number">10.4.8</span> Event listeners<a class="anchor" aria-label="anchor" href="#event-listeners"><i class="fas fa-link"></i></a>
</h3>
<p>When you explore a web application, clicking on a button usually triggers something like a computation, a modal or an alert. How does this work? In JavaScript, interactivity plays a critical role. Indeed, you want the web application to react to user inputs like mouse clicks or keyboard events. Below we introduce DOM <strong>events</strong>.</p>
<p>Let’s consider a basic HTML button:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb267-1"><a href="survival-kit-javascript.html#cb267-1"></a><span class="kw">&lt;button</span><span class="ot"> id=</span><span class="st">"mybutton"</span><span class="kw">&gt;</span>Go!<span class="kw">&lt;/button&gt;</span></span></code></pre></div>
<p>On the JavaScript side, we first capture the button element using its id selector with <code>getElementById</code>:.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb268-1"><a href="survival-kit-javascript.html#cb268-1"></a><span class="kw">const</span> btn <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">'mybutton'</span>)<span class="op">;</span></span></code></pre></div>
<p>We then apply the <code>addEventListener</code> method. In short, an event <strong>listener</strong> is a program that triggers when a given event occurs (we can add multiple event listeners per HTML element). It takes two main parameters:</p>
<ul>
<li>The event: click, change, mouseover, …</li>
<li>The function to call, also known as <strong>callback</strong>.</li>
</ul>
<div class="sourceCode" id="cb269"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb269-1"><a href="survival-kit-javascript.html#cb269-1"></a><span class="va">btn</span>.<span class="at">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb269-2"><a href="survival-kit-javascript.html#cb269-2"></a>  <span class="at">alert</span>(<span class="st">'Thanks!'</span>)<span class="op">;</span></span>
<span id="cb269-3"><a href="survival-kit-javascript.html#cb269-3"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
</div>
</div>
<div id="jquery" class="section level2">
<h2>
<span class="header-section-number">10.5</span> jQuery<a class="anchor" aria-label="anchor" href="#jquery"><i class="fas fa-link"></i></a>
</h2>
<div id="introduction-1" class="section level3">
<h3>
<span class="header-section-number">10.5.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://jquery.com">jQuery</a> is a famous JavaScript library providing a user friendly interface to manipulate the DOM and is present in almost all actual websites. It is slightly easier (understand more convenient to use) than vanilla JS. To use jQuery in a web page, we must import its code in the <code>head</code> of our HTML page:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb270-1"><a href="survival-kit-javascript.html#cb270-1"></a><span class="dt">&lt;!doctype </span>html<span class="dt">&gt;</span></span>
<span id="cb270-2"><a href="survival-kit-javascript.html#cb270-2"></a><span class="kw">&lt;html</span><span class="ot"> lang=</span><span class="st">"en"</span><span class="kw">&gt;</span></span>
<span id="cb270-3"><a href="survival-kit-javascript.html#cb270-3"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb270-4"><a href="survival-kit-javascript.html#cb270-4"></a>    <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">"utf-8"</span><span class="kw">&gt;</span></span>
<span id="cb270-5"><a href="survival-kit-javascript.html#cb270-5"></a>    <span class="kw">&lt;title&gt;</span>Including jQuery<span class="kw">&lt;/title&gt;</span></span>
<span id="cb270-6"><a href="survival-kit-javascript.html#cb270-6"></a>    <span class="co">&lt;!-- How to include jQuery --&gt;</span></span>
<span id="cb270-7"><a href="survival-kit-javascript.html#cb270-7"></a>    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">"https://code.jquery.com/jquery-3.5.0.js"</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb270-8"><a href="survival-kit-javascript.html#cb270-8"></a>  <span class="kw">&lt;/head&gt;</span></span>
<span id="cb270-9"><a href="survival-kit-javascript.html#cb270-9"></a>  <span class="kw">&lt;body&gt;</span></span>
<span id="cb270-10"><a href="survival-kit-javascript.html#cb270-10"></a>   </span>
<span id="cb270-11"><a href="survival-kit-javascript.html#cb270-11"></a>    <span class="kw">&lt;p&gt;</span>Hello World<span class="kw">&lt;/p&gt;</span></span>
<span id="cb270-12"><a href="survival-kit-javascript.html#cb270-12"></a>  </span>
<span id="cb270-13"><a href="survival-kit-javascript.html#cb270-13"></a>  <span class="kw">&lt;script&gt;</span></span>
<span id="cb270-14"><a href="survival-kit-javascript.html#cb270-14"></a>    <span class="at">$</span>(<span class="st">'p'</span>).<span class="at">css</span>(<span class="st">'color'</span><span class="op">,</span> <span class="st">'red'</span>)<span class="op">;</span></span>
<span id="cb270-15"><a href="survival-kit-javascript.html#cb270-15"></a>  <span class="kw">&lt;/script&gt;</span></span>
<span id="cb270-16"><a href="survival-kit-javascript.html#cb270-16"></a>   </span>
<span id="cb270-17"><a href="survival-kit-javascript.html#cb270-17"></a>  <span class="kw">&lt;/body&gt;</span></span>
<span id="cb270-18"><a href="survival-kit-javascript.html#cb270-18"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<div id="syntax" class="section level3">
<h3>
<span class="header-section-number">10.5.2</span> Syntax<a class="anchor" aria-label="anchor" href="#syntax"><i class="fas fa-link"></i></a>
</h3>
<p>Below is a minimal jQuery code representing its philosophy (“write less, do more.”):</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb271-1"><a href="survival-kit-javascript.html#cb271-1"></a><span class="at">$</span>(selector).<span class="at">action</span>()<span class="op">;</span></span></code></pre></div>
<p>The <strong>selector</strong> slot stands for any jQuery selector like class, id, element, [attribute], :input (will select all input elements) and many <a href="https://www.w3schools.com/jquery/jquery_ref_selectors.asp">more</a>. As a reminder, let’s consider the following example:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb272-1"><a href="survival-kit-javascript.html#cb272-1"></a><span class="kw">&lt;p</span><span class="ot"> class=</span><span class="st">"text"</span><span class="kw">&gt;</span>Hello World<span class="kw">&lt;/p&gt;</span></span></code></pre></div>
<p>To select and interact with this element, we use JavaScript and jQuery:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb273-1"><a href="survival-kit-javascript.html#cb273-1"></a><span class="kw">let</span> inner <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementsByClassName</span>(<span class="st">'text'</span>).<span class="at">innerHTML</span><span class="op">;</span> <span class="co">// vanilla JS</span></span>
<span id="cb273-2"><a href="survival-kit-javascript.html#cb273-2"></a><span class="kw">let</span> inner <span class="op">=</span> <span class="at">$</span>(<span class="st">'.text'</span>).<span class="at">html</span>()<span class="op">;</span> <span class="co">// jQuery</span></span></code></pre></div>
<p>This is of course possible to chain selectors:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb274-1"><a href="survival-kit-javascript.html#cb274-1"></a><span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">"list"</span><span class="kw">&gt;</span></span>
<span id="cb274-2"><a href="survival-kit-javascript.html#cb274-2"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="kw">&gt;</span>1<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-3"><a href="survival-kit-javascript.html#cb274-3"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="kw">&gt;</span>2<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-4"><a href="survival-kit-javascript.html#cb274-4"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="kw">&gt;</span>3<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-5"><a href="survival-kit-javascript.html#cb274-5"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="ot"> id=</span><span class="st">"precious-item"</span><span class="kw">&gt;</span>4<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-6"><a href="survival-kit-javascript.html#cb274-6"></a><span class="kw">&lt;/ul&gt;</span></span>
<span id="cb274-7"><a href="survival-kit-javascript.html#cb274-7"></a></span>
<span id="cb274-8"><a href="survival-kit-javascript.html#cb274-8"></a><span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">"list"</span><span class="ot"> id=</span><span class="st">"list2"</span><span class="kw">&gt;</span></span>
<span id="cb274-9"><a href="survival-kit-javascript.html#cb274-9"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="kw">&gt;</span>1<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-10"><a href="survival-kit-javascript.html#cb274-10"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="kw">&gt;</span>2<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-11"><a href="survival-kit-javascript.html#cb274-11"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="kw">&gt;</span>3<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-12"><a href="survival-kit-javascript.html#cb274-12"></a>  <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">"item"</span><span class="kw">&gt;</span>4<span class="kw">&lt;/li&gt;</span></span>
<span id="cb274-13"><a href="survival-kit-javascript.html#cb274-13"></a><span class="kw">&lt;/ul&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb275"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb275-1"><a href="survival-kit-javascript.html#cb275-1"></a><span class="kw">let</span> items <span class="op">=</span> <span class="at">$</span>(<span class="st">'.list .item'</span>)<span class="op">;</span> <span class="co">// will return an array containing 8 li tags</span></span>
<span id="cb275-2"><a href="survival-kit-javascript.html#cb275-2"></a><span class="kw">let</span> otherItems <span class="op">=</span> <span class="at">$</span>(<span class="st">'#list2 .item'</span>)<span class="op">;</span> <span class="co">// will select only li tags from the second ul element</span></span>
<span id="cb275-3"><a href="survival-kit-javascript.html#cb275-3"></a><span class="kw">let</span> lists <span class="op">=</span> <span class="at">$</span>(<span class="st">'ul'</span>)<span class="op">;</span> <span class="co">// will return an array with 2 ul elements</span></span>
<span id="cb275-4"><a href="survival-kit-javascript.html#cb275-4"></a><span class="kw">let</span> firstItem <span class="op">=</span> <span class="at">$</span>(<span class="st">'#list2:first-child'</span>)<span class="op">;</span> <span class="co">// will return the first li element of the second ul.</span></span></code></pre></div>
<p>The very good new is that you should already be at ease with CSS selectors from section <a href="beautify-css.html#css-selectors">6.2</a>!</p>
</div>
<div id="good-practice" class="section level3">
<h3>
<span class="header-section-number">10.5.3</span> Good practice<a class="anchor" aria-label="anchor" href="#good-practice"><i class="fas fa-link"></i></a>
</h3>
<p>It is recommended to wrap any jQuery code as follows:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb276-1"><a href="survival-kit-javascript.html#cb276-1"></a><span class="at">$</span>(document).<span class="at">ready</span>(<span class="kw">function</span>()<span class="op">{</span></span>
<span id="cb276-2"><a href="survival-kit-javascript.html#cb276-2"></a>  <span class="co">// your code</span></span>
<span id="cb276-3"><a href="survival-kit-javascript.html#cb276-3"></a><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb276-4"><a href="survival-kit-javascript.html#cb276-4"></a></span>
<span id="cb276-5"><a href="survival-kit-javascript.html#cb276-5"></a><span class="co">// or a shortcut</span></span>
<span id="cb276-6"><a href="survival-kit-javascript.html#cb276-6"></a></span>
<span id="cb276-7"><a href="survival-kit-javascript.html#cb276-7"></a><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb276-8"><a href="survival-kit-javascript.html#cb276-8"></a>  <span class="co">// your code</span></span>
<span id="cb276-9"><a href="survival-kit-javascript.html#cb276-9"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>This is to avoid to interact with the DOM before it is actually ready. Most of the time,
if you forget this, you’ll end up with many issues involving <code>undefined</code> elements.</p>
</div>
<div id="useful-functions" class="section level3">
<h3>
<span class="header-section-number">10.5.4</span> Useful functions<a class="anchor" aria-label="anchor" href="#useful-functions"><i class="fas fa-link"></i></a>
</h3>
<p>There exist filtering functions dedicated to simplify item <a href="https://api.jquery.com/category/traversing/">selection</a>. Below are is a list containing the mostly used in Shiny.</p>
<div id="travel-in-the-dom" class="section level4">
<h4>
<span class="header-section-number">10.5.4.1</span> Travel in the DOM<a class="anchor" aria-label="anchor" href="#travel-in-the-dom"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="44%">
<col width="55%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">children()</td>
<td align="center">Get the children of each element passed in the selector (important: only travels a single level down the DOM tree)</td>
</tr>
<tr class="even">
<td align="center">first()</td>
<td align="center">Given an list of elements, select the first item</td>
</tr>
<tr class="odd">
<td align="center">last()</td>
<td align="center">Given an list of elements, select the last item</td>
</tr>
<tr class="even">
<td align="center">find()</td>
<td align="center">Look for a descendant of the selected element(s) that could be multiple levels down in the DOM</td>
</tr>
<tr class="odd">
<td align="center">closest()</td>
<td align="center">Returns the first ancestor matching the condition (travels up in the DOM)</td>
</tr>
<tr class="even">
<td align="center">filter()</td>
<td align="center">Fine tune element selection by applying a filter. Only return element for which the condition is true</td>
</tr>
<tr class="odd">
<td align="center">siblings()</td>
<td align="center">Get all siblings of the selected element(s)</td>
</tr>
<tr class="even">
<td align="center">next()</td>
<td align="center">Get the immediately following sibling</td>
</tr>
<tr class="odd">
<td align="center">prev()</td>
<td align="center">Get the immediately preceding sibling</td>
</tr>
<tr class="even">
<td align="center">not()</td>
<td align="center">Given an existing set of selected elements, remove element(s) that match the given condition</td>
</tr>
</tbody>
</table></div>
</div>
<div id="manipulate-tags" class="section level4">
<h4>
<span class="header-section-number">10.5.4.2</span> Manipulate tags<a class="anchor" aria-label="anchor" href="#manipulate-tags"><i class="fas fa-link"></i></a>
</h4>
<p>Below is a list of the main jQuery <a href="https://api.jquery.com/category/manipulation/">methods</a> to manipulate tags (adding class, css property…)</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="44%">
<col width="55%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">addClass()</td>
<td align="center">Add class or multiple classes to the set of matched elements</td>
</tr>
<tr class="even">
<td align="center">hasClass()</td>
<td align="center">Check if the matched element(s) have a given class</td>
</tr>
<tr class="odd">
<td align="center">removeClass()</td>
<td align="center">Remove class or multiple classes to the set of matched elements</td>
</tr>
<tr class="even">
<td align="center">attr()</td>
<td align="center">Get or set the value of a specific attribute</td>
</tr>
<tr class="odd">
<td align="center">after()</td>
<td align="center">Insert content after</td>
</tr>
<tr class="even">
<td align="center">before ()</td>
<td align="center">Insert content before</td>
</tr>
<tr class="odd">
<td align="center">css()</td>
<td align="center">Get or set a css property</td>
</tr>
<tr class="even">
<td align="center">remove()</td>
<td align="center">Remove element(s) from the DOM</td>
</tr>
<tr class="odd">
<td align="center">val()</td>
<td align="center">Get the current value of the matched element(s)</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="chaining-jquery-methods" class="section level3">
<h3>
<span class="header-section-number">10.5.5</span> Chaining jQuery methods<a class="anchor" aria-label="anchor" href="#chaining-jquery-methods"><i class="fas fa-link"></i></a>
</h3>
<p>A lot of jQuery methods may be chained, that is like pipe operations in R.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb277-1"><a href="survival-kit-javascript.html#cb277-1"></a><span class="kw">&lt;ul&gt;</span></span>
<span id="cb277-2"><a href="survival-kit-javascript.html#cb277-2"></a>  <span class="kw">&lt;li&gt;</span>Item 1<span class="kw">&lt;/li&gt;</span></span>
<span id="cb277-3"><a href="survival-kit-javascript.html#cb277-3"></a>  <span class="kw">&lt;li&gt;</span>Item 2<span class="kw">&lt;/li&gt;</span></span>
<span id="cb277-4"><a href="survival-kit-javascript.html#cb277-4"></a>  <span class="kw">&lt;li&gt;</span>Item 3<span class="kw">&lt;/li&gt;</span></span>
<span id="cb277-5"><a href="survival-kit-javascript.html#cb277-5"></a>  <span class="kw">&lt;li&gt;</span>Item 4<span class="kw">&lt;/li&gt;</span></span>
<span id="cb277-6"><a href="survival-kit-javascript.html#cb277-6"></a>  <span class="kw">&lt;li&gt;</span>Item 5<span class="kw">&lt;/li&gt;</span></span>
<span id="cb277-7"><a href="survival-kit-javascript.html#cb277-7"></a><span class="kw">&lt;/ul&gt;</span></span></code></pre></div>
<p>We end the chain by <code>;</code> and each step is indented by 2 spaces in the right direction:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb278-1"><a href="survival-kit-javascript.html#cb278-1"></a><span class="at">$</span>(<span class="st">'ul'</span>)</span>
<span id="cb278-2"><a href="survival-kit-javascript.html#cb278-2"></a>  .<span class="at">first</span>()</span>
<span id="cb278-3"><a href="survival-kit-javascript.html#cb278-3"></a>  .<span class="at">css</span>(<span class="st">'color'</span><span class="op">,</span> <span class="st">'green'</span>) <span class="co">// add some style with css</span></span>
<span id="cb278-4"><a href="survival-kit-javascript.html#cb278-4"></a>  .<span class="at">attr</span>(<span class="st">'id'</span><span class="op">,</span> <span class="st">'myAwesomeItem'</span>) <span class="co">// add an id attribute</span></span>
<span id="cb278-5"><a href="survival-kit-javascript.html#cb278-5"></a>  .<span class="at">addClass</span>(<span class="st">'amazing-ul'</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="iterations-1" class="section level3">
<h3>
<span class="header-section-number">10.5.6</span> Iterations<a class="anchor" aria-label="anchor" href="#iterations-1"><i class="fas fa-link"></i></a>
</h3>
<p>Like in JavaScript, it is possible to do iterations with jQuery. Let’s consider the following HTML elements:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb279-1"><a href="survival-kit-javascript.html#cb279-1"></a><span class="kw">&lt;ul&gt;</span></span>
<span id="cb279-2"><a href="survival-kit-javascript.html#cb279-2"></a>  <span class="kw">&lt;li&gt;</span>Item 1<span class="kw">&lt;/li&gt;</span></span>
<span id="cb279-3"><a href="survival-kit-javascript.html#cb279-3"></a>  <span class="kw">&lt;li&gt;</span>Item 2<span class="kw">&lt;/li&gt;</span></span>
<span id="cb279-4"><a href="survival-kit-javascript.html#cb279-4"></a><span class="kw">&lt;/ul&gt;</span></span></code></pre></div>
<p>Many jQuery methods have an implicit iteration. For instance, to change the style of each matched element, we don’t need to do as below:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb280-1"><a href="survival-kit-javascript.html#cb280-1"></a><span class="at">$</span>(<span class="st">'li'</span>).<span class="at">each</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb280-2"><a href="survival-kit-javascript.html#cb280-2"></a>  <span class="at">$</span>(<span class="kw">this</span>).<span class="at">css</span>(<span class="st">'visibility'</span><span class="op">,</span> <span class="st">'hidden'</span>)<span class="op">;</span> <span class="co">// will hide all li items</span></span>
<span id="cb280-3"><a href="survival-kit-javascript.html#cb280-3"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>Instead, we just have to write:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb281-1"><a href="survival-kit-javascript.html#cb281-1"></a><span class="at">$</span>(<span class="st">'li'</span>).<span class="at">css</span>(<span class="st">'visibility'</span><span class="op">,</span> <span class="st">'hidden'</span>)<span class="op">;</span></span></code></pre></div>
<p>which is much better. The <code>map</code> method has a different purpose. It creates a new object based on the provided one:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb282-1"><a href="survival-kit-javascript.html#cb282-1"></a><span class="kw">const</span> items <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span></span>
<span id="cb282-2"><a href="survival-kit-javascript.html#cb282-2"></a><span class="kw">const</span> threshold <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb282-3"><a href="survival-kit-javascript.html#cb282-3"></a></span>
<span id="cb282-4"><a href="survival-kit-javascript.html#cb282-4"></a><span class="kw">let</span> filteredItems <span class="op">=</span> <span class="va">$</span>.<span class="at">map</span>(items<span class="op">,</span> <span class="kw">function</span>(i) <span class="op">{</span></span>
<span id="cb282-5"><a href="survival-kit-javascript.html#cb282-5"></a>  <span class="co">// removes all items &gt; threshold</span></span>
<span id="cb282-6"><a href="survival-kit-javascript.html#cb282-6"></a>  <span class="cf">if</span> (i <span class="op">&gt;</span> threshold) </span>
<span id="cb282-7"><a href="survival-kit-javascript.html#cb282-7"></a>    <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb282-8"><a href="survival-kit-javascript.html#cb282-8"></a>  <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb282-9"><a href="survival-kit-javascript.html#cb282-9"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="events" class="section level3">
<h3>
<span class="header-section-number">10.5.7</span> Events<a class="anchor" aria-label="anchor" href="#events"><i class="fas fa-link"></i></a>
</h3>
<p>In jQuery there exists a significant number methods related to events. Below are the most popular:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb283-1"><a href="survival-kit-javascript.html#cb283-1"></a><span class="at">$</span>(element).<span class="at">click</span>()<span class="op">;</span> <span class="co">// click event</span></span>
<span id="cb283-2"><a href="survival-kit-javascript.html#cb283-2"></a><span class="at">$</span>(element).<span class="at">change</span>()<span class="op">;</span> <span class="co">// trigger change on an element</span></span>
<span id="cb283-3"><a href="survival-kit-javascript.html#cb283-3"></a><span class="at">$</span>(element).<span class="at">on</span>(<span class="st">'click'</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb283-4"><a href="survival-kit-javascript.html#cb283-4"></a> <span class="co">// whatever</span></span>
<span id="cb283-5"><a href="survival-kit-javascript.html#cb283-5"></a><span class="op">}</span>)<span class="op">;</span> <span class="co">// attach an event handler function. Here we add click for the example</span></span>
<span id="cb283-6"><a href="survival-kit-javascript.html#cb283-6"></a><span class="at">$</span>(element).<span class="at">one</span>(<span class="st">'click'</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb283-7"><a href="survival-kit-javascript.html#cb283-7"></a> <span class="co">// whatever</span></span>
<span id="cb283-8"><a href="survival-kit-javascript.html#cb283-8"></a><span class="op">}</span>)<span class="op">;</span> <span class="co">// the difference with on is that one will trigger only once</span></span>
<span id="cb283-9"><a href="survival-kit-javascript.html#cb283-9"></a><span class="at">$</span>(element).<span class="at">resize</span>()<span class="op">;</span> <span class="co">// useful to trigger plot resize in Shiny so that they correctly fit their container</span></span>
<span id="cb283-10"><a href="survival-kit-javascript.html#cb283-10"></a><span class="at">$</span>(element).<span class="at">trigger</span>(<span class="st">'change'</span>) <span class="co">// similar to $(element).change(); You will find it in the Shiny core.</span></span></code></pre></div>
<p>The <code>.on</code> event is frequently used in Shiny since it allows to pass custom events which are not part of the JS predefined events. For instance <a href="http://rstudio.github.io/shinydashboard/">shinydashboard</a> <span class="citation">(Chang and Borges Ribeiro <a href="references.html#ref-R-shinydashboard" role="doc-biblioref">2018</a>)</span> relies on a specific HTML/JavaScript/CSS template including a homemade API for handling the dashboard events.</p>
</div>
<div id="extending-objects" class="section level3">
<h3>
<span class="header-section-number">10.5.8</span> Extending objects<a class="anchor" aria-label="anchor" href="#extending-objects"><i class="fas fa-link"></i></a>
</h3>
<p>A last feature we need to mention about jQuery is the ability to extend objects with additional properties and/or method.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb284-1"><a href="survival-kit-javascript.html#cb284-1"></a><span class="co">// jQuery way</span></span>
<span id="cb284-2"><a href="survival-kit-javascript.html#cb284-2"></a><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb284-3"><a href="survival-kit-javascript.html#cb284-3"></a>  <span class="kw">let</span> object1 <span class="op">=</span> <span class="op">{</span> <span class="dt">apple</span><span class="op">:</span> <span class="dv">0</span> <span class="op">};</span></span>
<span id="cb284-4"><a href="survival-kit-javascript.html#cb284-4"></a>  <span class="va">$</span>.<span class="at">extend</span>(object1<span class="op">,</span> <span class="op">{</span></span>
<span id="cb284-5"><a href="survival-kit-javascript.html#cb284-5"></a>    <span class="dt">print</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb284-6"><a href="survival-kit-javascript.html#cb284-6"></a>      <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>)<span class="op">;</span></span>
<span id="cb284-7"><a href="survival-kit-javascript.html#cb284-7"></a>    <span class="op">}</span></span>
<span id="cb284-8"><a href="survival-kit-javascript.html#cb284-8"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb284-9"><a href="survival-kit-javascript.html#cb284-9"></a>  <span class="va">object1</span>.<span class="at">print</span>()<span class="op">;</span></span>
<span id="cb284-10"><a href="survival-kit-javascript.html#cb284-10"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>With pure JS we would use <code>Object.defineProperty</code>:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb285-1"><a href="survival-kit-javascript.html#cb285-1"></a><span class="co">// pure JavaScript</span></span>
<span id="cb285-2"><a href="survival-kit-javascript.html#cb285-2"></a><span class="va">Object</span>.<span class="at">defineProperty</span>(object1<span class="op">,</span> <span class="st">'print'</span><span class="op">,</span> <span class="op">{</span></span>
<span id="cb285-3"><a href="survival-kit-javascript.html#cb285-3"></a>  <span class="dt">value</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb285-4"><a href="survival-kit-javascript.html#cb285-4"></a>    <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>)<span class="op">;</span></span>
<span id="cb285-5"><a href="survival-kit-javascript.html#cb285-5"></a>  <span class="op">},</span></span>
<span id="cb285-6"><a href="survival-kit-javascript.html#cb285-6"></a>  <span class="dt">writable</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb285-7"><a href="survival-kit-javascript.html#cb285-7"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
</div>
</div>
<div id="shiny-js-inspector" class="section level2">
<h2>
<span class="header-section-number">10.6</span> Shiny, JavaScript and the HTML inspector<a class="anchor" aria-label="anchor" href="#shiny-js-inspector"><i class="fas fa-link"></i></a>
</h2>
<p>In the above part, we provided some elementary JS knowledge. This section comes back to the main point of this book, that is Shiny. We describe how to leverage the developer tools so as to test, run and debug JavaScript code related to a Shiny app.</p>
<div id="the-console-panel" class="section level3">
<h3>
<span class="header-section-number">10.6.1</span> The console panel<a class="anchor" aria-label="anchor" href="#the-console-panel"><i class="fas fa-link"></i></a>
</h3>
<p>While developing JS code, we often put some <code>console.log(var)</code> calls to track the content of a given variable and check that our code is doing what it is supposed to do. The resulting messages, errors or warnings are printing in the console, also called a Read-eval-print loop (<strong>REPL</strong>), suitable to experiment and practice your new JS/jQuery skills.</p>
<div id="a-real-repl" class="section level4">
<h4>
<span class="header-section-number">10.6.1.1</span> A real REPL<a class="anchor" aria-label="anchor" href="#a-real-repl"><i class="fas fa-link"></i></a>
</h4>
<p>As a warm up, run the shiny app below and open the Chrome DevTools. Notice the two <code>Console</code> tabs (next to <code>Elements</code> and at the bottom, the latter may not be visible all the time and can be activated in the parameters), as depicted in Figure <a href="survival-kit-javascript.html#fig:dom-console">10.5</a>. We recommend using the bottom one to still see the <code>Elements</code> tab and preview DOM modifications in real time.</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span id="fig:dom-console"></span>
<img src="images/survival-kit/dom-console.png" alt="Console panel in the DevTools" width="100%"><p class="caption">
FIGURE 10.5: Console panel in the DevTools
</p>
</div>
<p>Interestingly, you may access any element contained in the window. Copy and paste <code>$("body").addClass("plop");</code> in the prompt. Notice what happens in the <code>Elements</code> tab.</p>
</div>
<div id="track-errors-and-warnings" class="section level4">
<h4>
<span class="header-section-number">10.6.1.2</span> Track errors and warnings<a class="anchor" aria-label="anchor" href="#track-errors-and-warnings"><i class="fas fa-link"></i></a>
</h4>
<p>A lot of Shiny app issues on <a href="https://stackoverflow.com/">Stack Overflow</a> or in the <a href="https://community.rstudio.com/">RStudio community</a> could be more easily solved by quickly inspecting the console.</p>
</div>
</div>
<div id="broken-shiny-app-debug" class="section level3">
<h3>
<span class="header-section-number">10.6.2</span> Debug Shiny/JS code with the inspector<a class="anchor" aria-label="anchor" href="#broken-shiny-app-debug"><i class="fas fa-link"></i></a>
</h3>
<p>To debug Shiny apps from the inspector, all your scripts have to be in a folder accessible by the app like the <code>www/</code> folder or by using <code><a href="https://rdrr.io/pkg/shiny/man/resourcePaths.html">addResourcePath()</a></code>. Moreover,
if you have minified files, there should be <a href="https://www.html5rocks.com/en/tutorials/developertools/sourcemaps/">source maps</a>, which will allow to reconstruct the original scripts, that is as they were before the minification process. For instance, Shiny has the <code>shiny.min.js.map</code>. In practice, most R packages bundling HTML templates do not ship these files since they could be quite large (&gt; 1.5MB) and CRAN restricts the package size to 5MB. For instance, the <a href="https://framework7.io/">framework7</a> HTML template, on top of which is built <a href="https://github.com/RinteRface/shinyMobile">shinyMobile</a> [R-shinyMobile] has source maps but the size can reach 5MB which is obviously too big to include in the R package.</p>
<p>In the following, we consider a very simple shiny app deployed on <a href="https://www.shinyapps.io/">shinyapps.io</a>, where a notification is displayed with JavaScript as soon as a user clicks an action button. We deliberately made some typos, the goal being to find and fix them.</p>
<ol style="list-style-type: decimal">
<li>Browse to the <a href="https://dgranjon.shinyapps.io/debug_app_in_web_browser/">app</a>
</li>
<li>Open the Chrome DevTools</li>
<li>Click on the action button (I am pretty sure you clicked before step 2 ;))</li>
<li>As expected and shown Figure <a href="survival-kit-javascript.html#fig:dom-debug-shiny-error">10.6</a>, the console displays an
error message: <code>Uncaught TypeError: Cannot read property 'show' of undefined</code>. Sounds good isn’t it?</li>
</ol>
<div class="figure">
<span id="fig:dom-debug-shiny-error"></span>
<img src="images/survival-kit/dom-debug-shiny-error.png" alt="Error in the console panel" width="100%"><p class="caption">
FIGURE 10.6: Error in the console panel
</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li>Expand the error message to show the stack trace. We see that the error occurred during an <code>onclick</code> event calling the <code>sendNotif</code> function. Interestingly, we can open this file by clicking on the provided link (notif.js:2). You should get a layout similar to Figure <a href="survival-kit-javascript.html#fig:dom-debug-shiny-sources">10.7</a>, depending on your screen width.</li>
</ol>
<div class="figure">
<span id="fig:dom-debug-shiny-sources"></span>
<img src="images/survival-kit/dom-debug-shiny-sources.png" alt="Inspect the source causing the error" width="100%"><p class="caption">
FIGURE 10.7: Inspect the source causing the error
</p>
</div>
<ol start="6" style="list-style-type: decimal">
<li><p>Let’s briefly describe Figure <a href="survival-kit-javascript.html#fig:dom-debug-shiny-sources">10.7</a>. On the left side, you can navigate through all files accessible by the web server, that is shiny internal resources, shiny external dependencies (like Bootstrap 3) as well as your own scripts. If the app is deployed on shinyapps.io, all scripts are located in a folder starting by <code>_w_</code>, which corresponds to the shinyapps.io workerId (this is a detail and not important to understand. See more <a href="https://github.com/rstudio/shiny/blob/master/R/shiny.R#L69">here</a>). The central part contains any opened script like a classic IDE. The right side displays debugging tools which you may trigger by clicking on the corresponding accordion. The scope shows all variables/object values at a break point, watch allows to track specific elements and Event listener Breakpoints allows to stop at given listener type. We could create a new “watcher” by entering <code>typeof message</code> and clicking the add icon to check the message type within the <code>sendNotif</code> function. Watched expressions are saved when you close the browser.</p></li>
<li><p>Put a break point line 2 by clicking on the left side of the center panel and click again on the action button to trigger the break point. I also additionally set 2 Watch Expressions (for message and duration) which type is string and number, respectively, as depicted on Figure <a href="survival-kit-javascript.html#fig:dom-debug-shiny-breakpoint">10.8</a>. According to the results, nothing seems wrong for the function arguments.</p></li>
</ol>
<div class="figure">
<span id="fig:dom-debug-shiny-breakpoint"></span>
<img src="images/survival-kit/dom-debug-shiny-breakpoint.png" alt="Inspection of the scope at the breakpoint" width="100%"><p class="caption">
FIGURE 10.8: Inspection of the scope at the breakpoint
</p>
</div>
<ol start="8" style="list-style-type: decimal">
<li>The error message <code>Uncaught TypeError: Cannot read property 'show' of undefined</code> actually means that <code>notification</code> does not exist. Try yourself by typing <code>Shiny.notification</code> in the console. You’ll get <code>undefined</code>. Instead, the console suggests <code>Shiny.notifications</code>. Let’s replace the wrong code in the <code>notif.js</code> script and then save it.
Click on the “Resume script execution” blue button (top left of the right panel). Notice that a notification is displayed and no more error is thrown.</li>
</ol>
<p>Congrats! You’ve just debugged your first shiny app from the web inspector. In practice, your code is probably much more complex than this example but the workflow remains the same.</p>
</div>
<div id="shiny-js-object" class="section level3">
<h3>
<span class="header-section-number">10.6.3</span> The Shiny JavaScript object<a class="anchor" aria-label="anchor" href="#shiny-js-object"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>Shiny</code> object is exported at the top of the <code>shiny.js</code> file. In other words, we may use this object and any of its properties within the HTML inspector console tab, in any JavaScript file or shiny app as below:</p>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">script</span><span class="op">(</span>
    <span class="st">"$(function() {
      console.log(Shiny);
    });
    "</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>This object contains many properties and methods as shown in Figure <a href="survival-kit-javascript.html#fig:shiny-object">10.9</a>. Some of particular interest, such as like <code>Shiny.setInputValue</code>, <code>Shiny.addCustomMessageHandler</code>, <code>Shiny.shinyapps</code>, <code>Shiny.bindAll</code>, will be detailed later in Chapters <a href="shiny-input-system.html#shiny-input-system">12</a> and <a href="shiny-custom-handler.html#shiny-custom-handler">15</a>.</p>
<div class="figure">
<span id="fig:shiny-object"></span>
<img src="images/survival-kit/shiny-object.png" alt="The Shiny JavaScript object" width="100%"><p class="caption">
FIGURE 10.9: The Shiny JavaScript object
</p>
</div>
<div class="warningbox">
<p>At this point, users may find <code><a href="https://rdrr.io/r/base/options.html">options(shiny.minified = FALSE)</a></code> convenient to debug the Shiny.js core.</p>
</div>
</div>
</div>
<div id="exercises-1" class="section level2">
<h2>
<span class="header-section-number">10.7</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"><i class="fas fa-link"></i></a>
</h2>
<p>Because the JavaScript console is a REPL, all JavaScript exercises may be done inside, except exercise 3 which also involves HTML. In that case, the reader may browse to <a href="https://jsfiddle.net/">jsfiddle</a>.</p>
<div id="exercise-1-define-variables" class="section level3">
<h3>
<span class="header-section-number">10.7.1</span> Exercise 1: define variables<a class="anchor" aria-label="anchor" href="#exercise-1-define-variables"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Play with the example below</li>
</ol>
<div class="sourceCode" id="cb288"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb288-1"><a href="survival-kit-javascript.html#cb288-1"></a><span class="kw">let</span> myNumber <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// affectation</span></span>
<span id="cb288-2"><a href="survival-kit-javascript.html#cb288-2"></a>myNumber<span class="op">--;</span> <span class="co">// decrement</span></span>
<span id="cb288-3"><a href="survival-kit-javascript.html#cb288-3"></a><span class="va">console</span>.<span class="at">log</span>(myNumber)<span class="op">;</span> <span class="co">// print 0</span></span></code></pre></div>
<script type="text/javascript">
let myNumber = 1; // affectation
myNumber--; // decrement
console.log(myNumber); // print 0
</script>
</div>
<div id="exercise-2-define-objects" class="section level3">
<h3>
<span class="header-section-number">10.7.2</span> Exercise 2: define objects<a class="anchor" aria-label="anchor" href="#exercise-2-define-objects"><i class="fas fa-link"></i></a>
</h3>
<p>Below is an object skeleton.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb289-1"><a href="survival-kit-javascript.html#cb289-1"></a><span class="kw">const</span> me <span class="op">=</span> <span class="op">{</span></span>
<span id="cb289-2"><a href="survival-kit-javascript.html#cb289-2"></a>  <span class="dt">name </span><span class="op">:</span> <span class="op">,</span></span>
<span id="cb289-3"><a href="survival-kit-javascript.html#cb289-3"></a>  <span class="dt">age </span><span class="op">:</span> <span class="op">,</span></span>
<span id="cb289-4"><a href="survival-kit-javascript.html#cb289-4"></a>  <span class="dt">music </span><span class="op">:</span> <span class="op">,</span></span>
<span id="cb289-5"><a href="survival-kit-javascript.html#cb289-5"></a>  <span class="dt">printName</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb289-6"><a href="survival-kit-javascript.html#cb289-6"></a>    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`I am </span><span class="sc">${}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb289-7"><a href="survival-kit-javascript.html#cb289-7"></a>  <span class="op">}</span></span>
<span id="cb289-8"><a href="survival-kit-javascript.html#cb289-8"></a><span class="op">}</span></span></code></pre></div>
<script type="text/javascript">
const me = {
  name : ,
  age : ,
  music : ,
  printName: function() {
    console.log(`I am ${}`);
  }
}
</script><ol style="list-style-type: decimal">
<li>Fill it with some random values.</li>
<li>Access the name property.</li>
<li>Create the printAge method, which returns the age. Hint: <code>this</code> refers to the object itself. For instance <code>this.name</code> gives the name property.</li>
</ol>
</div>
<div id="exercise-3-jquery" class="section level3">
<h3>
<span class="header-section-number">10.7.3</span> Exercise 3: jQuery<a class="anchor" aria-label="anchor" href="#exercise-3-jquery"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://jsfiddle.net/">JSFiddle</a> allows to insert HTML, CSS and JavaScript to test
code, share and more. It also does not require you to have any specific configuration on your machine so that you focus on testing!</p>
<ol style="list-style-type: decimal">
<li>Go to <a href="https://jsfiddle.net/">JSFiddle</a>
</li>
<li>Insert the following HTML code chunk in the HTML sub-window.</li>
</ol>
<div class="sourceCode" id="cb290"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb290-1"><a href="survival-kit-javascript.html#cb290-1"></a><span class="dt">&lt;!DOCTYPE </span>HTML<span class="dt">&gt;</span></span>
<span id="cb290-2"><a href="survival-kit-javascript.html#cb290-2"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb290-3"><a href="survival-kit-javascript.html#cb290-3"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb290-4"><a href="survival-kit-javascript.html#cb290-4"></a>  <span class="co">&lt;!-- head content here --&gt;</span></span>
<span id="cb290-5"><a href="survival-kit-javascript.html#cb290-5"></a>  <span class="kw">&lt;/head&gt;</span></span>
<span id="cb290-6"><a href="survival-kit-javascript.html#cb290-6"></a>  <span class="kw">&lt;body&gt;</span></span>
<span id="cb290-7"><a href="survival-kit-javascript.html#cb290-7"></a>    <span class="kw">&lt;ul&gt;</span></span>
<span id="cb290-8"><a href="survival-kit-javascript.html#cb290-8"></a>      <span class="kw">&lt;li&gt;</span>Item 1<span class="kw">&lt;/li&gt;</span></span>
<span id="cb290-9"><a href="survival-kit-javascript.html#cb290-9"></a>      <span class="kw">&lt;li&gt;</span>Item 2<span class="kw">&lt;/li&gt;</span></span>
<span id="cb290-10"><a href="survival-kit-javascript.html#cb290-10"></a>      <span class="kw">&lt;li&gt;</span>Item 3<span class="kw">&lt;/li&gt;</span></span>
<span id="cb290-11"><a href="survival-kit-javascript.html#cb290-11"></a>      <span class="kw">&lt;li&gt;</span>Item 4<span class="kw">&lt;/li&gt;</span></span>
<span id="cb290-12"><a href="survival-kit-javascript.html#cb290-12"></a>      <span class="kw">&lt;li&gt;</span>Item 5<span class="kw">&lt;/li&gt;</span></span>
<span id="cb290-13"><a href="survival-kit-javascript.html#cb290-13"></a>    <span class="kw">&lt;/ul&gt;</span></span>
<span id="cb290-14"><a href="survival-kit-javascript.html#cb290-14"></a>  <span class="kw">&lt;/body&gt;</span></span>
<span id="cb290-15"><a href="survival-kit-javascript.html#cb290-15"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>This is a very basic HTML skeleton</p>
<ol start="3" style="list-style-type: decimal">
<li>In the JavaScript windows, select jQuery 3.4.1 in the dropdown menu (why 3.4.1? The latest Shiny release relies on that version. It is therefore best practice to ensure dependencies are similar, at least the major version).</li>
<li>Since it is best practice to run jQuery code only when the document is ready (avoiding to target non existing elements), we wrap our JS code in the following:</li>
</ol>
<div class="sourceCode" id="cb291"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb291-1"><a href="survival-kit-javascript.html#cb291-1"></a><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb291-2"><a href="survival-kit-javascript.html#cb291-2"></a>  <span class="co">// your code</span></span>
<span id="cb291-3"><a href="survival-kit-javascript.html#cb291-3"></a><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb291-4"><a href="survival-kit-javascript.html#cb291-4"></a></span>
<span id="cb291-5"><a href="survival-kit-javascript.html#cb291-5"></a><span class="co">// or a more explicit syntax</span></span>
<span id="cb291-6"><a href="survival-kit-javascript.html#cb291-6"></a><span class="at">$</span>(document).<span class="at">ready</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb291-7"><a href="survival-kit-javascript.html#cb291-7"></a>  <span class="co">// code</span></span>
<span id="cb291-8"><a href="survival-kit-javascript.html#cb291-8"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Create an event listener to change the third item color as soon as one click on it.
Hint 1: To select the a specific item you may use <code>$(selector:eq(i))</code> where i is the index of the element. Keep in mind that JavaScript starts from 0 and not 1 like R!
Hint 2: as a reminder, to create an event listener in jQuery, we use the following pattern.</li>
</ol>
<div class="sourceCode" id="cb292"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb292-1"><a href="survival-kit-javascript.html#cb292-1"></a><span class="at">$</span>(<span class="st">"selector"</span>).<span class="at">on</span>(<span class="st">"event_name"</span><span class="op">,</span> <span class="kw">function</span>(e) <span class="op">{</span></span>
<span id="cb292-2"><a href="survival-kit-javascript.html#cb292-2"></a>  <span class="co">// your logic</span></span>
<span id="cb292-3"><a href="survival-kit-javascript.html#cb292-3"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="exercise-4-a-pure-js-action-button" class="section level3">
<h3>
<span class="header-section-number">10.7.4</span> Exercise 4: a pure JS action button<a class="anchor" aria-label="anchor" href="#exercise-4-a-pure-js-action-button"><i class="fas fa-link"></i></a>
</h3>
<p>Below is another example of a button element with an attached event listener. Clicking on the button will increment its value by 1. Fill in the blanks!</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb293-1"><a href="survival-kit-javascript.html#cb293-1"></a><span class="dt">&lt;!DOCTYPE </span>HTML<span class="dt">&gt;</span></span>
<span id="cb293-2"><a href="survival-kit-javascript.html#cb293-2"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb293-3"><a href="survival-kit-javascript.html#cb293-3"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb293-4"><a href="survival-kit-javascript.html#cb293-4"></a>  <span class="co">&lt;!-- head content here --&gt;</span></span>
<span id="cb293-5"><a href="survival-kit-javascript.html#cb293-5"></a>  <span class="kw">&lt;/head&gt;</span></span>
<span id="cb293-6"><a href="survival-kit-javascript.html#cb293-6"></a>  <span class="kw">&lt;body&gt;</span></span>
<span id="cb293-7"><a href="survival-kit-javascript.html#cb293-7"></a>    <span class="kw">&lt;button&gt;</span>click<span class="kw">&lt;/button&gt;</span></span>
<span id="cb293-8"><a href="survival-kit-javascript.html#cb293-8"></a>  <span class="kw">&lt;/body&gt;</span></span>
<span id="cb293-9"><a href="survival-kit-javascript.html#cb293-9"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb294"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb294-1"><a href="survival-kit-javascript.html#cb294-1"></a><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb294-2"><a href="survival-kit-javascript.html#cb294-2"></a>    </span>
<span id="cb294-3"><a href="survival-kit-javascript.html#cb294-3"></a>  <span class="co">// recover the button inner html</span></span>
<span id="cb294-4"><a href="survival-kit-javascript.html#cb294-4"></a>  <span class="kw">const</span> btnText <span class="op">=</span> ...<span class="op">;</span></span>
<span id="cb294-5"><a href="survival-kit-javascript.html#cb294-5"></a></span>
<span id="cb294-6"><a href="survival-kit-javascript.html#cb294-6"></a>    <span class="co">// event listener for button element</span></span>
<span id="cb294-7"><a href="survival-kit-javascript.html#cb294-7"></a>    <span class="at">$</span>(...).<span class="at">click</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb294-8"><a href="survival-kit-javascript.html#cb294-8"></a>    <span class="kw">var</span> val <span class="op">=</span> ...<span class="op">;</span></span>
<span id="cb294-9"><a href="survival-kit-javascript.html#cb294-9"></a>    <span class="co">// (1) increment button </span></span>
<span id="cb294-10"><a href="survival-kit-javascript.html#cb294-10"></a>    <span class="co">// (2) add the button value to the inner text</span></span>
<span id="cb294-11"><a href="survival-kit-javascript.html#cb294-11"></a>    ...</span>
<span id="cb294-12"><a href="survival-kit-javascript.html#cb294-12"></a>    </span>
<span id="cb294-13"><a href="survival-kit-javascript.html#cb294-13"></a>    <span class="co">// show alert given condition</span></span>
<span id="cb294-14"><a href="survival-kit-javascript.html#cb294-14"></a>    <span class="cf">if</span> (val <span class="op">&gt;</span> <span class="dv">3</span>) <span class="op">{</span></span>
<span id="cb294-15"><a href="survival-kit-javascript.html#cb294-15"></a>      <span class="co">// do whatever you want</span></span>
<span id="cb294-16"><a href="survival-kit-javascript.html#cb294-16"></a>        ...</span>
<span id="cb294-17"><a href="survival-kit-javascript.html#cb294-17"></a>    <span class="op">}</span></span>
<span id="cb294-18"><a href="survival-kit-javascript.html#cb294-18"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb294-19"><a href="survival-kit-javascript.html#cb294-19"></a>  </span>
<span id="cb294-20"><a href="survival-kit-javascript.html#cb294-20"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="beautify-with-bootstraplib.html"><span class="header-section-number">9</span> Beautify with {bslib}</a></div>
<div class="next"><a href="shiny-intro.html"><span class="header-section-number">11</span> R and JS</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#survival-kit-javascript"><span class="header-section-number">10</span> JavaScript for Shiny</a></li>
<li><a class="nav-link" href="#shiny-javascript-sources"><span class="header-section-number">10.1</span> Shiny JavaScript sources</a></li>
<li><a class="nav-link" href="#introduction-to-javascript"><span class="header-section-number">10.2</span> Introduction to JavaScript</a></li>
<li>
<a class="nav-link" href="#setup"><span class="header-section-number">10.3</span> Setup</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#install-node"><span class="header-section-number">10.3.1</span> Node</a></li>
<li><a class="nav-link" href="#choose-a-good-ide"><span class="header-section-number">10.3.2</span> Choose a good IDE</a></li>
<li><a class="nav-link" href="#first-script"><span class="header-section-number">10.3.3</span> First Script</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#programming-with-js-basis"><span class="header-section-number">10.4</span> Programming with JS: basis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#js-types"><span class="header-section-number">10.4.1</span> JS types</a></li>
<li><a class="nav-link" href="#variables-1"><span class="header-section-number">10.4.2</span> Variables</a></li>
<li><a class="nav-link" href="#conditions"><span class="header-section-number">10.4.3</span> Conditions</a></li>
<li><a class="nav-link" href="#objects"><span class="header-section-number">10.4.4</span> Objects</a></li>
<li><a class="nav-link" href="#iterations"><span class="header-section-number">10.4.5</span> Iterations</a></li>
<li><a class="nav-link" href="#functions-1"><span class="header-section-number">10.4.6</span> Functions</a></li>
<li><a class="nav-link" href="#js-code-compatibility"><span class="header-section-number">10.4.7</span> JS code compatibility</a></li>
<li><a class="nav-link" href="#event-listeners"><span class="header-section-number">10.4.8</span> Event listeners</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#jquery"><span class="header-section-number">10.5</span> jQuery</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction-1"><span class="header-section-number">10.5.1</span> Introduction</a></li>
<li><a class="nav-link" href="#syntax"><span class="header-section-number">10.5.2</span> Syntax</a></li>
<li><a class="nav-link" href="#good-practice"><span class="header-section-number">10.5.3</span> Good practice</a></li>
<li><a class="nav-link" href="#useful-functions"><span class="header-section-number">10.5.4</span> Useful functions</a></li>
<li><a class="nav-link" href="#chaining-jquery-methods"><span class="header-section-number">10.5.5</span> Chaining jQuery methods</a></li>
<li><a class="nav-link" href="#iterations-1"><span class="header-section-number">10.5.6</span> Iterations</a></li>
<li><a class="nav-link" href="#events"><span class="header-section-number">10.5.7</span> Events</a></li>
<li><a class="nav-link" href="#extending-objects"><span class="header-section-number">10.5.8</span> Extending objects</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#shiny-js-inspector"><span class="header-section-number">10.6</span> Shiny, JavaScript and the HTML inspector</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-console-panel"><span class="header-section-number">10.6.1</span> The console panel</a></li>
<li><a class="nav-link" href="#broken-shiny-app-debug"><span class="header-section-number">10.6.2</span> Debug Shiny/JS code with the inspector</a></li>
<li><a class="nav-link" href="#shiny-js-object"><span class="header-section-number">10.6.3</span> The Shiny JavaScript object</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exercises-1"><span class="header-section-number">10.7</span> Exercises</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercise-1-define-variables"><span class="header-section-number">10.7.1</span> Exercise 1: define variables</a></li>
<li><a class="nav-link" href="#exercise-2-define-objects"><span class="header-section-number">10.7.2</span> Exercise 2: define objects</a></li>
<li><a class="nav-link" href="#exercise-3-jquery"><span class="header-section-number">10.7.3</span> Exercise 3: jQuery</a></li>
<li><a class="nav-link" href="#exercise-4-a-pure-js-action-button"><span class="header-section-number">10.7.4</span> Exercise 4: a pure JS action button</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/blob/master/shiny-javascript.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/edit/master/shiny-javascript.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Outstanding User Interfaces with Shiny</strong>" was written by David Granjon. It was last built on 2021-03-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
