<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 27 R + Shiny + React: welcome {reactR} | Outstanding User Interfaces with Shiny</title>
<meta name="author" content="David Granjon">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.9002/transition.js"></script><script src="libs/bs3compat-0.2.5.9002/tabs.js"></script><script src="libs/bs3compat-0.2.5.9002/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Outstanding User Interfaces with Shiny</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="web-intro.html"><span class="header-section-number">1</span> Shiny and the Web</a></li>
<li><a class="" href="htmltools-overview.html"><span class="header-section-number">2</span> Mastering {htmltools}</a></li>
<li><a class="" href="web-dependencies.html"><span class="header-section-number">3</span> Discover Shiny dependencies</a></li>
<li><a class="" href="htmltools-dependencies.html"><span class="header-section-number">4</span> Dependency utilities</a></li>
<li><a class="" href="web-applications.html"><span class="header-section-number">5</span> Web application concepts</a></li>
<li class="book-part">Beautify with CSS and Sass</li>
<li><a class="" href="beautify-css.html"><span class="header-section-number">6</span> CSS for Shiny</a></li>
<li><a class="" href="beautify-sass.html"><span class="header-section-number">7</span> Introduction to Sass</a></li>
<li><a class="" href="beautify-with-fresh.html"><span class="header-section-number">8</span> Beautify with {fresh}</a></li>
<li><a class="" href="beautify-with-bootstraplib.html"><span class="header-section-number">9</span> Beautify with {bslib}</a></li>
<li class="book-part">Unleash interactivity with JavaScript</li>
<li><a class="" href="survival-kit-javascript.html"><span class="header-section-number">10</span> JavaScript for Shiny</a></li>
<li><a class="" href="shiny-intro.html"><span class="header-section-number">11</span> R and JS</a></li>
<li><a class="" href="shiny-input-system.html"><span class="header-section-number">12</span> Shiny’s input system</a></li>
<li><a class="" href="shiny-input-lifecycle.html"><span class="header-section-number">13</span> Shiny inputs lifecycles</a></li>
<li><a class="" href="shiny-input-gems.html"><span class="header-section-number">14</span> Mastering Shiny’s events</a></li>
<li><a class="" href="shiny-custom-handler.html"><span class="header-section-number">15</span> Dynamically manage content with handlers</a></li>
<li class="book-part">Practice 1: a dashboard template</li>
<li><a class="" href="custom-templates-dependencies.html"><span class="header-section-number">16</span> Define dependencies</a></li>
<li><a class="" href="custom-templates-skeleton.html"><span class="header-section-number">17</span> Create template elements</a></li>
<li><a class="" href="custom-templates-inputs.html"><span class="header-section-number">18</span> Develop custom input widgets</a></li>
<li><a class="" href="custom-templates-interactivity.html"><span class="header-section-number">19</span> Adding more interactivity</a></li>
<li><a class="" href="custom-templates-testing.html"><span class="header-section-number">20</span> Testing and validating templates elements</a></li>
<li class="book-part">Toward a better workflow</li>
<li><a class="" href="workflow-charpente.html"><span class="header-section-number">21</span> Introduction to {charpente}</a></li>
<li class="book-part">Case study 2: Mobile development with Shiny</li>
<li><a class="" href="mobile-shiny-intro.html"><span class="header-section-number">22</span> Introduction</a></li>
<li><a class="" href="mobile-shinyMobile.html"><span class="header-section-number">23</span> Reconstruct {shinyMobile}</a></li>
<li><a class="" href="mobile-pwa.html"><span class="header-section-number">24</span> {shinyMobile} and PWA</a></li>
<li><a class="" href="mobile-widgets.html"><span class="header-section-number">25</span> Design widgets</a></li>
<li><a class="" href="mobile-going-further.html"><span class="header-section-number">26</span> Fine tune {shinyMobile}</a></li>
<li class="book-part">Going further</li>
<li><a class="active" href="going-further-reactR.html"><span class="header-section-number">27</span> R + Shiny + React: welcome {reactR}</a></li>
<li><a class="" href="going-further-webdev.html"><span class="header-section-number">28</span> Divide and Conquere</a></li>
<li><a class="" href="going-further-where-to-go.html"><span class="header-section-number">29</span> What to do next?</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="code-outputs.html"><span class="header-section-number">A</span> Code outputs</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/DivadNojnarg/outstanding-shiny-ui">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="going-further-reactR" class="section level1">
<h1>
<span class="header-section-number">27</span> R + Shiny + React: welcome <code>{reactR}</code><a class="anchor" aria-label="anchor" href="#going-further-reactR"><i class="fas fa-link"></i></a>
</h1>
<p><a href="https://reactjs.org/">React</a> is an open source library designed to quickly develop user interfaces or UI components, on the <strong>front end</strong>.
It has been developed by <a href="https://github.com/facebook/react">Facebook</a> and the community (more than 1500 contributors) and made public in May 29 2013. It is currently used worldwide and has around 163k stars on the GitHub ranking and widely impacts the mobile market, through the <a href="https://reactnative.dev/">React Native</a> library. <strong>React</strong> is also really convenient to develop attractive documentations with <a href="https://v2.docusaurus.io/">docusaurus</a>.
If you ever have built user interfaces with pure JS, you might like React!</p>
<p>Below, we give a short introduction to the React ecosystem and see how we can benefit from it from the R Shiny side.</p>
<div id="quick-introduction-to-react" class="section level2">
<h2>
<span class="header-section-number">27.1</span> Quick introduction to React<a class="anchor" aria-label="anchor" href="#quick-introduction-to-react"><i class="fas fa-link"></i></a>
</h2>
<p>To understand React there are few prerequisites notably basic HTML/CSS/JS knowledge, especially JS modules (see section <a href="survival-kit-javascript.html#about-js-modules">10.4.6.1</a>). However, if you managed to reach this chapter, you should not worry too much!</p>
<div id="setup-1" class="section level3">
<h3>
<span class="header-section-number">27.1.1</span> Setup<a class="anchor" aria-label="anchor" href="#setup-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Node</strong> and <strong>npm</strong> are required. If you are not sure, run:</p>
<pre class="shell"><code>node -v
npm -v</code></pre>
<p>At that stage it is also good to have <a href="https://classic.yarnpkg.com/en/docs/install#mac-stable"><code>yarn</code></a>, as we’ll need it for <a href="https://github.com/react-R/reactR">reactR</a>.</p>
<p>If nothing is returned, please refer to section <a href="survival-kit-javascript.html#install-node">10.3.1</a>. To initiate a React <a href="https://create-react-app.dev/">project</a>, we leverage the <a href="https://docs.npmjs.com/cli/v7/commands/npx"><code>npx</code></a> command:</p>
<pre><code>npx create-react-app &lt;PROJECT_NAME&gt;</code></pre>
<p>Replace <code>&lt;PROJECT_NAME&gt;</code> by the real name of your project. If this seems intimidating,
keep in mind this is the same concept that the <a href="https://github.com/ThinkR-open/golem">golem</a> <a href="https://github.com/ThinkR-open/golem">package</a> uses to initiate the creation of robust shiny projects, except that we work from the terminal.</p>
<p>Once done (the package initialization takes some time),
move to the project folder and launch the demo app:</p>
<pre><code>cd &lt;PROJECT_NAME&gt; &amp;&amp; npm start</code></pre>
<p>If you have yarn, <code>yarn start</code> also works.</p>
<p>You should see something similar to Figure <a href="going-further-reactR.html#fig:basic-react-app">27.1</a>.</p>
<div class="figure">
<span id="fig:basic-react-app"></span>
<img src="images/going-further/basic-react-app.png" alt="npm start opens the react app" width="100%"><p class="caption">
FIGURE 27.1: npm start opens the react app
</p>
</div>
<p>Congrats! You are running your first React app!</p>
</div>
<div id="basics-3" class="section level3">
<h3>
<span class="header-section-number">27.1.2</span> Basics<a class="anchor" aria-label="anchor" href="#basics-3"><i class="fas fa-link"></i></a>
</h3>
<p>We are now all set up to start learning the basics of React. Among all created files,
notice the <code>/src/app.js</code> file. Inside the <code>App</code> function, we remove all the content inside
the <code>return</code> statement to put a simple <code>&lt;h1&gt;Hello, world!&lt;/h1&gt;</code> HTML title. We also clean the imports
as we don’t need any CSS and logo anymore. We obtain:</p>
<div class="sourceCode" id="cb951"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb951-1"><a href="going-further-reactR.html#cb951-1"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb951-2"><a href="going-further-reactR.html#cb951-2"></a>  <span class="cf">return</span> (</span>
<span id="cb951-3"><a href="going-further-reactR.html#cb951-3"></a>    <span class="kw">&lt;h1&gt;</span>Hello, world!<span class="kw">&lt;/h1&gt;</span></span>
<span id="cb951-4"><a href="going-further-reactR.html#cb951-4"></a>  )<span class="op">;</span></span>
<span id="cb951-5"><a href="going-further-reactR.html#cb951-5"></a><span class="op">}</span></span>
<span id="cb951-6"><a href="going-further-reactR.html#cb951-6"></a></span>
<span id="cb951-7"><a href="going-further-reactR.html#cb951-7"></a><span class="co">// don't remove, this is needed by index.js</span></span>
<span id="cb951-8"><a href="going-further-reactR.html#cb951-8"></a><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span> </span></code></pre></div>
<p>Once done, we run <code>npm build</code> (or <code>yarn build</code>), to rebuild the JS code and <code>npm start</code> to
restart the server and preview the app. In practice, once the server is launched, there is
no need to restart it whenever the code is updated. A simple save will refresh the interface!</p>
<p>The code you see above is a React <strong>component</strong>. The definition is rather simple: it is a function that returns a moreless complex piece of UI. How are components rendered by React?</p>
<p>So far, we didn’t have a look at the <code>/src/index.js</code> script. Inside we find:</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb952-1"><a href="going-further-reactR.html#cb952-1"></a><span class="va">ReactDOM</span>.<span class="at">render</span>(</span>
<span id="cb952-2"><a href="going-further-reactR.html#cb952-2"></a>  App<span class="op">,</span></span>
<span id="cb952-3"><a href="going-further-reactR.html#cb952-3"></a>  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">'root'</span>)</span>
<span id="cb952-4"><a href="going-further-reactR.html#cb952-4"></a>)<span class="op">;</span></span></code></pre></div>
<div class="noteblock">
<p>Recent versions of <code>npx create-react-app</code> have <code>&lt;React.StrictMode&gt;&lt;App /&gt;&lt;/React.StrictMode&gt;</code> instead of <code>App</code>, which does the same thing. You may also find <code>&lt;App /&gt;</code>. In practice, we rarely modify this part.</p>
</div>
<p>In short, this inserts the <code>App</code> component inside the element having <strong>root</strong> as id in the main
HTML page. This HTML skeleton may be found in the <code>public/index.html</code> folder. You may imagine that at the end of the day, our app will be composed of multiple bricks and call <code>ReactDOM.render</code> on the top level component.</p>
<div id="about-jsx" class="section level4">
<h4>
<span class="header-section-number">27.1.2.1</span> About JSX<a class="anchor" aria-label="anchor" href="#about-jsx"><i class="fas fa-link"></i></a>
</h4>
<p>We just wrote our first React component. Didn’t you notice something weird in that code?
JS and HTML are mixed, in what we called <strong>JSX</strong>, that is a syntax extension to JS. JSX makes the code
less verbose, for instance:</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb953-1"><a href="going-further-reactR.html#cb953-1"></a><span class="va">React</span>.<span class="at">createElement</span>(</span>
<span id="cb953-2"><a href="going-further-reactR.html#cb953-2"></a>  <span class="st">'h1'</span><span class="op">,</span></span>
<span id="cb953-3"><a href="going-further-reactR.html#cb953-3"></a>  <span class="st">'Hello, world!'</span></span>
<span id="cb953-4"><a href="going-further-reactR.html#cb953-4"></a>)<span class="op">;</span></span></code></pre></div>
<p>does exactly the same thing as above but when the code becomes more complex, it is nearly
impossible to read.</p>
<p>Let’s see how to pass variables into JSX. We want to show <code>Hello, &lt;Your Name&gt;</code>, we store
the name in a variable and modify the <code>app.js</code> code accordingly:</p>
<div class="sourceCode" id="cb954"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb954-1"><a href="going-further-reactR.html#cb954-1"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb954-2"><a href="going-further-reactR.html#cb954-2"></a>  <span class="kw">const</span> name <span class="op">=</span> <span class="st">"David"</span><span class="op">;</span></span>
<span id="cb954-3"><a href="going-further-reactR.html#cb954-3"></a>  <span class="cf">return</span> (</span>
<span id="cb954-4"><a href="going-further-reactR.html#cb954-4"></a>    <span class="kw">&lt;h1&gt;</span>Hello, <span class="va">{</span>name<span class="va">}</span><span class="kw">&lt;/h1&gt;</span></span>
<span id="cb954-5"><a href="going-further-reactR.html#cb954-5"></a>  )<span class="op">;</span></span>
<span id="cb954-6"><a href="going-further-reactR.html#cb954-6"></a><span class="op">}</span></span></code></pre></div>
<p>Expressions are passed within curly brackets <code>{expression}</code> and you may even call functions inside.
Tag attributes also require curly brackets. Let’s modify the title tag to give it a color and
a size.</p>
<div class="sourceCode" id="cb955"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb955-1"><a href="going-further-reactR.html#cb955-1"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb955-2"><a href="going-further-reactR.html#cb955-2"></a>  <span class="kw">const</span> name <span class="op">=</span> <span class="st">"David"</span><span class="op">;</span></span>
<span id="cb955-3"><a href="going-further-reactR.html#cb955-3"></a>  <span class="cf">return</span> (</span>
<span id="cb955-4"><a href="going-further-reactR.html#cb955-4"></a>    <span class="kw">&lt;h1</span> <span class="ot">style</span><span class="op">=</span><span class="va">{</span>color<span class="op">:</span> <span class="st">"red"</span><span class="op">,</span> fontSize<span class="op">:</span> <span class="dv">40</span><span class="va">}</span><span class="kw">&gt;</span>Hello, <span class="va">{</span>name<span class="va">}</span><span class="kw">&lt;/h1&gt;</span></span>
<span id="cb955-5"><a href="going-further-reactR.html#cb955-5"></a>  )<span class="op">;</span></span>
<span id="cb955-6"><a href="going-further-reactR.html#cb955-6"></a><span class="op">}</span></span></code></pre></div>
<p>Try to save. Why does this fail? We can’t pass multiple object properties inside a single <code>{}</code>.
We need either double brackets like <code>{{object properties: values, ...}}</code> or to store the object in
a variable before:</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb956-1"><a href="going-further-reactR.html#cb956-1"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb956-2"><a href="going-further-reactR.html#cb956-2"></a>  <span class="kw">const</span> name <span class="op">=</span> <span class="st">"David"</span><span class="op">;</span></span>
<span id="cb956-3"><a href="going-further-reactR.html#cb956-3"></a>  <span class="cf">return</span> (</span>
<span id="cb956-4"><a href="going-further-reactR.html#cb956-4"></a>    <span class="kw">&lt;h1</span> <span class="ot">style</span><span class="op">=</span><span class="va">{</span><span class="op">{</span><span class="dt">color</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">40</span><span class="op">}</span><span class="va">}</span><span class="kw">&gt;</span>Hello, <span class="va">{</span>name<span class="va">}</span><span class="kw">&lt;/h1&gt;</span></span>
<span id="cb956-5"><a href="going-further-reactR.html#cb956-5"></a>  )<span class="op">;</span></span>
<span id="cb956-6"><a href="going-further-reactR.html#cb956-6"></a><span class="op">}</span></span>
<span id="cb956-7"><a href="going-further-reactR.html#cb956-7"></a></span>
<span id="cb956-8"><a href="going-further-reactR.html#cb956-8"></a><span class="co">// OR</span></span>
<span id="cb956-9"><a href="going-further-reactR.html#cb956-9"></a></span>
<span id="cb956-10"><a href="going-further-reactR.html#cb956-10"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb956-11"><a href="going-further-reactR.html#cb956-11"></a>  <span class="kw">const</span> name <span class="op">=</span> <span class="st">"David"</span><span class="op">;</span></span>
<span id="cb956-12"><a href="going-further-reactR.html#cb956-12"></a>  <span class="kw">const</span> myStyle <span class="op">=</span> <span class="op">{</span></span>
<span id="cb956-13"><a href="going-further-reactR.html#cb956-13"></a>    <span class="dt">color</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span> </span>
<span id="cb956-14"><a href="going-further-reactR.html#cb956-14"></a>    <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">40</span></span>
<span id="cb956-15"><a href="going-further-reactR.html#cb956-15"></a>  <span class="op">}</span></span>
<span id="cb956-16"><a href="going-further-reactR.html#cb956-16"></a>  <span class="cf">return</span> (</span>
<span id="cb956-17"><a href="going-further-reactR.html#cb956-17"></a>    <span class="kw">&lt;h1</span> <span class="ot">style</span><span class="op">=</span><span class="va">{</span>myStyle<span class="va">}</span><span class="kw">&gt;</span>Hello, <span class="va">{</span>name<span class="va">}</span><span class="kw">&lt;/h1&gt;</span></span>
<span id="cb956-18"><a href="going-further-reactR.html#cb956-18"></a>  )<span class="op">;</span></span>
<span id="cb956-19"><a href="going-further-reactR.html#cb956-19"></a><span class="op">}</span></span></code></pre></div>
<p>Notice that we write CSS properties following the <strong>camelCase</strong> syntax, <code>font-size</code> being equivalent to <code>fontSize</code>.</p>
</div>
<div id="react-map" class="section level4">
<h4>
<span class="header-section-number">27.1.2.2</span> Combining components<a class="anchor" aria-label="anchor" href="#react-map"><i class="fas fa-link"></i></a>
</h4>
<p>The whole interest is to combine multiple components to create reusable pieces. We edit the above code
to create a <code>SayHello</code> component. Notice the <strong>props</strong> parameter. It is a way to pass configuration from the parent component. In that case, we want to display the person name, that is <code>props.name</code>. In the meantime, we edit the <code>App</code> parent component and call <code>SayHello</code> three times, passing a different name like <code>&lt;SayHello name="David" /&gt;</code> (this is the reason why we recover <code>props.name</code> in the lower level component):</p>
<div class="sourceCode" id="cb957"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb957-1"><a href="going-further-reactR.html#cb957-1"></a><span class="kw">function</span> <span class="at">SayHello</span>(props) <span class="op">{</span></span>
<span id="cb957-2"><a href="going-further-reactR.html#cb957-2"></a>  <span class="cf">return</span> (</span>
<span id="cb957-3"><a href="going-further-reactR.html#cb957-3"></a>    <span class="kw">&lt;h1&gt;</span>Hello, <span class="va">{props</span>.<span class="at">name</span><span class="va">}</span><span class="kw">&lt;/h1&gt;</span></span>
<span id="cb957-4"><a href="going-further-reactR.html#cb957-4"></a>  )<span class="op">;</span></span>
<span id="cb957-5"><a href="going-further-reactR.html#cb957-5"></a><span class="op">}</span></span>
<span id="cb957-6"><a href="going-further-reactR.html#cb957-6"></a></span>
<span id="cb957-7"><a href="going-further-reactR.html#cb957-7"></a></span>
<span id="cb957-8"><a href="going-further-reactR.html#cb957-8"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb957-9"><a href="going-further-reactR.html#cb957-9"></a>  <span class="cf">return</span>(</span>
<span id="cb957-10"><a href="going-further-reactR.html#cb957-10"></a>  <span class="kw">&lt;&gt;</span></span>
<span id="cb957-11"><a href="going-further-reactR.html#cb957-11"></a>    <span class="fu">&lt;SayHello</span> <span class="ot">name</span><span class="op">=</span><span class="st">"David"</span> <span class="fu">/&gt;</span></span>
<span id="cb957-12"><a href="going-further-reactR.html#cb957-12"></a>    <span class="fu">&lt;SayHello</span> <span class="ot">name</span><span class="op">=</span><span class="st">"Lisa"</span> <span class="fu">/&gt;</span></span>
<span id="cb957-13"><a href="going-further-reactR.html#cb957-13"></a>    <span class="fu">&lt;SayHello</span> <span class="ot">name</span><span class="op">=</span><span class="st">"Simon"</span> <span class="fu">/&gt;</span></span>
<span id="cb957-14"><a href="going-further-reactR.html#cb957-14"></a>  <span class="kw">&lt;/&gt;</span></span>
<span id="cb957-15"><a href="going-further-reactR.html#cb957-15"></a>  )<span class="op">;</span></span>
<span id="cb957-16"><a href="going-further-reactR.html#cb957-16"></a><span class="op">}</span></span></code></pre></div>
<div class="noteblock">
<p>Notice the enclosing <code>&lt;&gt;...&lt;/&gt;</code>. This is called a React <strong>fragment</strong> and useful if we don’t want to
insert any extra <code>&lt;div&gt;</code> in the DOM.</p>
</div>
<p>We could be even more efficient by leveraging the lists capabilities. We create an array
of names and apply the <code>map</code> method to return the corresponding <code>&lt;SayHello /&gt;</code> sub-component:</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb958-1"><a href="going-further-reactR.html#cb958-1"></a><span class="kw">const</span> names <span class="op">=</span> [<span class="st">"David"</span><span class="op">,</span> <span class="st">"Lisa"</span><span class="op">,</span> <span class="st">"Simon"</span>]<span class="op">;</span></span>
<span id="cb958-2"><a href="going-further-reactR.html#cb958-2"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb958-3"><a href="going-further-reactR.html#cb958-3"></a>  <span class="kw">const</span> sayHelloToAll <span class="op">=</span> <span class="va">names</span>.<span class="at">map</span>(</span>
<span id="cb958-4"><a href="going-further-reactR.html#cb958-4"></a>    (name) <span class="kw">=&gt; </span><span class="fu">&lt;SayHello</span> <span class="ot">key</span><span class="op">=</span><span class="va">{</span>name<span class="va">}</span> <span class="ot">name</span><span class="op">=</span><span class="va">{</span>name<span class="va">}</span> <span class="fu">/&gt;</span></span>
<span id="cb958-5"><a href="going-further-reactR.html#cb958-5"></a>  )<span class="op">;</span> </span>
<span id="cb958-6"><a href="going-further-reactR.html#cb958-6"></a>  <span class="cf">return</span>(sayHelloToAll)<span class="op">;</span></span>
<span id="cb958-7"><a href="going-further-reactR.html#cb958-7"></a><span class="op">}</span></span></code></pre></div>
<div class="warningblock">
<p>By convention, all elements inside a <code>map</code> require <strong>keys</strong>.</p>
</div>
<p><strong>Props</strong> are <strong>read-only</strong> and must not be modified withing their own component.
How do we update components then?</p>
</div>
<div id="react-hooks" class="section level4">
<h4>
<span class="header-section-number">27.1.2.3</span> Component state<a class="anchor" aria-label="anchor" href="#react-hooks"><i class="fas fa-link"></i></a>
</h4>
<p>A component <strong>state</strong> is private and controlled by this same component. Since React 16.8 and the introduction of <strong>hooks</strong>, this is not necessary to convert the component function to a <a href="https://reactjs.org/docs/components-and-props.html#function-and-class-components">class</a>.
The easiest example to illustrate hooks capabilities is the button. Each time, we click on a button,
we want to keep the current number of clicks in a state, like the <code><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton()</a></code>. We start by
importing the <code>useState</code> function from <code>react</code> and create a new <code>ActionButton</code> component.
Inside, we set the state with <code>useState</code> that create the state variable <code>count</code> as well as the function to update it, namely <code>setCount</code>. This way to create two variables at once is called array <strong>destructuring</strong>. We set the initial number of counts to 0:</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb959-1"><a href="going-further-reactR.html#cb959-1"></a><span class="im">import</span> <span class="op">{</span>useState<span class="op">}</span> <span class="im">from</span> <span class="st">'react'</span><span class="op">;</span></span>
<span id="cb959-2"><a href="going-further-reactR.html#cb959-2"></a></span>
<span id="cb959-3"><a href="going-further-reactR.html#cb959-3"></a><span class="kw">function</span> <span class="at">ActionButton</span>() <span class="op">{</span></span>
<span id="cb959-4"><a href="going-further-reactR.html#cb959-4"></a>  <span class="kw">const</span> [count<span class="op">,</span> setCount] <span class="op">=</span> <span class="at">useState</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb959-5"><a href="going-further-reactR.html#cb959-5"></a><span class="op">}</span></span></code></pre></div>
<p>Next step is to create the button skeleton. We provide an <code>onClick</code> property that updates
the button state. Inside, we write an anonymous function which calls <code>setCount</code> and increments
the count value by 1. At this point, you may replace the <code>app.js</code> content by:</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb960-1"><a href="going-further-reactR.html#cb960-1"></a><span class="im">import</span> <span class="op">{</span>useState<span class="op">}</span> <span class="im">from</span> <span class="st">'react'</span><span class="op">;</span></span>
<span id="cb960-2"><a href="going-further-reactR.html#cb960-2"></a></span>
<span id="cb960-3"><a href="going-further-reactR.html#cb960-3"></a><span class="kw">function</span> <span class="at">ActionButton</span>() <span class="op">{</span></span>
<span id="cb960-4"><a href="going-further-reactR.html#cb960-4"></a>  <span class="kw">const</span> [count<span class="op">,</span> setCount] <span class="op">=</span> <span class="at">useState</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb960-5"><a href="going-further-reactR.html#cb960-5"></a>  <span class="cf">return</span>(</span>
<span id="cb960-6"><a href="going-further-reactR.html#cb960-6"></a>    <span class="kw">&lt;button</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setCount</span>(count <span class="op">+</span> <span class="dv">1</span>)<span class="va">}</span><span class="kw">&gt;</span></span>
<span id="cb960-7"><a href="going-further-reactR.html#cb960-7"></a>      Number of clicks: <span class="va">{</span>count<span class="va">}</span></span>
<span id="cb960-8"><a href="going-further-reactR.html#cb960-8"></a>    <span class="kw">&lt;/button</span> <span class="kw">&gt;</span></span>
<span id="cb960-9"><a href="going-further-reactR.html#cb960-9"></a>  )<span class="op">;</span></span>
<span id="cb960-10"><a href="going-further-reactR.html#cb960-10"></a><span class="op">}</span></span>
<span id="cb960-11"><a href="going-further-reactR.html#cb960-11"></a></span>
<span id="cb960-12"><a href="going-further-reactR.html#cb960-12"></a><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></span>
<span id="cb960-13"><a href="going-further-reactR.html#cb960-13"></a>  <span class="cf">return</span> (</span>
<span id="cb960-14"><a href="going-further-reactR.html#cb960-14"></a>    <span class="fu">&lt;ActionButton</span> <span class="fu">/&gt;</span></span>
<span id="cb960-15"><a href="going-further-reactR.html#cb960-15"></a>  )<span class="op">;</span></span>
<span id="cb960-16"><a href="going-further-reactR.html#cb960-16"></a><span class="op">}</span></span>
<span id="cb960-17"><a href="going-further-reactR.html#cb960-17"></a></span>
<span id="cb960-18"><a href="going-further-reactR.html#cb960-18"></a><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></span></code></pre></div>
<p>We may improve the previous app and add a reset button within the <code>ActionButton</code> component that
sets the count back to 0:</p>
<div class="sourceCode" id="cb961"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb961-1"><a href="going-further-reactR.html#cb961-1"></a><span class="kw">function</span> <span class="at">ActionButton</span>() <span class="op">{</span></span>
<span id="cb961-2"><a href="going-further-reactR.html#cb961-2"></a>  <span class="kw">const</span> [count<span class="op">,</span> setCount] <span class="op">=</span> <span class="at">useState</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb961-3"><a href="going-further-reactR.html#cb961-3"></a>  <span class="cf">return</span>(</span>
<span id="cb961-4"><a href="going-further-reactR.html#cb961-4"></a>    <span class="kw">&lt;&gt;</span></span>
<span id="cb961-5"><a href="going-further-reactR.html#cb961-5"></a>    <span class="kw">&lt;button</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setCount</span>(count <span class="op">+</span> <span class="dv">1</span>)<span class="va">}</span><span class="kw">&gt;</span></span>
<span id="cb961-6"><a href="going-further-reactR.html#cb961-6"></a>      Number of clicks: <span class="va">{</span>count<span class="va">}</span></span>
<span id="cb961-7"><a href="going-further-reactR.html#cb961-7"></a>    <span class="kw">&lt;/button</span> <span class="kw">&gt;</span></span>
<span id="cb961-8"><a href="going-further-reactR.html#cb961-8"></a>    <span class="kw">&lt;button</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setCount</span>(<span class="dv">0</span>)<span class="va">}</span><span class="kw">&gt;</span></span>
<span id="cb961-9"><a href="going-further-reactR.html#cb961-9"></a>      Reset</span>
<span id="cb961-10"><a href="going-further-reactR.html#cb961-10"></a>    <span class="kw">&lt;/button</span> <span class="kw">&gt;</span></span>
<span id="cb961-11"><a href="going-further-reactR.html#cb961-11"></a>    <span class="kw">&lt;/&gt;</span></span>
<span id="cb961-12"><a href="going-further-reactR.html#cb961-12"></a>  )<span class="op">;</span></span>
<span id="cb961-13"><a href="going-further-reactR.html#cb961-13"></a><span class="op">}</span></span></code></pre></div>
<p>It would make more sense to only show the reset button once the button has been clicked,
at least once. We define the <code>isResetVisible</code> variable which is <code>true</code> whenever the
count is higher than 0 and <code>false</code> if the count is 0, leveraging the JS <strong>ternary</strong> operator. We store the reset button in a variable and only return something if <code>isResetVisible</code> is <code>true</code>:</p>
<div class="sourceCode" id="cb962"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb962-1"><a href="going-further-reactR.html#cb962-1"></a><span class="kw">function</span> <span class="at">ActionButton</span>() <span class="op">{</span></span>
<span id="cb962-2"><a href="going-further-reactR.html#cb962-2"></a>  <span class="kw">const</span> [count<span class="op">,</span> setCount] <span class="op">=</span> <span class="at">useState</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb962-3"><a href="going-further-reactR.html#cb962-3"></a>  <span class="kw">const</span> isResetVisible <span class="op">=</span> count <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dt">true </span><span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb962-4"><a href="going-further-reactR.html#cb962-4"></a>  <span class="kw">let</span> resetButton<span class="op">;</span></span>
<span id="cb962-5"><a href="going-further-reactR.html#cb962-5"></a>  <span class="cf">if</span> (isResetVisible) <span class="op">{</span></span>
<span id="cb962-6"><a href="going-further-reactR.html#cb962-6"></a>    resetButton <span class="op">= </span><span class="kw">&lt;button</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setCount</span>(<span class="dv">0</span>)<span class="va">}</span><span class="kw">&gt;</span></span>
<span id="cb962-7"><a href="going-further-reactR.html#cb962-7"></a>      Reset</span>
<span id="cb962-8"><a href="going-further-reactR.html#cb962-8"></a>    <span class="kw">&lt;/button</span> <span class="kw">&gt;</span></span>
<span id="cb962-9"><a href="going-further-reactR.html#cb962-9"></a>  <span class="op">}</span></span>
<span id="cb962-10"><a href="going-further-reactR.html#cb962-10"></a>  <span class="cf">return</span> (</span>
<span id="cb962-11"><a href="going-further-reactR.html#cb962-11"></a>    <span class="kw">&lt;&gt;</span></span>
<span id="cb962-12"><a href="going-further-reactR.html#cb962-12"></a>      <span class="kw">&lt;button</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setCount</span>(count <span class="op">+</span> <span class="dv">1</span>)<span class="va">}</span><span class="kw">&gt;</span></span>
<span id="cb962-13"><a href="going-further-reactR.html#cb962-13"></a>        Number of clicks: <span class="va">{</span>count<span class="va">}</span></span>
<span id="cb962-14"><a href="going-further-reactR.html#cb962-14"></a>      <span class="kw">&lt;/button</span> <span class="kw">&gt;</span></span>
<span id="cb962-15"><a href="going-further-reactR.html#cb962-15"></a>      <span class="va">{</span>resetButton<span class="va">}</span></span>
<span id="cb962-16"><a href="going-further-reactR.html#cb962-16"></a>    <span class="kw">&lt;/&gt;</span></span>
<span id="cb962-17"><a href="going-further-reactR.html#cb962-17"></a>  )<span class="op">;</span></span>
<span id="cb962-18"><a href="going-further-reactR.html#cb962-18"></a><span class="op">}</span></span></code></pre></div>
<p>That’s all folks! Now that you get a better understanding of how React works,
let’s see how to use it with Shiny.</p>
</div>
</div>
</div>
<div id="introduction-to-reactr" class="section level2">
<h2>
<span class="header-section-number">27.2</span> Introduction to <code>{reactR}</code><a class="anchor" aria-label="anchor" href="#introduction-to-reactr"><i class="fas fa-link"></i></a>
</h2>
<div class="importantblock">
<p>This section has been written and tested with <a href="https://github.com/react-R/reactR">reactR</a> <code>0.4.4</code>.
Some feature may change in future releases.</p>
</div>
<p>The React ecosystem is rich and provides many plug and play boilerplate. For instance,
<a href="https://glin.github.io/reactable/">reactable</a> is an HTML widget developed on top of the <a href="https://github.com/tannerlinsley/react-table"><code>react-table</code></a> library. What about the modern React Argon design <a href="https://demos.creative-tim.com/argon-design-system-react/?_ga=2.179634850.760978196.1612189904-282783983.1612189904#/">system</a>, shown Figure <a href="going-further-reactR.html#fig:argon-design-react">27.2</a>?</p>
<div class="figure">
<span id="fig:argon-design-react"></span>
<img src="images/going-further/argon-design-react.png" alt="Argon design template with React" width="100%"><p class="caption">
FIGURE 27.2: Argon design template with React
</p>
</div>
<p>In this part, we see how to leverage <a href="https://github.com/react-R/reactR">reactR</a> <span class="citation">(Inc et al. <a href="references.html#ref-R-reactR" role="doc-biblioref">2021</a>)</span> to bring few component from the <code>reactstrap</code> <a href="https://reactstrap.github.io/">library</a> to Shiny.</p>
<p>To install <a href="https://github.com/react-R/reactR">reactR</a>:</p>
<div class="sourceCode" id="cb963"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># stable from CRAN</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"reactR"</span><span class="op">)</span>

<span class="co"># lastest from GitHub</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"react-R/reactR"</span><span class="op">)</span></code></pre></div>
<p>In the following, we are going to propose an implementation of the <code>reactstrap</code> button, which is a Bootstrap 4 and React powered action button.</p>
<div id="setup-2" class="section level3">
<h3>
<span class="header-section-number">27.2.1</span> Setup<a class="anchor" aria-label="anchor" href="#setup-2"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://github.com/react-R/reactR">reactR</a> exposes the <code>scaffoldReactShinyInput()</code> that sets the necessary pieces of code
to get started with the input development (see Figure <a href="going-further-reactR.html#fig:reactR-init-input">27.3</a>):</p>
<ul>
<li>An <code>&lt;input_name&gt;.R</code> file containing the input skeleton as well as its related update function, located in the <code>./R</code> folder.
It also creates a custom HTML dependency pointing to the input JS logic.</li>
<li>A <code>jsx</code> file with a boilerplate to start developing the input JS logic, located in the <code>./srcjs</code> folder.</li>
<li>A <code>package.json</code> file containing dependencies.</li>
<li>An <code>app.R</code> file to host the input demonstration code.</li>
<li>A <code>webpack.config.js</code> file (discussed later).</li>
<li>Classic R package files like <code>DESCRIPTION</code>, <code>.Rbuildignore</code>…
Interestingly, the <code>.Rbuildignore</code>contains few lines to ignore non standard files and
folders like <code>srcjs</code> and <code>package.json</code>.</li>
</ul>
<p>Besides, providing an optional dependency with a name and version taken from <strong>npm</strong> installs all necessary dependencies in the <code>package.json</code> file:</p>
<div class="sourceCode" id="cb964"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"reactstrapTest"</span><span class="op">)</span>
<span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_package.html">create_package</a></span><span class="op">(</span><span class="va">path</span>, rstudio <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Wait new project to be created before running </span>
<span class="co"># the following!!!</span>
<span class="fu">reactR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reactR/man/scaffoldReactShinyInput.html">scaffoldReactShinyInput</a></span><span class="op">(</span>
  <span class="st">"action_button"</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">"reactstrap"</span> <span class="op">=</span> <span class="st">"^8.9.0"</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure">
<span id="fig:reactR-init-input"></span>
<img src="images/going-further/reactR-init-input.png" alt="Package initialization with {reactR}" width="100%"><p class="caption">
FIGURE 27.3: Package initialization with {reactR}
</p>
</div>
<p>Note that <a href="https://github.com/react-R/reactR">reactR</a> provides <strong>webpack</strong> as JS manager. To <strong>build</strong> the JS code we go to the RStudio terminal tab (or any terminal) and run at the package root:</p>
<pre><code>yarn install
yarn run webpack --mode=development</code></pre>
<p>This installs all dependencies listed in the <code>package.json</code> file and create a <code>package-lock.json</code> file. If you ever used <a href="https://rstudio.github.io/renv">renv</a>, this is very similar and guarantees isolation of your package. All dependencies are stored in the <code>node_modules</code> folder.</p>
<p>The <code>run webpack</code> command compiles the JS in production ready code. Should you need to customize the build pipeline, the webpack configuration is located in <code>webpack.config.js</code>. On the R side, the generated JS file is referenced in an HTML dependencies, located in the <code>&lt;input_name&gt;.R</code> file.
If you specify the <code>--mode=development</code> tag, it falls back to development code.</p>
<p>In the following, we see how to customize the newly created component.</p>
</div>
<div id="customize-the-r-logic" class="section level3">
<h3>
<span class="header-section-number">27.2.2</span> Customize the R logic<a class="anchor" aria-label="anchor" href="#customize-the-r-logic"><i class="fas fa-link"></i></a>
</h3>
<p>A <a href="https://github.com/react-R/reactR">reactR</a> input is composed of R and JS code that both exchange information. Upon initialization, we obtained a <code>.R/action_button.R</code> code:</p>
<div class="sourceCode" id="cb966"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">action_buttonInput</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">default</span> <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">reactR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reactR/man/createReactShinyInput.html">createReactShinyInput</a></span><span class="op">(</span>
    <span class="va">inputId</span>,
    <span class="st">"action_button"</span>,
    <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlDependency.html">htmlDependency</a></span><span class="op">(</span>
      name <span class="op">=</span> <span class="st">"action_button-input"</span>,
      version <span class="op">=</span> <span class="st">"1.0.0"</span>,
      src <span class="op">=</span> <span class="st">"www/reactstrapTest/action_button"</span>,
      package <span class="op">=</span> <span class="st">"reactstrapTest"</span>,
      script <span class="op">=</span> <span class="st">"action_button.js"</span>
    <span class="op">)</span>,
    <span class="va">default</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="fu">htmltools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">tags</a></span><span class="op">$</span><span class="va">span</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>For convenience, we remove the input suffix to name it <code>action_button</code>.
Overall, this function calls <code><a href="https://rdrr.io/pkg/reactR/man/createReactShinyInput.html">reactR::createReactShinyInput()</a></code> that:
- Give the widget a class and id. The class is targeted on the JS side (see <a href="going-further-reactR.html#reactR-jsx-logic">27.2.3</a>) and is necessary to make it working.
- Sets all necessary dependencies (React, …) as well as the internal JS code (see <a href="going-further-reactR.html#reactR-jsx-logic">27.2.3</a>).
- Creates the input HTML code with <a href="https://github.com/rstudio/htmltools">htmltools</a>.
- Sets the default value, through the <code>default</code> parameter.
- Allow to pass a list of options inside the <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> container. By default,
nothing is sent but we will use it very soon.</p>
<p>We also have the corresponding update input function, which we renamed to <code><a href="https://rdrr.io/pkg/reactstrapTest/man/update_action_button.html">update_action_button()</a></code> for consistency:</p>
<div class="sourceCode" id="cb967"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">update_action_button</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">session</span>, <span class="va">inputId</span>, <span class="va">value</span>, <span class="va">configuration</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">message</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">value</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">configuration</span><span class="op">)</span><span class="op">)</span> <span class="va">message</span><span class="op">$</span><span class="va">configuration</span> <span class="op">&lt;-</span> <span class="va">configuration</span>
  <span class="va">session</span><span class="op">$</span><span class="fu">sendInputMessage</span><span class="op">(</span><span class="va">inputId</span>, <span class="va">message</span><span class="op">)</span>;
<span class="op">}</span></code></pre></div>
<p>In Shiny, the end-user cannot decide what is the initial value of an action button. It is always set to 0 by default. Therefore, we decided to remove the default parameter from <code><a href="https://rdrr.io/pkg/reactstrapTest/man/action_button.html">action_button()</a></code> and make it 0 by default.
In order to add a label and change the button color, we introduce two extra parameters and
add them the the configuration list:</p>
<div class="sourceCode" id="cb968"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">action_button</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
  <span class="va">inputId</span>,
  <span class="va">label</span>,
  <span class="va">status</span> <span class="op">=</span> <span class="st">"primary"</span>
<span class="op">)</span> <span class="op">{</span>
  <span class="fu">reactR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reactR/man/createReactShinyInput.html">createReactShinyInput</a></span><span class="op">(</span>
    <span class="va">inputId</span>,
    <span class="st">"action_button"</span>,
    <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlDependency.html">htmlDependency</a></span><span class="op">(</span>
      name <span class="op">=</span> <span class="st">"action_button-input"</span>,
      version <span class="op">=</span> <span class="st">"1.0.0"</span>,
      src <span class="op">=</span> <span class="st">"www/reactstrapTest"</span>,
      package <span class="op">=</span> <span class="st">"reactstrapTest"</span>,
      script <span class="op">=</span> <span class="st">"action_button.js"</span>
    <span class="op">)</span>,
    default <span class="op">=</span> <span class="fl">0</span>,
    configuration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      label <span class="op">=</span> <span class="va">label</span>,
      status <span class="op">=</span> <span class="va">status</span>
    <span class="op">)</span>,
    <span class="fu">htmltools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">tags</a></span><span class="op">$</span><span class="va">div</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Let’s see below how to make this interactice with some JSX code!</p>
</div>
<div id="reactR-jsx-logic" class="section level3">
<h3>
<span class="header-section-number">27.2.3</span> Implement the JS logic<a class="anchor" aria-label="anchor" href="#reactR-jsx-logic"><i class="fas fa-link"></i></a>
</h3>
<p>It’s time to develop the logic. For now, the <code>action_button.jsx</code> file only contains a placeholder generated by <a href="https://github.com/react-R/reactR">reactR</a>. The reactstrap documentation provides a <a href="https://reactstrap.github.io/components/buttons/">boilerplate</a>, which we slightly modified, according to the <a href="https://github.com/react-R/reactR">reactR</a> documentation:</p>
<div class="sourceCode" id="cb969"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb969-1"><a href="going-further-reactR.html#cb969-1"></a><span class="im">import</span> <span class="op">{</span> reactShinyInput <span class="op">}</span> <span class="im">from</span> <span class="st">'reactR'</span><span class="op">;</span></span>
<span id="cb969-2"><a href="going-further-reactR.html#cb969-2"></a><span class="im">import</span> <span class="op">{</span> Button <span class="op">}</span> <span class="im">from</span> <span class="st">'reactstrap'</span><span class="op">;</span></span>
<span id="cb969-3"><a href="going-further-reactR.html#cb969-3"></a></span>
<span id="cb969-4"><a href="going-further-reactR.html#cb969-4"></a><span class="kw">function</span> <span class="at">ActionButton</span>() <span class="op">{</span></span>
<span id="cb969-5"><a href="going-further-reactR.html#cb969-5"></a>  <span class="cf">return</span> (</span>
<span id="cb969-6"><a href="going-further-reactR.html#cb969-6"></a>    <span class="fu">&lt;Button</span></span>
<span id="cb969-7"><a href="going-further-reactR.html#cb969-7"></a>      <span class="ot">color</span><span class="op">=</span><span class="st">"primary"</span><span class="fu">&gt;</span></span>
<span id="cb969-8"><a href="going-further-reactR.html#cb969-8"></a>    <span class="fu">&lt;/Button&gt;</span></span>
<span id="cb969-9"><a href="going-further-reactR.html#cb969-9"></a>  )<span class="op">;</span></span>
<span id="cb969-10"><a href="going-further-reactR.html#cb969-10"></a><span class="op">}</span></span>
<span id="cb969-11"><a href="going-further-reactR.html#cb969-11"></a></span>
<span id="cb969-12"><a href="going-further-reactR.html#cb969-12"></a><span class="at">reactShinyInput</span>(</span>
<span id="cb969-13"><a href="going-further-reactR.html#cb969-13"></a>  <span class="st">'.action_button'</span><span class="op">,</span></span>
<span id="cb969-14"><a href="going-further-reactR.html#cb969-14"></a>  <span class="st">'reactstrapTest.action_button'</span><span class="op">,</span></span>
<span id="cb969-15"><a href="going-further-reactR.html#cb969-15"></a>  ActionButton</span>
<span id="cb969-16"><a href="going-further-reactR.html#cb969-16"></a>)<span class="op">;</span></span></code></pre></div>
<p>As you can see, we need to import the <code>Button</code> component from <code>reactstrap</code> as well as
the <code>reactShinyInput</code> function from the <a href="https://github.com/react-R/reactR">reactR</a> package. To generate our JS code, we recompile with <code>yarn run webpack</code>, document and reload the package functions:</p>
<div class="sourceCode" id="cb970"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/document.html">document</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>In the <code>./app.R</code> script, we have to tell Shiny we want to use Bootstrap 4 instead of Bootstrap 3, through the <code><a href="https://rstudio.github.io/bslib/reference/bs_theme.html">bslib::bs_theme</a></code> function. Erase the existing code and replace it by the following:</p>
<div class="sourceCode" id="cb971"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">reactstrapTest</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
  theme <span class="op">=</span> <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html">bs_theme</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/action_button.html">action_button</a></span><span class="op">(</span><span class="st">"plop"</span>, <span class="st">"Click me!"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html">observe</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">plop</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>As you can see Figure <a href="going-further-reactR.html#fig:react-action-button-basic">27.4</a>, the button label is not displayed nor its value.
This is because we missed to leverage the component arguments that are <code>configuration</code>, <code>value</code>, <code>setValue</code>, making the link between R and JS.</p>
<div class="figure">
<span id="fig:react-action-button-basic"></span>
<img src="images/going-further/react-action-button-basic.png" alt="Work in progress action button with React" width="100%"><p class="caption">
FIGURE 27.4: Work in progress action button with React
</p>
</div>
</div>
<div id="improve-the-js-logic" class="section level3">
<h3>
<span class="header-section-number">27.2.4</span> Improve the JS logic<a class="anchor" aria-label="anchor" href="#improve-the-js-logic"><i class="fas fa-link"></i></a>
</h3>
<p>We modify the <code>action_button.jsx</code> code to add those three parameters to the <code>ActionButton</code> component:</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb972-1"><a href="going-further-reactR.html#cb972-1"></a><span class="kw">function</span> <span class="at">ActionButton</span>(<span class="op">{</span> configuration<span class="op">,</span> value<span class="op">,</span> setValue <span class="op">}</span>) <span class="op">{</span></span>
<span id="cb972-2"><a href="going-further-reactR.html#cb972-2"></a>  <span class="cf">return</span> (</span>
<span id="cb972-3"><a href="going-further-reactR.html#cb972-3"></a>    <span class="fu">&lt;Button</span></span>
<span id="cb972-4"><a href="going-further-reactR.html#cb972-4"></a>      <span class="ot">color</span><span class="op">=</span><span class="va">{configuration</span>.<span class="at">status</span><span class="va">}</span></span>
<span id="cb972-5"><a href="going-further-reactR.html#cb972-5"></a>      <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setValue</span>(value <span class="op">+</span> <span class="dv">1</span>)<span class="va">}</span><span class="fu">&gt;</span></span>
<span id="cb972-6"><a href="going-further-reactR.html#cb972-6"></a>      <span class="va">{configuration</span>.<span class="at">label</span><span class="va">}</span></span>
<span id="cb972-7"><a href="going-further-reactR.html#cb972-7"></a>    <span class="fu">&lt;/Button&gt;</span></span>
<span id="cb972-8"><a href="going-further-reactR.html#cb972-8"></a>  )<span class="op">;</span></span>
<span id="cb972-9"><a href="going-further-reactR.html#cb972-9"></a><span class="op">}</span></span></code></pre></div>
<p>Remember that <code>configuration</code> is an R list and sent to JS as a JSON object with <code><a href="https://rdrr.io/pkg/reactR/man/createReactShinyInput.html">reactR::createReactShinyInput()</a></code>. On the JS side, we access its properties with <code>configuration.&lt;PROPERTY&gt;</code>. <code>value</code> is the current button value, which is 0 when the app is started.</p>
<p>How do we set handle the value change upon click? Well, this is pretty straightforward. The <code>Button</code> element has an <code>onClick</code> <a href="https://reactstrap.github.io/components/buttons/">property</a> inside which we can pass the <code>setValue</code> function and increment it by 1 (<code>setValue</code> is an internal hook, see <a href="going-further-reactR.html#react-hooks">27.1.2.3</a>).</p>
<p>In the below example, we update a button from the server side with <code><a href="https://rdrr.io/pkg/reactstrapTest/man/update_action_button.html">update_action_button()</a></code>:</p>
<div class="sourceCode" id="cb973"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
  theme <span class="op">=</span> <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html">bs_theme</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidRow</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/action_button.html">action_button</a></span><span class="op">(</span><span class="st">"plop"</span>, <span class="st">"Click me!"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/action_button.html">action_button</a></span><span class="op">(</span><span class="st">"update"</span>, <span class="st">"Update button 1"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html">observe</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">plop</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/update_action_button.html">update_action_button</a></span><span class="op">(</span>
      <span class="va">session</span>, <span class="st">"plop"</span>, 
      configuration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        label <span class="op">=</span> <span class="st">"New text"</span>, 
        status <span class="op">=</span> <span class="st">"success"</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span>, ignoreInit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>Clicking on the first button should increment its value in the R console. You may play around
by changing the default color. After clicking on the second button, you should get the result shown Figure <a href="going-further-reactR.html#fig:react-action-button">27.5</a>.</p>
<div class="figure">
<span id="fig:react-action-button"></span>
<img src="images/going-further/react-action-button.png" alt="Fully working React powered action button" width="100%"><p class="caption">
FIGURE 27.5: Fully working React powered action button
</p>
</div>
</div>
<div id="exercise-1-1" class="section level3">
<h3>
<span class="header-section-number">27.2.5</span> Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1-1"><i class="fas fa-link"></i></a>
</h3>
<p>Based on the previous example and the <code>reactstrap</code> documentation, improve the action button component.
1. Add it a <code>size</code> style parameter.
2. Add it a <code>disabled</code> parameter.
3. Add it an <code>outline</code> style parameter.</p>
</div>
<div id="technical-considerations" class="section level3">
<h3>
<span class="header-section-number">27.2.6</span> Technical considerations<a class="anchor" aria-label="anchor" href="#technical-considerations"><i class="fas fa-link"></i></a>
</h3>
<p><code>reactShinyInput</code> provides a wrapper to automatically <strong>bind</strong> the input element. This is extremely convenient as it allows to solely focus on the component logic rather than binding it to the shiny system. It takes three parameters:</p>
<ul>
<li>The <strong>element</strong> class which is obtained from the R side by <code>createReactShinyInput()</code>.</li>
<li>The <strong>input binding</strong> name which is useful to store a reference in the <code>Shiny.InputBindings</code> registry. Recent version of <a href="https://github.com/react-R/reactR">reactR</a> use <code>&lt;PACKAGE_NAME&gt;.&lt;INPUT_NAME&gt;</code> as convention, which avoids conflicts between inputs belonging to two different packages.</li>
<li>The React <strong>component</strong> function.</li>
<li>There is an optional fourth parameter allowing to pass custom <strong>options</strong> like
rate <a href="https://github.com/react-R/reactR/blob/7dccb68a0989cf642d4a5a3eb90b59d1ae773002/srcjs/input.js#L137">policies</a>.</li>
</ul>
<p>Overall, <a href="https://github.com/react-R/reactR/blob/7dccb68a0989cf642d4a5a3eb90b59d1ae773002/srcjs/input.js#L72"><code>reactShinyInput</code></a> extends the <code>Shiny.InputBinding</code> class by providing extra methods like:</p>
<div class="sourceCode" id="cb974"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb974-1"><a href="going-further-reactR.html#cb974-1"></a><span class="at">getInputConfiguration</span>(el) <span class="op">{</span></span>
<span id="cb974-2"><a href="going-further-reactR.html#cb974-2"></a>  <span class="cf">return</span> <span class="at">$</span>(el).<span class="at">data</span>(<span class="st">'configuration'</span>)<span class="op">;</span></span>
<span id="cb974-3"><a href="going-further-reactR.html#cb974-3"></a><span class="op">}</span></span>
<span id="cb974-4"><a href="going-further-reactR.html#cb974-4"></a><span class="at">setInputConfiguration</span>(el<span class="op">,</span> configuration) <span class="op">{</span></span>
<span id="cb974-5"><a href="going-further-reactR.html#cb974-5"></a>  <span class="at">$</span>(el).<span class="at">data</span>(<span class="st">'configuration'</span><span class="op">,</span> configuration)<span class="op">;</span></span>
<span id="cb974-6"><a href="going-further-reactR.html#cb974-6"></a><span class="op">}</span></span></code></pre></div>
<p><code>getInputConfiguration</code> and <code>setInputConfiguration</code>, respectively get and set the user provided configuration, passed in the <code>createReactShinyInput()</code> R side function. Under the hood (in addition to ship the <a href="https://github.com/react-R/reactR">reactR</a>, React, ReactTools HTML dependencies and any user defined custom dependencies), <code>createReactShinyInput()</code> generates three tag elements:</p>
<ul>
<li>The first tag is the element placeholder containing the unique <strong>id</strong>. React will insert
the component inside this target with <code>ReactDOM.render</code>.</li>
<li>The second tag is a script containing the <strong>value</strong> passed as <strong>JSON</strong>.</li>
<li>The second tag is a script containing the <strong>configuration</strong>, also passed as JSON.</li>
</ul>
<div class="sourceCode" id="cb975"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/">shiny</a></span><span class="op">)</span>
<span class="fu">reactR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reactR/man/createReactShinyInput.html">createReactShinyInput</a></span><span class="op">(</span>
  inputId <span class="op">=</span> <span class="st">"plop"</span>, 
  class <span class="op">=</span> <span class="st">"myinput"</span>, 
  dependencies <span class="op">=</span> <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/findDependencies.html">findDependencies</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/icon.html">icon</a></span><span class="op">(</span><span class="st">"bicycle"</span><span class="op">)</span><span class="op">)</span>, 
  default <span class="op">=</span> <span class="fl">0</span>, 
  configuration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span>, 
  container <span class="op">=</span> <span class="va">div</span>
<span class="op">)</span></code></pre></div>
<pre><code>#&gt; &lt;div id="plop" class="myinput"&gt;&lt;/div&gt;
#&gt; &lt;script id="plop_value" type="application/json"&gt;0&lt;/script&gt;
#&gt; &lt;script id="plop_configuration" type="application/json"&gt;{"a":1,"b":"test"}&lt;/script&gt;</code></pre>
<p>The configuration and values are processed in the <strong>initialize</strong> method since it is called before the input is bound:</p>
<div class="sourceCode" id="cb977"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb977-1"><a href="going-further-reactR.html#cb977-1"></a><span class="co">// Within reactR's initialize method...</span></span>
<span id="cb977-2"><a href="going-further-reactR.html#cb977-2"></a><span class="at">$</span>(el).<span class="at">data</span>(<span class="st">'value'</span><span class="op">,</span> <span class="va">JSON</span>.<span class="at">parse</span>(<span class="at">$</span>(el).<span class="at">next</span>().<span class="at">text</span>()))<span class="op">;</span></span>
<span id="cb977-3"><a href="going-further-reactR.html#cb977-3"></a><span class="at">$</span>(el).<span class="at">data</span>(</span>
<span id="cb977-4"><a href="going-further-reactR.html#cb977-4"></a>  <span class="st">'configuration'</span><span class="op">,</span> </span>
<span id="cb977-5"><a href="going-further-reactR.html#cb977-5"></a>  <span class="va">JSON</span>.<span class="at">parse</span>(<span class="at">$</span>(el).<span class="at">next</span>().<span class="at">next</span>().<span class="at">text</span>())</span>
<span id="cb977-6"><a href="going-further-reactR.html#cb977-6"></a>)<span class="op">;</span></span></code></pre></div>
<p>The configuration and values are stored in the corresponding data attributes. The most important part is the <strong>render</strong> method that creates the React element based upon its configuration and value and renders it in the DOM:</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb978-1"><a href="going-further-reactR.html#cb978-1"></a><span class="co">// reactR's render method</span></span>
<span id="cb978-2"><a href="going-further-reactR.html#cb978-2"></a><span class="at">render</span>(el) <span class="op">{</span></span>
<span id="cb978-3"><a href="going-further-reactR.html#cb978-3"></a>  <span class="kw">const</span> element <span class="op">=</span> <span class="va">React</span>.<span class="at">createElement</span>(component<span class="op">,</span> <span class="op">{</span></span>
<span id="cb978-4"><a href="going-further-reactR.html#cb978-4"></a>    <span class="dt">configuration</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">getInputConfiguration</span>(el)<span class="op">,</span></span>
<span id="cb978-5"><a href="going-further-reactR.html#cb978-5"></a>    <span class="dt">value</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">getValue</span>(el)<span class="op">,</span></span>
<span id="cb978-6"><a href="going-further-reactR.html#cb978-6"></a>    <span class="dt">setValue</span><span class="op">:</span> <span class="kw">this</span>.<span class="va">setValue</span>.<span class="at">bind</span>(<span class="kw">this</span><span class="op">,</span> el)<span class="op">,</span></span>
<span id="cb978-7"><a href="going-further-reactR.html#cb978-7"></a>    <span class="dt">el</span><span class="op">:</span> el</span>
<span id="cb978-8"><a href="going-further-reactR.html#cb978-8"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb978-9"><a href="going-further-reactR.html#cb978-9"></a>  <span class="va">ReactDOM</span>.<span class="at">render</span>(element<span class="op">,</span> el)<span class="op">;</span></span>
<span id="cb978-10"><a href="going-further-reactR.html#cb978-10"></a><span class="op">}</span></span></code></pre></div>
<p>The <code>render</code> method is called once inside <code>subscribe</code> and also each time the element is updated
with <code>receiveMessage</code>.</p>
</div>
<div id="exercise-2-1" class="section level3">
<h3>
<span class="header-section-number">27.2.7</span> Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Add an<code>icon</code> (from fontawesome) parameter to the <code>ActionButton</code> component.
Hint: You might find helpful to capture its HTML dependency with <code><a href="https://rdrr.io/pkg/htmltools/man/findDependencies.html">htmltools::findDependencies(iconTag)</a></code> so as to properly render it. In HTML <code><a href="https://rdrr.io/pkg/shiny/man/icon.html">icon("bicycle")</a></code> produces <code>&lt;i class="fa fa-bicycle" role="presentation" aria-label="bicycle icon"&gt;&lt;/i&gt;</code>. However, in React we want <code>&lt;i className="fa fa-bicycle /&gt;</code>. Therefore, you will have to extract the icon class and send it to JS in the configuration list.</li>
<li>Implement the logic on the JS side. Hint: you may use the below code:</li>
</ol>
<div class="sourceCode" id="cb979"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb979-1"><a href="going-further-reactR.html#cb979-1"></a><span class="im">import</span> <span class="op">{</span> reactShinyInput <span class="op">}</span> <span class="im">from</span> <span class="st">'reactR'</span><span class="op">;</span></span>
<span id="cb979-2"><a href="going-further-reactR.html#cb979-2"></a><span class="co">// reactstrap components</span></span>
<span id="cb979-3"><a href="going-further-reactR.html#cb979-3"></a><span class="im">import</span> <span class="op">{</span> Button <span class="op">}</span> <span class="im">from</span> <span class="st">"reactstrap"</span><span class="op">;</span></span>
<span id="cb979-4"><a href="going-further-reactR.html#cb979-4"></a></span>
<span id="cb979-5"><a href="going-further-reactR.html#cb979-5"></a><span class="kw">function</span> <span class="at">ActionButton</span>(<span class="op">{</span>configuration<span class="op">,</span> value<span class="op">,</span> setValue<span class="op">}</span>) <span class="op">{</span></span>
<span id="cb979-6"><a href="going-further-reactR.html#cb979-6"></a>  <span class="kw">let</span> iconTag<span class="op">,</span> btnCl<span class="op">,</span> innerTag<span class="op">;</span></span>
<span id="cb979-7"><a href="going-further-reactR.html#cb979-7"></a>  <span class="cf">if</span> (...) <span class="op">{</span></span>
<span id="cb979-8"><a href="going-further-reactR.html#cb979-8"></a>    btnCl <span class="op">=</span> <span class="st">"btn-icon"</span><span class="op">;</span></span>
<span id="cb979-9"><a href="going-further-reactR.html#cb979-9"></a>    innerTag <span class="op">= </span><span class="kw">&lt;&gt;</span></span>
<span id="cb979-10"><a href="going-further-reactR.html#cb979-10"></a>      <span class="kw">&lt;span</span> <span class="ot">className</span><span class="op">=</span><span class="st">"btn-inner--icon"</span><span class="kw">&gt;</span></span>
<span id="cb979-11"><a href="going-further-reactR.html#cb979-11"></a>        <span class="kw">&lt;i</span> <span class="ot">className</span><span class="op">=</span><span class="er">...</span> <span class="kw">/&gt;</span></span>
<span id="cb979-12"><a href="going-further-reactR.html#cb979-12"></a>      <span class="kw">&lt;/span&gt;</span></span>
<span id="cb979-13"><a href="going-further-reactR.html#cb979-13"></a>      <span class="kw">&lt;span</span> <span class="ot">className</span><span class="op">=</span><span class="st">"btn-inner--text"</span><span class="kw">&gt;</span>...<span class="kw">&lt;/span&gt;</span></span>
<span id="cb979-14"><a href="going-further-reactR.html#cb979-14"></a>    <span class="kw">&lt;/&gt;</span><span class="op">;</span></span>
<span id="cb979-15"><a href="going-further-reactR.html#cb979-15"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb979-16"><a href="going-further-reactR.html#cb979-16"></a>    innerTag <span class="op">=</span> <span class="va">configuration</span>.<span class="at">label</span><span class="op">;</span></span>
<span id="cb979-17"><a href="going-further-reactR.html#cb979-17"></a>  <span class="op">}</span></span>
<span id="cb979-18"><a href="going-further-reactR.html#cb979-18"></a></span>
<span id="cb979-19"><a href="going-further-reactR.html#cb979-19"></a>  <span class="kw">let</span> outlined<span class="op">;</span></span>
<span id="cb979-20"><a href="going-further-reactR.html#cb979-20"></a>  <span class="cf">if</span> (...) <span class="op">{</span></span>
<span id="cb979-21"><a href="going-further-reactR.html#cb979-21"></a>    outlined <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb979-22"><a href="going-further-reactR.html#cb979-22"></a>  <span class="op">}</span></span>
<span id="cb979-23"><a href="going-further-reactR.html#cb979-23"></a></span>
<span id="cb979-24"><a href="going-further-reactR.html#cb979-24"></a>  <span class="cf">return</span> (</span>
<span id="cb979-25"><a href="going-further-reactR.html#cb979-25"></a>    <span class="fu">&lt;Button</span></span>
<span id="cb979-26"><a href="going-further-reactR.html#cb979-26"></a>      <span class="ot">color</span><span class="op">=</span><span class="va">{configuration</span>.<span class="at">status</span><span class="va">}</span></span>
<span id="cb979-27"><a href="going-further-reactR.html#cb979-27"></a>      <span class="ot">className</span><span class="op">=</span><span class="er">...</span></span>
<span id="cb979-28"><a href="going-further-reactR.html#cb979-28"></a>      <span class="er">outline=...</span></span>
<span id="cb979-29"><a href="going-further-reactR.html#cb979-29"></a>      <span class="er">size=...</span></span>
<span id="cb979-30"><a href="going-further-reactR.html#cb979-30"></a>      <span class="er">onClick=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setValue</span>(value <span class="op">+</span> <span class="dv">1</span>)<span class="va">}</span><span class="fu">&gt;</span></span>
<span id="cb979-31"><a href="going-further-reactR.html#cb979-31"></a>      <span class="va">{</span>innerTag<span class="va">}</span></span>
<span id="cb979-32"><a href="going-further-reactR.html#cb979-32"></a>    <span class="fu">&lt;/Button&gt;</span></span>
<span id="cb979-33"><a href="going-further-reactR.html#cb979-33"></a>  )<span class="op">;</span></span>
<span id="cb979-34"><a href="going-further-reactR.html#cb979-34"></a><span class="op">}</span></span>
<span id="cb979-35"><a href="going-further-reactR.html#cb979-35"></a></span>
<span id="cb979-36"><a href="going-further-reactR.html#cb979-36"></a><span class="at">reactShinyInput</span>(</span>
<span id="cb979-37"><a href="going-further-reactR.html#cb979-37"></a>  <span class="st">'.action_button'</span><span class="op">,</span> </span>
<span id="cb979-38"><a href="going-further-reactR.html#cb979-38"></a>  <span class="st">'reactstrapTest.action_button'</span><span class="op">,</span> </span>
<span id="cb979-39"><a href="going-further-reactR.html#cb979-39"></a>  ActionButton</span>
<span id="cb979-40"><a href="going-further-reactR.html#cb979-40"></a>)<span class="op">;</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Try your code with:</li>
</ol>
<div class="sourceCode" id="cb980"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/">shiny</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mypkg</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
  theme <span class="op">=</span> <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html">bs_theme</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidRow</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/action_button.html">action_button</a></span><span class="op">(</span>
      <span class="st">"plop"</span>, 
      <span class="st">"Click me!"</span>, 
      size <span class="op">=</span> <span class="st">"lg"</span>, 
      outline <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/action_button.html">action_button</a></span><span class="op">(</span>
      <span class="st">"update"</span>, 
      <span class="st">"Update button 1"</span>, 
      icon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/icon.html">icon</a></span><span class="op">(</span><span class="st">"bicycle"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html">observe</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">plop</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">update</span>, <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/update_action_button.html">update_action_button</a></span><span class="op">(</span>
      <span class="va">session</span>, <span class="st">"plop"</span>, 
      configuration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        label <span class="op">=</span> <span class="st">"New text"</span>, 
        status <span class="op">=</span> <span class="st">"success"</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span>, ignoreInit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
</div>
<div id="add-another-input" class="section level3">
<h3>
<span class="header-section-number">27.2.8</span> Add another input<a class="anchor" aria-label="anchor" href="#add-another-input"><i class="fas fa-link"></i></a>
</h3>
<div id="button-group-input" class="section level4">
<h4>
<span class="header-section-number">27.2.8.1</span> Button group input<a class="anchor" aria-label="anchor" href="#button-group-input"><i class="fas fa-link"></i></a>
</h4>
<p>In this section, we design a radio input consisting of multiple buttons displayed side by side. The corresponding widget has a label and must show the currently selected value.</p>
<p>We initialized the input elements with:</p>
<div class="sourceCode" id="cb981"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reactR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reactR/man/scaffoldReactShinyInput.html">scaffoldReactShinyInput</a></span><span class="op">(</span><span class="st">"button_group"</span><span class="op">)</span></code></pre></div>
<p>As shown previously, this creates <code>./srcjs/button_group.jsx</code> and <code>.R/button_group.R</code>.
The <code><a href="https://rdrr.io/pkg/reactstrapTest/man/button_group.html">button_group()</a></code> function has four parameters, the most critical being <code>choices</code>.
We expect the user to pass a vector like <code><a href="https://rdrr.io/r/base/names.html">names(mtcars)</a></code>, and we selected the first choice by default. We might add a <code>selected</code> parameter but leave this for the reader as a simple exercise. The function is defined below:</p>
<div class="sourceCode" id="cb982"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">button_group</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
  <span class="va">inputId</span>,
  <span class="va">label</span>,
  <span class="va">choices</span>,
  <span class="va">status</span> <span class="op">=</span> <span class="st">"primary"</span>
<span class="op">)</span> <span class="op">{</span>
  <span class="fu">reactR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reactR/man/createReactShinyInput.html">createReactShinyInput</a></span><span class="op">(</span>
    <span class="va">inputId</span>,
    <span class="st">"button_group"</span>,
    <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlDependency.html">htmlDependency</a></span><span class="op">(</span>
      name <span class="op">=</span> <span class="st">"button_group-input"</span>,
      version <span class="op">=</span> <span class="st">"1.0.0"</span>,
      src <span class="op">=</span> <span class="st">"www/reactstrapTest"</span>,
      package <span class="op">=</span> <span class="st">"reactstrapTest"</span>,
      script <span class="op">=</span> <span class="st">"button_group.js"</span>
    <span class="op">)</span>,
    default <span class="op">=</span> <span class="va">choices</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
    configuration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      label <span class="op">=</span> <span class="va">label</span>,
      choices <span class="op">=</span> <span class="va">choices</span>,
      status <span class="op">=</span> <span class="va">status</span>
    <span class="op">)</span>,
    <span class="fu">htmltools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">tags</a></span><span class="op">$</span><span class="va">div</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The expected <code>reactstrap</code> button HTML structure is rather simple including a title, the list of button tags and the selected item in a paragraph:</p>
<div class="sourceCode" id="cb983"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb983-1"><a href="going-further-reactR.html#cb983-1"></a><span class="kw">&lt;div&gt;</span></span>
<span id="cb983-2"><a href="going-further-reactR.html#cb983-2"></a>  <span class="kw">&lt;h5&gt;</span>Radio Buttons<span class="kw">&lt;/h5&gt;</span></span>
<span id="cb983-3"><a href="going-further-reactR.html#cb983-3"></a>  <span class="fu">&lt;ButtonGroup&gt;</span></span>
<span id="cb983-4"><a href="going-further-reactR.html#cb983-4"></a>    <span class="fu">&lt;Button</span> <span class="ot">color</span><span class="op">=</span><span class="st">"primary"</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setRSelected</span>(<span class="dv">1</span>)<span class="va">}</span> <span class="ot">active</span><span class="op">=</span><span class="va">{</span>rSelected <span class="op">===</span> <span class="dv">1</span><span class="va">}</span><span class="fu">&gt;</span>One<span class="fu">&lt;/Button&gt;</span></span>
<span id="cb983-5"><a href="going-further-reactR.html#cb983-5"></a>    <span class="fu">&lt;Button</span> <span class="ot">color</span><span class="op">=</span><span class="st">"primary"</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setRSelected</span>(<span class="dv">2</span>)<span class="va">}</span> <span class="ot">active</span><span class="op">=</span><span class="va">{</span>rSelected <span class="op">===</span> <span class="dv">2</span><span class="va">}</span><span class="fu">&gt;</span>Two<span class="fu">&lt;/Button&gt;</span></span>
<span id="cb983-6"><a href="going-further-reactR.html#cb983-6"></a>    <span class="fu">&lt;Button</span> <span class="ot">color</span><span class="op">=</span><span class="st">"primary"</span> <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setRSelected</span>(<span class="dv">3</span>)<span class="va">}</span> <span class="ot">active</span><span class="op">=</span><span class="va">{</span>rSelected <span class="op">===</span> <span class="dv">3</span><span class="va">}</span><span class="fu">&gt;</span>Three<span class="fu">&lt;/Button&gt;</span></span>
<span id="cb983-7"><a href="going-further-reactR.html#cb983-7"></a>  <span class="fu">&lt;/ButtonGroup&gt;</span></span>
<span id="cb983-8"><a href="going-further-reactR.html#cb983-8"></a>  <span class="kw">&lt;p&gt;</span>Selected: <span class="va">{</span>rSelected<span class="va">}</span><span class="kw">&lt;/p&gt;</span></span>
<span id="cb983-9"><a href="going-further-reactR.html#cb983-9"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p>Inside <code>./srcjs/button_group.jsx</code>, we first import the required function and components:</p>
<div class="sourceCode" id="cb984"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb984-1"><a href="going-further-reactR.html#cb984-1"></a><span class="im">import</span> <span class="op">{</span> reactShinyInput <span class="op">}</span> <span class="im">from</span> <span class="st">'reactR'</span><span class="op">;</span></span>
<span id="cb984-2"><a href="going-further-reactR.html#cb984-2"></a><span class="im">import</span> <span class="op">{</span> Button<span class="op">,</span> ButtonGroup <span class="op">}</span> <span class="im">from</span> <span class="st">'reactstrap'</span><span class="op">;</span></span></code></pre></div>
<p>We then design the <code>ButtonGroupUI</code> JS function that will return our component. The critical step is to recover the user choices (<code>configuration.choices</code>) and store them in a variable. Then, we leverage the <code>map</code> feature (see <a href="going-further-reactR.html#react-map">27.1.2.2</a>) to iterate over each choice and programmatically create all buttons:</p>
<div class="sourceCode" id="cb985"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb985-1"><a href="going-further-reactR.html#cb985-1"></a><span class="kw">function</span> <span class="at">ButtonGroupUI</span>(<span class="op">{</span> configuration<span class="op">,</span> value<span class="op">,</span> setValue <span class="op">}</span>) <span class="op">{</span></span>
<span id="cb985-2"><a href="going-further-reactR.html#cb985-2"></a>  <span class="kw">const</span> choices <span class="op">=</span> <span class="va">configuration</span>.<span class="at">choices</span></span>
<span id="cb985-3"><a href="going-further-reactR.html#cb985-3"></a>  <span class="co">// programmatically create buttons</span></span>
<span id="cb985-4"><a href="going-further-reactR.html#cb985-4"></a>  <span class="kw">const</span> buttons <span class="op">=</span> <span class="va">choices</span>.<span class="at">map</span>(</span>
<span id="cb985-5"><a href="going-further-reactR.html#cb985-5"></a>    (choice) <span class="kw">=&gt; </span><span class="fu">&lt;Button</span></span>
<span id="cb985-6"><a href="going-further-reactR.html#cb985-6"></a>      <span class="ot">key</span><span class="op">=</span><span class="va">{</span>choice<span class="va">}</span></span>
<span id="cb985-7"><a href="going-further-reactR.html#cb985-7"></a>      <span class="ot">color</span><span class="op">=</span><span class="va">{configuration</span>.<span class="at">status</span><span class="va">}</span></span>
<span id="cb985-8"><a href="going-further-reactR.html#cb985-8"></a>      <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setValue</span>(choice)<span class="va">}</span></span>
<span id="cb985-9"><a href="going-further-reactR.html#cb985-9"></a>      <span class="ot">active</span><span class="op">=</span><span class="va">{</span>value <span class="op">===</span> choice<span class="va">}</span><span class="fu">&gt;</span></span>
<span id="cb985-10"><a href="going-further-reactR.html#cb985-10"></a>        <span class="va">{</span>choice<span class="va">}</span></span>
<span id="cb985-11"><a href="going-further-reactR.html#cb985-11"></a>      <span class="fu">&lt;/Button&gt;</span></span>
<span id="cb985-12"><a href="going-further-reactR.html#cb985-12"></a>  )</span>
<span id="cb985-13"><a href="going-further-reactR.html#cb985-13"></a>  <span class="co">// ... other code</span></span></code></pre></div>
<p>We finally return the whole component in a fragment <code>&lt;&gt;</code> to prevent from creating extra <code>div</code>. The whole code is shown below:</p>
<div class="sourceCode" id="cb986"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb986-1"><a href="going-further-reactR.html#cb986-1"></a><span class="im">import</span> <span class="op">{</span> reactShinyInput <span class="op">}</span> <span class="im">from</span> <span class="st">'reactR'</span><span class="op">;</span></span>
<span id="cb986-2"><a href="going-further-reactR.html#cb986-2"></a><span class="im">import</span> <span class="op">{</span> Button<span class="op">,</span> ButtonGroup <span class="op">}</span> <span class="im">from</span> <span class="st">'reactstrap'</span><span class="op">;</span></span>
<span id="cb986-3"><a href="going-further-reactR.html#cb986-3"></a></span>
<span id="cb986-4"><a href="going-further-reactR.html#cb986-4"></a><span class="kw">function</span> <span class="at">ButtonGroupUI</span>(<span class="op">{</span> configuration<span class="op">,</span> value<span class="op">,</span> setValue <span class="op">}</span>) <span class="op">{</span></span>
<span id="cb986-5"><a href="going-further-reactR.html#cb986-5"></a>  <span class="kw">const</span> choices <span class="op">=</span> <span class="va">configuration</span>.<span class="at">choices</span></span>
<span id="cb986-6"><a href="going-further-reactR.html#cb986-6"></a>  <span class="kw">const</span> buttons <span class="op">=</span> <span class="va">choices</span>.<span class="at">map</span>(</span>
<span id="cb986-7"><a href="going-further-reactR.html#cb986-7"></a>    (choice) <span class="kw">=&gt; </span><span class="fu">&lt;Button</span></span>
<span id="cb986-8"><a href="going-further-reactR.html#cb986-8"></a>      <span class="ot">key</span><span class="op">=</span><span class="va">{</span>choice<span class="va">}</span></span>
<span id="cb986-9"><a href="going-further-reactR.html#cb986-9"></a>      <span class="ot">color</span><span class="op">=</span><span class="va">{configuration</span>.<span class="at">status</span><span class="va">}</span></span>
<span id="cb986-10"><a href="going-further-reactR.html#cb986-10"></a>      <span class="ot">onClick</span><span class="op">=</span><span class="va">{</span>() <span class="kw">=&gt;</span> <span class="at">setValue</span>(choice)<span class="va">}</span></span>
<span id="cb986-11"><a href="going-further-reactR.html#cb986-11"></a>      <span class="ot">active</span><span class="op">=</span><span class="va">{</span>value <span class="op">===</span> choice<span class="va">}</span><span class="fu">&gt;</span></span>
<span id="cb986-12"><a href="going-further-reactR.html#cb986-12"></a>        <span class="va">{</span>choice<span class="va">}</span></span>
<span id="cb986-13"><a href="going-further-reactR.html#cb986-13"></a>      <span class="fu">&lt;/Button&gt;</span></span>
<span id="cb986-14"><a href="going-further-reactR.html#cb986-14"></a>  )</span>
<span id="cb986-15"><a href="going-further-reactR.html#cb986-15"></a></span>
<span id="cb986-16"><a href="going-further-reactR.html#cb986-16"></a>  <span class="cf">return</span> (</span>
<span id="cb986-17"><a href="going-further-reactR.html#cb986-17"></a>    <span class="kw">&lt;&gt;</span></span>
<span id="cb986-18"><a href="going-further-reactR.html#cb986-18"></a>      <span class="kw">&lt;h5&gt;</span><span class="va">{configuration</span>.<span class="at">label</span><span class="va">}</span><span class="kw">&lt;/h5&gt;</span></span>
<span id="cb986-19"><a href="going-further-reactR.html#cb986-19"></a>      <span class="fu">&lt;ButtonGroup&gt;</span></span>
<span id="cb986-20"><a href="going-further-reactR.html#cb986-20"></a>       <span class="va">{</span>buttons<span class="va">}</span></span>
<span id="cb986-21"><a href="going-further-reactR.html#cb986-21"></a>      <span class="fu">&lt;/ButtonGroup&gt;</span></span>
<span id="cb986-22"><a href="going-further-reactR.html#cb986-22"></a>      <span class="kw">&lt;p&gt;</span>Selected: <span class="va">{</span>value<span class="va">}</span><span class="kw">&lt;/p&gt;</span></span>
<span id="cb986-23"><a href="going-further-reactR.html#cb986-23"></a>    <span class="kw">&lt;/&gt;</span></span>
<span id="cb986-24"><a href="going-further-reactR.html#cb986-24"></a>  )<span class="op">;</span></span>
<span id="cb986-25"><a href="going-further-reactR.html#cb986-25"></a><span class="op">}</span></span></code></pre></div>
<p>Now, we may test the newly created element in a Shiny app:</p>
<div class="sourceCode" id="cb987"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
  theme <span class="op">=</span> <span class="fu">bslib</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html">bs_theme</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/reactstrapTest/man/button_group.html">button_group</a></span><span class="op">(</span><span class="st">"plop"</span>, <span class="st">"A group of buttons"</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html">observe</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">plop</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>According to Figure <a href="going-further-reactR.html#fig:react-button-group">27.6</a>, there are rooms for improvements but it is a good start!</p>
<div class="figure">
<span id="fig:react-button-group"></span>
<img src="images/going-further/react-button-group.png" alt="Fully working React powered button group (similar to radio)" width="100%"><p class="caption">
FIGURE 27.6: Fully working React powered button group (similar to radio)
</p>
</div>
</div>
<div id="modularize-js-code-1" class="section level4">
<h4>
<span class="header-section-number">27.2.8.2</span> Modularize JS code<a class="anchor" aria-label="anchor" href="#modularize-js-code-1"><i class="fas fa-link"></i></a>
</h4>
<p>Imagine if we had to repeat this for ten different elements. As we start to accumulate components, it is good practice to start modularizing our code. Inside the <code>./srcjs/action_button.jsx</code>, we wrap the <code>reactShinyInput</code> call into an <code>export</code> statement:</p>
<pre><code>// To add in ./srcjs/action_button.jsx
export default function initActionButton(){
  reactShinyInput(
    '.action_button',
    'reactstrapTest.action_button',
    ActionButton
  );
}</code></pre>
<p>We apply the same strategy in the <code>./srcjs/button_group.jsx</code> script:</p>
<div class="sourceCode" id="cb989"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb989-1"><a href="going-further-reactR.html#cb989-1"></a><span class="co">// To add in `./srcjs/button_group.jsx`</span></span>
<span id="cb989-2"><a href="going-further-reactR.html#cb989-2"></a><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">initButtonGroup</span>()<span class="op">{</span></span>
<span id="cb989-3"><a href="going-further-reactR.html#cb989-3"></a>  <span class="at">reactShinyInput</span>(</span>
<span id="cb989-4"><a href="going-further-reactR.html#cb989-4"></a>    <span class="st">'.button_group'</span><span class="op">,</span></span>
<span id="cb989-5"><a href="going-further-reactR.html#cb989-5"></a>    <span class="st">'reactstrapTest.button_group'</span><span class="op">,</span></span>
<span id="cb989-6"><a href="going-further-reactR.html#cb989-6"></a>    ButtonGroupUI</span>
<span id="cb989-7"><a href="going-further-reactR.html#cb989-7"></a>  )<span class="op">;</span></span>
<span id="cb989-8"><a href="going-further-reactR.html#cb989-8"></a><span class="op">}</span></span></code></pre></div>
<p>We create a <code>main.jsx</code> file containing the necessary code to import and initialize our two components:</p>
<div class="sourceCode" id="cb990"><pre class="sourceCode jsx"><code class="sourceCode javascriptreact"><span id="cb990-1"><a href="going-further-reactR.html#cb990-1"></a><span class="im">import</span> initActionButton <span class="im">from</span> <span class="st">'./action_button.jsx'</span><span class="op">;</span></span>
<span id="cb990-2"><a href="going-further-reactR.html#cb990-2"></a><span class="im">import</span> initButtonGroup <span class="im">from</span> <span class="st">'./button_group.jsx'</span><span class="op">;</span></span>
<span id="cb990-3"><a href="going-further-reactR.html#cb990-3"></a></span>
<span id="cb990-4"><a href="going-further-reactR.html#cb990-4"></a><span class="at">initActionButton</span>()<span class="op">;</span></span>
<span id="cb990-5"><a href="going-further-reactR.html#cb990-5"></a><span class="at">initButtonGroup</span>()<span class="op">;</span></span></code></pre></div>
<p>We have to modify the <code>webpack.config.js</code> to change the entry point to <code>main.jsx</code>, whose output will be <code>main.js</code>:</p>
<div class="sourceCode" id="cb991"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb991-1"><a href="going-further-reactR.html#cb991-1"></a>entry<span class="op">:</span> [</span>
<span id="cb991-2"><a href="going-further-reactR.html#cb991-2"></a>  <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">'srcjs'</span><span class="op">,</span> <span class="st">'main.jsx'</span>)</span>
<span id="cb991-3"><a href="going-further-reactR.html#cb991-3"></a>]<span class="op">,</span></span>
<span id="cb991-4"><a href="going-further-reactR.html#cb991-4"></a>output<span class="op">:</span> <span class="op">{</span></span>
<span id="cb991-5"><a href="going-further-reactR.html#cb991-5"></a>  <span class="dt">path</span><span class="op">:</span> <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">'inst/www/reactstrapTest'</span>)<span class="op">,</span></span>
<span id="cb991-6"><a href="going-further-reactR.html#cb991-6"></a>  <span class="dt">filename</span><span class="op">:</span> <span class="st">'main.js'</span></span>
<span id="cb991-7"><a href="going-further-reactR.html#cb991-7"></a><span class="op">}</span></span></code></pre></div>
<script type="text/javascript">
entry: [
  path.join(__dirname, 'srcjs', 'main.jsx')
],
output: {
  path: path.join(__dirname, 'inst/www/reactstrapTest'),
  filename: 'main.js'
}
</script><p>This means we have to update the HTML dependency on the R side, for instance in the <code>button_group.R</code>, we replace the existing dependency by the following:</p>
<div class="sourceCode" id="cb992"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ... button_group.R start</span>
<span class="co"># ... </span>
  <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlDependency.html">htmlDependency</a></span><span class="op">(</span>
    name <span class="op">=</span> <span class="st">"button_group-input"</span>,
    version <span class="op">=</span> <span class="st">"1.0.0"</span>,
    src <span class="op">=</span> <span class="st">"www/reactstrapTest"</span>,
    package <span class="op">=</span> <span class="st">"reactstrapTest"</span>,
    script <span class="op">=</span> <span class="st">"main.js"</span>
  <span class="op">)</span>
<span class="co"># ...</span>
<span class="co"># button_group.R end</span></code></pre></div>
<p>We proceed similarly in the <code>action_button.R</code> script.</p>
</div>
</div>
</div>
<div id="further-resources-1" class="section level2">
<h2>
<span class="header-section-number">27.3</span> Further resources<a class="anchor" aria-label="anchor" href="#further-resources-1"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://appsilon.github.io/shiny.fluent">shiny.fluent</a> <span class="citation">(Rogala and Zyla <a href="references.html#ref-R-shiny.fluent" role="doc-biblioref">2021</a><a href="references.html#ref-R-shiny.fluent" role="doc-biblioref">a</a>)</span> leverages <code>{shiny.react}</code> <span class="citation">(Rogala and Zyla <a href="references.html#ref-R-shiny.react" role="doc-biblioref">2021</a><a href="references.html#ref-R-shiny.react" role="doc-biblioref">b</a>)</span>, that is another <a href="https://appsilon.github.io/shiny.react/index.html">alternative</a> to bring React to Shiny.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="mobile-going-further.html"><span class="header-section-number">26</span> Fine tune {shinyMobile}</a></div>
<div class="next"><a href="going-further-webdev.html"><span class="header-section-number">28</span> Divide and Conquere</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#going-further-reactR"><span class="header-section-number">27</span> R + Shiny + React: welcome {reactR}</a></li>
<li>
<a class="nav-link" href="#quick-introduction-to-react"><span class="header-section-number">27.1</span> Quick introduction to React</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#setup-1"><span class="header-section-number">27.1.1</span> Setup</a></li>
<li><a class="nav-link" href="#basics-3"><span class="header-section-number">27.1.2</span> Basics</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#introduction-to-reactr"><span class="header-section-number">27.2</span> Introduction to {reactR}</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#setup-2"><span class="header-section-number">27.2.1</span> Setup</a></li>
<li><a class="nav-link" href="#customize-the-r-logic"><span class="header-section-number">27.2.2</span> Customize the R logic</a></li>
<li><a class="nav-link" href="#reactR-jsx-logic"><span class="header-section-number">27.2.3</span> Implement the JS logic</a></li>
<li><a class="nav-link" href="#improve-the-js-logic"><span class="header-section-number">27.2.4</span> Improve the JS logic</a></li>
<li><a class="nav-link" href="#exercise-1-1"><span class="header-section-number">27.2.5</span> Exercise 1</a></li>
<li><a class="nav-link" href="#technical-considerations"><span class="header-section-number">27.2.6</span> Technical considerations</a></li>
<li><a class="nav-link" href="#exercise-2-1"><span class="header-section-number">27.2.7</span> Exercise 2</a></li>
<li><a class="nav-link" href="#add-another-input"><span class="header-section-number">27.2.8</span> Add another input</a></li>
</ul>
</li>
<li><a class="nav-link" href="#further-resources-1"><span class="header-section-number">27.3</span> Further resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/blob/master/going-further-reactR.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/edit/master/going-further-reactR.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Outstanding User Interfaces with Shiny</strong>" was written by David Granjon. It was last built on 2021-09-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
